import{S as t,i as e,s as n,M as s,j as a,m as r,k as o,o as l,p as i,q as c,z as d,e as u,b as m,c as p,h as f,a as g,d as h,w as x,l as y,Q as v,n as $,af as b,U as w,ag as _,D as M,E as k,ah as T,r as D,u as C,G as A,H as Y,v as N,t as O,g as E,x as F,y as R,F as I,L as j,a0 as P,ai as U,a7 as S,aj as z,C as H,R as L,ak as G}from"./App-28f0f786.js";import{T as q}from"./UIToolbar-5590cb97.js";import{U as B}from"./UIItem-456a403e.js";import{S as K}from"./UISegmented-d438eac5.js";import{c as W,a as J,d as Q}from"./dayjs.min-d290c2ff.js";function Z(t){let e;return{c(){e=u("div"),e.textContent="Activate GetPayments",m(e,"slot","title"),m(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function V(t){let e,n,s,a,r,o,l,i,c;return{c(){e=u("div"),n=u("p"),n.innerHTML="\n            In order to accept payments, your account has to first activate <b>GetPayments</b>.<br>\n            Tap here to contact our support to activate now.\n        ",s=g(),a=u("div"),r=u("button"),r.textContent="Contact Support",o=g(),l=u("div"),i=u("button"),i.textContent="Cancel",m(n,"class","text-gray-800 mb-6 text-center"),m(r,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),m(a,"class","flex justify-center mt-2"),m(i,"class","p-2 w-1/2 shadow-md bg-gray-400 text-white rounded-lg capitalize font-bold h-full shadow-md"),m(l,"class","flex justify-center mt-2"),m(e,"slot","content"),m(e,"class","h-64 p-2")},m(d,u,m){p(d,e,u),h(e,n),h(e,s),h(e,a),h(a,r),h(e,o),h(e,l),h(l,i),m&&x(c),c=[y(r,"click",t[0]),y(i,"click",v)]},p:$,d(t){t&&f(e),x(c)}}}function X(t){let e;return{c(){e=g()},m(t,n){p(t,e,n)},p:$,d(t){t&&f(e)}}}function tt(t){let e;const n=new s({props:{$$slots:{default:[X],content:[V],title:[Z]},$$scope:{ctx:t}}});return{c(){a(n.$$.fragment)},m(t,s){r(n,t,s),e=!0},p(t,[e]){const s={};4&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){e||(o(n.$$.fragment,t),e=!0)},o(t){l(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function et(t,e,n){let s;return c(t,d,t=>n(1,s=t)),[function(){b(`Hello, I would like to activate payments for my GetOrders account.\n üëâüèª My ID : ${s.settings.fire_id}`)}]}class nt extends t{constructor(t){super(),e(this,t,et,tt,n,{})}}var st=W((function(t,e){t.exports=function(t,e,n){var s=e.prototype;n.en.relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};var a=function(t,e,s,a){for(var r,o,l,i=s.$locale().relativeTime,c=[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],d=c.length,u=0;u<d;u+=1){var m=c[u];m.d&&(r=a?n(t).diff(s,m.d,!0):s.diff(t,m.d,!0));var p=Math.round(Math.abs(r));if(l=r>0,p<=m.r||!m.r){1===p&&u>0&&(m=c[u-1]);var f=i[m.l];o="string"==typeof f?f.replace("%d",p):f(p,e,m.l,l);break}}return e?o:(l?i.future:i.past).replace("%s",o)};s.to=function(t,e){return a(t,e,this,!0)},s.from=function(t,e){return a(t,e,this)};var r=function(t){return t.$u?n.utc():n()};s.toNow=function(t){return this.to(r(this),t)},s.fromNow=function(t){return this.from(r(this),t)}}}));function at(t,e,n){const s=t.slice();return s[18]=e[n],s}function rt(t,e,n){const s=t.slice();return s[21]=e[n],s}function ot(t,e,n){const s=t.slice();return s[15]=e[n],s[17]=n,s}function lt(t){let e;const n=new j({props:{$$slots:{message:[it]},$$scope:{ctx:t}}});return{c(){a(n.$$.fragment)},m(t,s){r(n,t,s),e=!0},i(t){e||(o(n.$$.fragment,t),e=!0)},o(t){l(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function it(t){let e;return{c(){e=u("div"),e.textContent="One Moment Please..",m(e,"slot","message")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function ct(t){let e,n,s=t[2]&&lt(t);return{c(){e=u("div"),s&&s.c(),m(e,"slot","loader")},m(t,a){p(t,e,a),s&&s.m(e,null),n=!0},p(t,n){t[2]?s?o(s,1):(s=lt(t),s.c(),o(s,1),s.m(e,null)):s&&(D(),l(s,1,1,()=>{s=null}),C())},i(t){n||(o(s),n=!0)},o(t){l(s),n=!1},d(t){t&&f(e),s&&s.d()}}}function dt(t){let e,n,s;function c(e){t[14].call(null,e)}let d={style:t[7],segments:t[9]};void 0!==t[3]&&(d.value=t[3]);const g=new K({props:d});return A.push(()=>Y(g,"value",c)),{c(){e=u("div"),a(g.$$.fragment),m(e,"slot","title"),m(e,"class","font-semibold text-xl text-gray-600")},m(t,n){p(t,e,n),r(g,e,null),s=!0},p(t,e){const s={};!n&&8&e&&(n=!0,s.value=t[3],N(()=>n=!1)),g.$set(s)},i(t){s||(o(g.$$.fragment,t),s=!0)},o(t){l(g.$$.fragment,t),s=!1},d(t){t&&f(e),i(g)}}}function ut(t){let e,n,s,a=Dt(t[0].guest.phone)+"";return{c(){e=u("p"),n=u("a"),m(n,"href",s="tel:"+t[0].guest.phone),m(e,"class","leading-tight text-lg text-gray-700 mb-2")},m(t,s){p(t,e,s),h(e,n),n.innerHTML=a},p(t,e){1&e&&a!==(a=Dt(t[0].guest.phone)+"")&&(n.innerHTML=a),1&e&&s!==(s="tel:"+t[0].guest.phone)&&m(n,"href",s)},d(t){t&&f(e)}}}function mt(t){let e;return{c(){e=u("p"),e.textContent="PICKUP ORDER",m(e,"class","text-sm text-theme uppercase")},m(t,n){p(t,e,n)},p:$,d(t){t&&f(e)}}}function pt(t){let e,n,s,a,r=Tt(t[0].guest.address)+"",o=Tt(t[0].guest.address2)+"";return{c(){e=u("p"),n=O(r),s=g(),a=O(o),m(e,"class","text-sm text-theme uppercase")},m(t,r){p(t,e,r),h(e,n),h(e,s),h(e,a)},p(t,e){1&e&&r!==(r=Tt(t[0].guest.address)+"")&&E(n,r),1&e&&o!==(o=Tt(t[0].guest.address2)+"")&&E(a,o)},d(t){t&&f(e)}}}function ft(t){let e,n=t[15].variant,s=[];for(let e=0;e<n.length;e+=1)s[e]=gt(rt(t,n,e));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=F()},m(t,n){for(let e=0;e<s.length;e+=1)s[e].m(t,n);p(t,e,n)},p(t,a){if(1&a){let r;for(n=t[15].variant,r=0;r<n.length;r+=1){const o=rt(t,n,r);s[r]?s[r].p(o,a):(s[r]=gt(o),s[r].c(),s[r].m(e.parentNode,e))}for(;r<s.length;r+=1)s[r].d(1);s.length=n.length}},d(t){R(s,t),t&&f(e)}}}function gt(t){let e,n,s,a=t[21].name+"";return{c(){e=u("p"),n=O(a),s=g(),m(e,"class","text-sm text-gray-700")},m(t,a){p(t,e,a),h(e,n),h(e,s)},p(t,e){1&e&&a!==(a=t[21].name+"")&&E(n,a)},d(t){t&&f(e)}}}function ht(t){let e,n,s,a=Ct(t[18])+"";return{c(){e=u("p"),n=O(a),s=g(),m(e,"class","text-sm text-gray-700")},m(t,a){p(t,e,a),h(e,n),h(e,s)},p(t,e){1&e&&a!==(a=Ct(t[18])+"")&&E(n,a)},d(t){t&&f(e)}}}function xt(t){let e,n,s,a,r,o,l,i,c,d,x,y,v,$,b,w=t[15].quantity+"",_=(t[15].name||"")+"",M=parseFloat(t[15].unit_price||0).toFixed(2)+"",k=t[15].variant&&ft(t),T=t[15].modifiers,D=[];for(let e=0;e<T.length;e+=1)D[e]=ht(at(t,T,e));return{c(){e=u("div"),n=u("div"),s=u("span"),a=O(w),r=O("x"),o=g(),l=u("div"),i=u("p"),c=O(_),d=g(),k&&k.c(),x=g();for(let t=0;t<D.length;t+=1)D[t].c();y=g(),v=u("div"),$=O(M),m(s,"class","table-cell align-middle"),m(n,"class","flex-none w-10 h-10 text-center rounded-lg bg-gray-200 table text-sm text-gray-700"),m(i,"class","font-semibold"),m(l,"class","flex-grow px-2"),m(v,"class","flex-none w-20 text-right text-sm text-gray-700"),m(e,"class",b="flex "+(t[17]<t[0].cart.length-1?"border-b":"")+" mx-2 p-2 border-gray-200 list-item")},m(t,u){p(t,e,u),h(e,n),h(n,s),h(s,a),h(s,r),h(e,o),h(e,l),h(l,i),h(i,c),h(l,d),k&&k.m(l,null),h(l,x);for(let t=0;t<D.length;t+=1)D[t].m(l,null);h(e,y),h(e,v),h(v,$)},p(t,n){if(1&n&&w!==(w=t[15].quantity+"")&&E(a,w),1&n&&_!==(_=(t[15].name||"")+"")&&E(c,_),t[15].variant?k?k.p(t,n):(k=ft(t),k.c(),k.m(l,x)):k&&(k.d(1),k=null),1&n){let e;for(T=t[15].modifiers,e=0;e<T.length;e+=1){const s=at(t,T,e);D[e]?D[e].p(s,n):(D[e]=ht(s),D[e].c(),D[e].m(l,null))}for(;e<D.length;e+=1)D[e].d(1);D.length=T.length}1&n&&M!==(M=parseFloat(t[15].unit_price||0).toFixed(2)+"")&&E($,M),1&n&&b!==(b="flex "+(t[17]<t[0].cart.length-1?"border-b":"")+" mx-2 p-2 border-gray-200 list-item")&&m(e,"class",b)},d(t){t&&f(e),k&&k.d(),R(D,t)}}}function yt(t){let e,n,s,a,r,o,l,i=parseFloat(t[0].delivery_fees).toFixed(2)+"";return{c(){e=u("div"),n=u("p"),s=O("Delivery charges of "),a=u("b"),r=O("RM"),o=O(i),l=O(" applies for delivery."),m(n,"class","text-green-500"),m(e,"class","p-2 text-right text-sm")},m(t,i){p(t,e,i),h(e,n),h(n,s),h(n,a),h(a,r),h(a,o),h(n,l)},p(t,e){1&e&&i!==(i=parseFloat(t[0].delivery_fees).toFixed(2)+"")&&E(o,i)},d(t){t&&f(e)}}}function vt(t){let e,n,s,a,r,o,l,i,c=t[0].tax.value+"",d=parseFloat(t[0].tax.amount).toFixed(2)+"";return{c(){e=u("div"),n=u("p"),s=O("SST Tax ("),a=O(c),r=O("%) : "),o=u("b"),l=O("RM"),i=O(d),m(n,"class","text-green-500"),m(e,"class","p-2 text-right text-sm")},m(t,c){p(t,e,c),h(e,n),h(n,s),h(n,a),h(n,r),h(n,o),h(o,l),h(o,i)},p(t,e){1&e&&c!==(c=t[0].tax.value+"")&&E(a,c),1&e&&d!==(d=parseFloat(t[0].tax.amount).toFixed(2)+"")&&E(i,d)},d(t){t&&f(e)}}}function $t(t){let e,n,s=(t[0].status>4||t[0].payment&&t[0].payment.paidAt?`This invoice has been paid. ${t[0].payment?"(RM"+t[0].payment.amount.toFixed(2)+")":"-"}`:"Unpaid Invoice")+"";return{c(){e=u("p"),n=O(s),m(e,"class","text-center text-theme font-semibold")},m(t,s){p(t,e,s),h(e,n)},p(t,e){1&e&&s!==(s=(t[0].status>4||t[0].payment&&t[0].payment.paidAt?`This invoice has been paid. ${t[0].payment?"(RM"+t[0].payment.amount.toFixed(2)+")":"-"}`:"Unpaid Invoice")+"")&&E(n,s)},d(t){t&&f(e)}}}function bt(t){let e,n,s,a,r,o,l,i,c,d,x,y,v,$,b,w,_,M,k,T,D,C=t[0].guest.name+"",A=Q().to(Q(t[0].createdAt))+"",Y=parseFloat(t[0].grand_total).toFixed(2)+"",N=t[0].guest.phone&&ut(t);function F(t,e){return t[0].guest.address&&2==t[0].method?pt:mt}let I=F(t),j=I(t),P=t[0].cart,U=[];for(let e=0;e<P.length;e+=1)U[e]=xt(ot(t,P,e));let S=t[0].delivery_fees&&2==t[0].method&&yt(t),z=t[0].tax&&vt(t),H=t[0].payment&&$t(t);return{c(){e=u("div"),n=u("div"),s=u("p"),a=O(C),r=g(),N&&N.c(),o=g(),j.c(),l=g(),i=u("div"),c=O(A),d=g();for(let t=0;t<U.length;t+=1)U[t].c();x=g(),y=u("div"),S&&S.c(),v=g(),z&&z.c(),$=g(),b=u("div"),w=u("div"),w.textContent="Grand Total",_=g(),M=u("div"),k=O("RM"),T=O(Y),D=g(),H&&H.c(),m(s,"class","leading-tight font-semibold"),m(n,"class","m-2"),m(i,"class","rounded-lg bg-teal-400 text-white text-sm font-semibold m-2 p-2"),m(w,"class","flex-grow text-left"),m(M,"class","flex-grow text-right ml-2"),m(b,"class","flex px-2 mb-2 font-bold"),m(y,"class","flex-none w-full bg-gray-100 shadow-xs p-3 text-center"),m(e,"slot","content"),m(e,"class","p-2")},m(t,u){p(t,e,u),h(e,n),h(n,s),h(s,a),h(n,r),N&&N.m(n,null),h(n,o),j.m(n,null),h(e,l),h(e,i),h(i,c),h(e,d);for(let t=0;t<U.length;t+=1)U[t].m(e,null);h(e,x),h(e,y),S&&S.m(y,null),h(y,v),z&&z.m(y,null),h(y,$),h(y,b),h(b,w),h(b,_),h(b,M),h(M,k),h(M,T),h(y,D),H&&H.m(y,null)},p(t,s){if(1&s&&C!==(C=t[0].guest.name+"")&&E(a,C),t[0].guest.phone?N?N.p(t,s):(N=ut(t),N.c(),N.m(n,o)):N&&(N.d(1),N=null),I===(I=F(t))&&j?j.p(t,s):(j.d(1),j=I(t),j&&(j.c(),j.m(n,null))),1&s&&A!==(A=Q().to(Q(t[0].createdAt))+"")&&E(c,A),1&s){let n;for(P=t[0].cart,n=0;n<P.length;n+=1){const a=ot(t,P,n);U[n]?U[n].p(a,s):(U[n]=xt(a),U[n].c(),U[n].m(e,x))}for(;n<U.length;n+=1)U[n].d(1);U.length=P.length}t[0].delivery_fees&&2==t[0].method?S?S.p(t,s):(S=yt(t),S.c(),S.m(y,v)):S&&(S.d(1),S=null),t[0].tax?z?z.p(t,s):(z=vt(t),z.c(),z.m(y,$)):z&&(z.d(1),z=null),1&s&&Y!==(Y=parseFloat(t[0].grand_total).toFixed(2)+"")&&E(T,Y),t[0].payment?H?H.p(t,s):(H=$t(t),H.c(),H.m(y,null)):H&&(H.d(1),H=null)},d(t){t&&f(e),N&&N.d(),j.d(),R(U,t),S&&S.d(),z&&z.d(),H&&H.d()}}}function wt(t){let e,n;const s=new q({props:{tools:t[1],style:t[4]}});return s.$on("selected",t[5]),{c(){e=u("div"),a(s.$$.fragment),m(e,"slot","toolbar")},m(t,a){p(t,e,a),r(s,e,null),n=!0},p(t,e){const n={};2&e&&(n.tools=t[1]),s.$set(n)},i(t){n||(o(s.$$.fragment,t),n=!0)},o(t){l(s.$$.fragment,t),n=!1},d(t){t&&f(e),i(s)}}}function _t(t){let e,n,s;return{c(){e=g(),n=g(),s=g()},m(t,a){p(t,e,a),p(t,n,a),p(t,s,a)},p:$,i:$,o:$,d(t){t&&f(e),t&&f(n),t&&f(s)}}}function Mt(t){let e;const n=new s({props:{style:t[6],$$slots:{default:[_t],toolbar:[wt],content:[bt],title:[dt],loader:[ct]},$$scope:{ctx:t}}});return{c(){a(n.$$.fragment)},m(t,s){r(n,t,s),e=!0},p(t,[e]){const s={};16777231&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){e||(o(n.$$.fragment,t),e=!0)},o(t){l(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function kt(t,e,n){return t.replace(new RegExp(e,"g"),n)}function Tt(t){return kt(kt(t,", ",","),",",", ")}function Dt(t){if(!t)return"";let e=t.match(/.{3}|.{1,2}/g),n="";return e.forEach((t,e)=>{n+=t+(e<2?"<span class='text-gray-600 px-1'>-</span>":"")}),n}function Ct(t){let e=1==t.mode?"+ ":2==t.mode?"- ":"",n=3==t.mode?"% ":"",s=parseFloat(t.amount),a=s>0?` ${e}${s.toFixed(2)}${n}`:"";return`${t.name}${a}`}function At(t,e,n){let s,a,r,o;c(t,d,t=>n(11,s=t)),c(t,w,t=>n(12,a=t)),c(t,_,t=>n(13,r=t));let{order:l={}}=e,i=!1,u=[{name:"Order Link",icon:"paper-plane",function:"link"},{name:"Close",icon:"close-circle",function:"pop_modal"}],m=!1;s.settings&&s.settings.delivery_token&&(u=l.delivery?[{name:"Track Delivery",icon:"cube",function:"track"},...u]:[{name:"Request Delivery",icon:"cube",function:"deliver"},...u]),Q.extend(st),m=!0,M(k("/guest/invoice"),{order_id:l.invoice_id},"GET").then(t=>{n(2,m=!1),n(0,l={...l,...t})});let p=T(l.status);c(t,p,t=>n(3,o=t)),p.subscribe(t=>{i?(n(0,l.status=t,l),n(2,m=!0),M(k("/orders"),{_id:l._id,status:t,sub:r.fire_id},"PUT").then(t=>{n(2,m=!1),I(w,a={order:l})})):i=!0});let f=s.settings.statuses.map((t,e)=>({name:t,value:e})).slice(2);return t.$set=t=>{"order"in t&&n(0,l=t.order)},[l,u,m,o,{container:"justify-end"},function(t){"pop_modal"==t.detail.function&&v(),"link"==t.detail.function&&window.open(`https://pay.getorders.app/?i=${l.invoice_id}`,"_blank"),"track"==t.detail.function&&window.open(`https://www.tracking.my/matdespatch/${l.delivery.tracking_no}`,"_blank"),"deliver"==t.detail.function&&s.settings.delivery_token&&(n(2,m=!0),M(k("/deliver"),{order_id:l.invoice_id}).then(t=>{t._id?(n(0,l.delivery=t,l),I(w,a={order:l}),v()):alert("Delivery request failed. Despatch might be busy, try again."),n(2,m=!1)}))},{content:"overflow-y-scroll scrolling-touch"},{container:"m-auto table"},p,f,i,s,a,r,function(t){o=t,p.set(o)}]}class Yt extends t{constructor(t){super(),e(this,t,At,Mt,n,{order:0})}}function Nt(t){let e;const n=new j({props:{$$slots:{message:[Ot]},$$scope:{ctx:t}}});return{c(){a(n.$$.fragment)},m(t,s){r(n,t,s),e=!0},i(t){e||(o(n.$$.fragment,t),e=!0)},o(t){l(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function Ot(t){let e;return{c(){e=u("div"),e.textContent="Extracting data..",m(e,"slot","message")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function Et(t){let e,n,s=t[3]&&Nt(t);return{c(){e=u("div"),s&&s.c(),m(e,"slot","loader")},m(t,a){p(t,e,a),s&&s.m(e,null),n=!0},p(t,n){t[3]?s?o(s,1):(s=Nt(t),s.c(),o(s,1),s.m(e,null)):s&&(D(),l(s,1,1,()=>{s=null}),C())},i(t){n||(o(s),n=!0)},o(t){l(s),n=!1},d(t){t&&f(e),s&&s.d()}}}function Ft(t){let e;return{c(){e=u("div"),e.textContent="Export Orders",m(e,"slot","title"),m(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function Rt(t){let e,n,s,c,d,$,b,w,_,M,k,T,D,C,F,R,I,j,P,U,S,z,H,L,G,q,B,W,J=t[1].format("ddd D/M/YY")+"";function Q(e){t[12].call(null,e)}let Z={style:t[4],label:"",segments:[{name:"Default",value:""},{name:"Zepto",value:"zepto"},{name:"Mr Speedy",value:"speedy"}]};void 0!==t[2]&&(Z.value=t[2]);const V=new K({props:Z});function X(e){t[13].call(null,e)}A.push(()=>Y(V,"value",Q));let tt={style:t[4],label:"",segments:[{name:"Paid",value:"paid"},{name:"All",value:""}]};void 0!==t[0].type&&(tt.value=t[0].type);const et=new K({props:tt});return A.push(()=>Y(et,"value",X)),{c(){e=u("div"),n=u("p"),n.textContent="Select a day to export from",s=g(),c=u("div"),d=u("button"),d.innerHTML='<i class="far fa-arrow-alt-circle-left"></i>',$=g(),b=u("div"),w=O(J),_=g(),M=u("button"),M.innerHTML='<i class="far fa-arrow-alt-circle-right"></i>',k=g(),T=u("p"),T.textContent="Select format to export to",D=g(),C=u("div"),a(V.$$.fragment),R=g(),I=u("p"),I.textContent="Export Options",j=g(),P=u("div"),a(et.$$.fragment),S=g(),z=u("div"),H=u("button"),H.textContent="Export Now",L=g(),G=u("div"),q=u("button"),q.textContent="Cancel",m(n,"class","text-gray-800 mb-2 text-center"),m(b,"class","flex-grow self-center text-center"),m(c,"class","flex text-lg font-semibold m-2"),m(T,"class","text-gray-800 my-2 text-center"),m(C,"class","flex justify-center"),m(I,"class","text-gray-800 my-2 text-center"),m(P,"class","flex justify-center"),m(H,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),m(z,"class","flex justify-center mt-2"),m(q,"class","p-2 w-1/2 shadow-md bg-gray-400 text-white rounded-lg capitalize font-bold h-full shadow-md"),m(G,"class","flex justify-center my-2"),m(e,"slot","content"),m(e,"class","p-2")},m(a,o,l){p(a,e,o),h(e,n),h(e,s),h(e,c),h(c,d),h(c,$),h(c,b),h(b,w),h(c,_),h(c,M),h(e,k),h(e,T),h(e,D),h(e,C),r(V,C,null),h(e,R),h(e,I),h(e,j),h(e,P),r(et,P,null),h(e,S),h(e,z),h(z,H),h(e,L),h(e,G),h(G,q),B=!0,l&&x(W),W=[y(d,"click",t[10]),y(M,"click",t[11]),y(H,"click",t[6]),y(q,"click",v)]},p(t,e){(!B||2&e)&&J!==(J=t[1].format("ddd D/M/YY")+"")&&E(w,J);const n={};!F&&4&e&&(F=!0,n.value=t[2],N(()=>F=!1)),V.$set(n);const s={};!U&&1&e&&(U=!0,s.value=t[0].type,N(()=>U=!1)),et.$set(s)},i(t){B||(o(V.$$.fragment,t),o(et.$$.fragment,t),B=!0)},o(t){l(V.$$.fragment,t),l(et.$$.fragment,t),B=!1},d(t){t&&f(e),i(V),i(et),x(W)}}}function It(t){let e,n;return{c(){e=g(),n=g()},m(t,s){p(t,e,s),p(t,n,s)},p:$,i:$,o:$,d(t){t&&f(e),t&&f(n)}}}function jt(t){let e,n,c,d;const x=new s({props:{$$slots:{default:[It],content:[Rt],title:[Ft],loader:[Et]},$$scope:{ctx:t}}});return{c(){e=u("script"),c=g(),a(x.$$.fragment),e.src!==(n="https://unpkg.com/papaparse@latest/papaparse.min.js")&&m(e,"src","https://unpkg.com/papaparse@latest/papaparse.min.js")},m(t,n){h(document.head,e),p(t,c,n),r(x,t,n),d=!0},p(t,[e]){const n={};16399&e&&(n.$$scope={dirty:e,ctx:t}),x.$set(n)},i(t){d||(o(x.$$.fragment,t),d=!0)},o(t){l(x.$$.fragment,t),d=!1},d(t){f(e),t&&f(c),i(x,t)}}}function Pt(t,e,n){let s,a;c(t,_,t=>n(7,s=t)),c(t,d,t=>n(8,a=t));let r={type:"paid"},o=Q(),l="",i=!1;function u(t){n(1,o=o.add(t,"day"))}function m(t){let e=[];switch(l){case"":e=t.map(t=>({order_date:Q(t.createdAt).format("MM/DD hh:mm"),name:t.guest.name,phone:t.guest.phone,address:`${t.guest.address||""} ${t.guest.address2||""}`,isPickUp:t.guest.address?"N":"Y",amount:t.payment?t.payment.amount.toFixed(2):"10.00",paid:t.payment?Q(t.payment.paidAt||t.createdAt).format("MM/DD hh:mm"):"",invoice:`https://pay.getorders.app/?i=${t.invoice_id}`}));break;case"speedy":e=t.map(t=>({"Address(mandatory field)":`${t.guest.address||""} ${t.guest.address2||""}`,"Contact person":t.guest.name,"Recipient's phone (mandatory field)":t.guest.phone,"Parcel contents(mandatory field)":"FOOD","Weight in kg(mandatory field)":.5,"Internal order number":t.invoice_id,"Comment for courier":t.notes||"","Apartment / office number":"","Need to return on pickup point":"",'Time "since" on point':Q(t.createdAt).format("DD.MM.YYYY hh:mm:ss"),'Time "till" on point':Q(t.createdAt).add(1,"hour").format("DD.MM.YYYY hh:mm:ss"),"COD amount":"0","Buyout amount":"0","Do not fill anything in this column":"","Declared value":t.payment?t.payment.amount.toFixed(2):"10.00","Courier needs motorbox":"x"}));break;case"zepto":e=t.map(t=>({UNIT_NO:"",ADDRESS:`${t.guest.address||""} ${t.guest.address2||""}`,CONTACT_PERSON:t.guest.name,CONTACT_NUMBER:t.guest.phone,EMAIL:"",INSTRUCTION_NOTE:t.notes||""})),e=[{UNIT_NO:"",ADDRESS:`${a.settings.address||""} ${a.settings.address2||""} ${a.settings.postcode||""}`,CONTACT_PERSON:a.settings.name,CONTACT_NUMBER:a.settings.phone,EMAIL:"",INSTRUCTION_NOTE:"PICKUP HERE"},...e]}P(Papa.unparse(e),"orders.csv","text/csv;encoding:utf-8")}return[r,o,l,i,{container:"p-2 mb-3",label:"w-32"},u,function(){n(3,i=!0),M(k("/orders"),{sub:s.fire_id,order_type:r.type,from:o.startOf("day").toJSON(),to:o.endOf("day").toJSON()},"GET").then(t=>{n(3,i=!1),m(t.orders)})},s,a,m,()=>u(-1),()=>u(1),function(t){l=t,n(2,l)},function(t){r.type=t,n(0,r)}]}class Ut extends t{constructor(t){super(),e(this,t,Pt,jt,n,{})}}const{document:St}=U;function zt(t,e,n){const s=t.slice();return s[31]=e[n],s}function Ht(t,e,n){const s=t.slice();return s[28]=e[n],s}function Lt(t,e,n){const s=t.slice();return s[6]=e[n],s}function Gt(t,e,n){const s=t.slice();return s[36]=e[n],s}function qt(t){let e,n,s,a,r,o,l,i,c,d,v,$=t[2],b=[];for(let e=0;e<$.length;e+=1)b[e]=Bt(Gt(t,$,e));let w=t[7],_=[];for(let e=0;e<w.length;e+=1)_[e]=Kt(Lt(t,w,e));return{c(){e=u("div"),n=u("div"),s=u("label"),s.textContent="Account",a=g(),r=u("select");for(let t=0;t<b.length;t+=1)b[t].c();o=g(),l=u("div"),i=u("label"),i.textContent="Per Page",c=g(),d=u("select");for(let t=0;t<_.length;t+=1)_[t].c();m(s,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),void 0===t[4].sub&&S(()=>t[21].call(r)),m(n,"class","p-2 flex-none"),m(i,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),void 0===t[4].pages&&S(()=>t[22].call(d)),m(l,"class","p-2 flex-none"),m(e,"class","border-t border-b border-gray-200 flex")},m(u,m,f){p(u,e,m),h(e,n),h(n,s),h(n,a),h(n,r);for(let t=0;t<b.length;t+=1)b[t].m(r,null);z(r,t[4].sub),h(e,o),h(e,l),h(l,i),h(l,c),h(l,d);for(let t=0;t<_.length;t+=1)_[t].m(d,null);z(d,t[4].pages),f&&x(v),v=[y(r,"change",t[21]),y(d,"change",t[22])]},p(t,e){if(4&e[0]){let n;for($=t[2],n=0;n<$.length;n+=1){const s=Gt(t,$,n);b[n]?b[n].p(s,e):(b[n]=Bt(s),b[n].c(),b[n].m(r,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=$.length}if(16&e[0]&&z(r,t[4].sub),128&e[0]){let n;for(w=t[7],n=0;n<w.length;n+=1){const s=Lt(t,w,n);_[n]?_[n].p(s,e):(_[n]=Kt(s),_[n].c(),_[n].m(d,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=w.length}16&e[0]&&z(d,t[4].pages)},d(t){t&&f(e),R(b,t),R(_,t),x(v)}}}function Bt(t){let e,n,s,a=t[36].name+"";return{c(){e=u("option"),n=O(a),e.__value=s=t[36].fire_id,e.value=e.__value},m(t,s){p(t,e,s),h(e,n)},p(t,r){4&r[0]&&a!==(a=t[36].name+"")&&E(n,a),4&r[0]&&s!==(s=t[36].fire_id)&&(e.__value=s),e.value=e.__value},d(t){t&&f(e)}}}function Kt(t){let e,n,s,a=t[6]+"";return{c(){e=u("option"),n=O(a),e.__value=s=t[6],e.value=e.__value},m(t,s){p(t,e,s),h(e,n)},p:$,d(t){t&&f(e)}}}function Wt(t){let e,n,s,a=t[5].settings.statuses[t[31].status]+"";return{c(){e=u("span"),n=O(a),m(e,"class",s="ml-2 rounded-lg "+t[15][t[31].status]+" text-white text-sm px-2 capitalize svelte-riaew6")},m(t,s){p(t,e,s),h(e,n)},p(t,r){33&r[0]&&a!==(a=t[5].settings.statuses[t[31].status]+"")&&E(n,a),1&r[0]&&s!==(s="ml-2 rounded-lg "+t[15][t[31].status]+" text-white text-sm px-2 capitalize svelte-riaew6")&&m(e,"class",s)},d(t){t&&f(e)}}}function Jt(t){let e;return{c(){e=O("PICKUP ORDER")},m(t,n){p(t,e,n)},p:$,d(t){t&&f(e)}}}function Qt(t){let e,n,s,a=t[31].guest.address+"",r=t[31].guest.address2+"";return{c(){e=O(a),n=g(),s=O(r)},m(t,a){p(t,e,a),p(t,n,a),p(t,s,a)},p(t,n){1&n[0]&&a!==(a=t[31].guest.address+"")&&E(e,a),1&n[0]&&r!==(r=t[31].guest.address2+"")&&E(s,r)},d(t){t&&f(e),t&&f(n),t&&f(s)}}}function Zt(t){let e,n,s,a,r=Q(t[31].payment.paidAt).format("DD/MM/YYYY h:mmA")+"";return{c(){e=u("p"),n=u("i"),s=O(" Paid on "),a=O(r),m(n,"class","icon ion-md-checkmark-circle pr-1"),m(e,"class","text-sm text-green-500 font-semibold")},m(t,r){p(t,e,r),h(e,n),h(e,s),h(e,a)},p(t,e){1&e[0]&&r!==(r=Q(t[31].payment.paidAt).format("DD/MM/YYYY h:mmA")+"")&&E(a,r)},d(t){t&&f(e)}}}function Vt(t){let e,n,s,a,r=Q(t[31].delivery.createdAt).format("DD/MM/YYYY h:mmA")+"";return{c(){e=u("p"),n=u("i"),s=O(" Delivery requested on "),a=O(r),m(n,"class","icon ion-md-cube pr-1"),m(e,"class","text-sm text-orange-500 font-semibold")},m(t,r){p(t,e,r),h(e,n),h(e,s),h(e,a)},p(t,e){1&e[0]&&r!==(r=Q(t[31].delivery.createdAt).format("DD/MM/YYYY h:mmA")+"")&&E(a,r)},d(t){t&&f(e)}}}function Xt(t){let e,n,s,a;function r(...e){return t[24](t[31],...e)}function o(...e){return t[25](t[31],...e)}return{c(){e=u("button"),e.innerHTML='<i class="icon ion-md-checkmark"></i>',n=g(),s=u("button"),s.innerHTML='<i class="icon ion-md-close"></i>',m(e,"class","action bg-theme svelte-riaew6"),m(s,"class","action bg-theme svelte-riaew6")},m(t,l,i){p(t,e,l),p(t,n,l),p(t,s,l),i&&x(a),a=[y(e,"click",r),y(s,"click",o)]},p(e,n){t=e},d(t){t&&f(e),t&&f(n),t&&f(s),x(a)}}}function te(t){let e,n,s,a,r,o,l,i,c,d,v,$,b,w,_,M,k,T,D,C=Q(t[31].createdAt).format("h:mmA")+"",A=t[31].guest.name+"",Y=t[31].guest.phone+"",N=t[5].settings&&Wt(t);function F(t,e){return t[31].guest.address?Qt:Jt}let R=F(t),I=R(t),j=t[31].payment&&t[31].payment.paidAt&&Zt(t),P=t[31].delivery&&Vt(t);function U(...e){return t[23](t[31],...e)}let S=2==t[31].status&&Xt(t);function z(...e){return t[26](t[31],...e)}return{c(){e=u("div"),n=u("p"),s=O(C),a=g(),N&&N.c(),r=g(),o=u("p"),l=O(A),i=g(),c=u("p"),d=O(Y),v=g(),$=u("p"),I.c(),b=g(),j&&j.c(),w=g(),P&&P.c(),M=g(),S&&S.c(),k=g(),T=u("button"),T.innerHTML='<i class="icon ion-logo-whatsapp"></i>',m(n,"class","text-theme font-semibold"),m(o,"class","font-semibold leading-tight"),m(c,"class","leading-tight text-gray-600"),m($,"class","text-sm"),m(e,"class",_="flex-grow p-2 cursor-pointer "+(7==t[31].status||4==t[31].status?"opacity-25":"")),m(T,"class","action bg-theme svelte-riaew6")},m(t,u,m){p(t,e,u),h(e,n),h(n,s),h(n,a),N&&N.m(n,null),h(e,r),h(e,o),h(o,l),h(e,i),h(e,c),h(c,d),h(e,v),h(e,$),I.m($,null),h(e,b),j&&j.m(e,null),h(e,w),P&&P.m(e,null),p(t,M,u),S&&S.m(t,u),p(t,k,u),p(t,T,u),m&&x(D),D=[y(e,"click",U),y(T,"click",z)]},p(a,r){t=a,1&r[0]&&C!==(C=Q(t[31].createdAt).format("h:mmA")+"")&&E(s,C),t[5].settings?N?N.p(t,r):(N=Wt(t),N.c(),N.m(n,null)):N&&(N.d(1),N=null),1&r[0]&&A!==(A=t[31].guest.name+"")&&E(l,A),1&r[0]&&Y!==(Y=t[31].guest.phone+"")&&E(d,Y),R===(R=F(t))&&I?I.p(t,r):(I.d(1),I=R(t),I&&(I.c(),I.m($,null))),t[31].payment&&t[31].payment.paidAt?j?j.p(t,r):(j=Zt(t),j.c(),j.m(e,w)):j&&(j.d(1),j=null),t[31].delivery?P?P.p(t,r):(P=Vt(t),P.c(),P.m(e,null)):P&&(P.d(1),P=null),1&r[0]&&_!==(_="flex-grow p-2 cursor-pointer "+(7==t[31].status||4==t[31].status?"opacity-25":""))&&m(e,"class",_),2==t[31].status?S?S.p(t,r):(S=Xt(t),S.c(),S.m(k.parentNode,k)):S&&(S.d(1),S=null)},d(t){t&&f(e),N&&N.d(),I.d(),j&&j.d(),P&&P.d(),t&&f(M),S&&S.d(t),t&&f(k),t&&f(T),x(D)}}}function ee(t){let e;const n=new B({props:{$$slots:{default:[te]},$$scope:{ctx:t}}});return{c(){a(n.$$.fragment)},m(t,s){r(n,t,s),e=!0},p(t,e){const s={};41&e[0]|256&e[1]&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){e||(o(n.$$.fragment,t),e=!0)},o(t){l(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function ne(t){let e,n,s,a,r,i=Q(t[28]).format("ddd D/M/YY")+"",c=t[0][t[28]],d=[];for(let e=0;e<c.length;e+=1)d[e]=ee(zt(t,c,e));const x=t=>l(d[t],1,1,()=>{d[t]=null});return{c(){e=u("div"),n=O(i),s=g();for(let t=0;t<d.length;t+=1)d[t].c();a=F(),m(e,"class","rounded-lg bg-theme text-white text-lg font-semibold m-2 p-2")},m(t,o){p(t,e,o),h(e,n),p(t,s,o);for(let e=0;e<d.length;e+=1)d[e].m(t,o);p(t,a,o),r=!0},p(t,e){if((!r||1&e[0])&&i!==(i=Q(t[28]).format("ddd D/M/YY")+"")&&E(n,i),61481&e[0]){let n;for(c=t[0][t[28]],n=0;n<c.length;n+=1){const s=zt(t,c,n);d[n]?(d[n].p(s,e),o(d[n],1)):(d[n]=ee(s),d[n].c(),o(d[n],1),d[n].m(a.parentNode,a))}for(D(),n=c.length;n<d.length;n+=1)x(n);C()}},i(t){if(!r){for(let t=0;t<c.length;t+=1)o(d[t]);r=!0}},o(t){d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)l(d[t]);r=!1},d(t){t&&f(e),t&&f(s),R(d,t),t&&f(a)}}}function se(t){let e,n,s;return{c(){e=u("div"),n=u("button"),n.textContent="Show More",m(n,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),m(e,"class","flex justify-center mt-2")},m(a,r,o){p(a,e,r),h(e,n),o&&s(),s=y(n,"click",t[27])},p:$,d(t){t&&f(e),s()}}}function ae(t){let e,n,s,c,d,x,y,v;const $=new q({props:{class:"border-b border-gray-300",tools:t[8]}});$.$on("selected",t[10]);let b=t[2]&&qt(t),w=Object.keys(t[0]),_=[];for(let e=0;e<w.length;e+=1)_[e]=ne(Ht(t,w,e));const M=t=>l(_[t],1,1,()=>{_[t]=null});let k=t[1]&&se(t);return{c(){e=u("script"),s=g(),a($.$$.fragment),c=g(),b&&b.c(),d=g();for(let t=0;t<_.length;t+=1)_[t].c();x=g(),k&&k.c(),y=F(),e.src!==(n="https://unpkg.com/papaparse@latest/papaparse.min.js")&&m(e,"src","https://unpkg.com/papaparse@latest/papaparse.min.js")},m(t,n){h(St.head,e),p(t,s,n),r($,t,n),p(t,c,n),b&&b.m(t,n),p(t,d,n);for(let e=0;e<_.length;e+=1)_[e].m(t,n);p(t,x,n),k&&k.m(t,n),p(t,y,n),v=!0},p(t,e){if(t[2]?b?b.p(t,e):(b=qt(t),b.c(),b.m(d.parentNode,d)):b&&(b.d(1),b=null),61481&e[0]){let n;for(w=Object.keys(t[0]),n=0;n<w.length;n+=1){const s=Ht(t,w,n);_[n]?(_[n].p(s,e),o(_[n],1)):(_[n]=ne(s),_[n].c(),o(_[n],1),_[n].m(x.parentNode,x))}for(D(),n=w.length;n<_.length;n+=1)M(n);C()}t[1]?k?k.p(t,e):(k=se(t),k.c(),k.m(y.parentNode,y)):k&&(k.d(1),k=null)},i(t){if(!v){o($.$$.fragment,t);for(let t=0;t<w.length;t+=1)o(_[t]);v=!0}},o(t){l($.$$.fragment,t),_=_.filter(Boolean);for(let t=0;t<_.length;t+=1)l(_[t]);v=!1},d(t){f(e),t&&f(s),i($,t),t&&f(c),b&&b.d(t),t&&f(d),R(_,t),t&&f(x),k&&k.d(t),t&&f(y)}}}function re(t,e,n){let s,a,r,o,l,i;c(t,_,t=>n(17,s=t)),c(t,H,t=>n(3,a=t)),c(t,w,t=>n(18,r=t)),c(t,L,t=>n(19,o=t)),c(t,d,t=>n(5,i=t));let u,m={},p=0,f=!0,g=[],h=T({});function x(t){0==t&&n(1,f=!0),n(6,p=t),I(L,o=!0),M(k(`/orders/${p}`),l,"GET").then(t=>{I(L,o=!1),t.subs&&n(2,u=t.subs),0==t.orders.length?n(1,f=!1):(g=0==p?t.orders:[...g,...t.orders],y())})}function y(){let t={};g.forEach(e=>{let n=Q(e.createdAt).format("YYYY-MM-DD");t[n]=[...t[n]||[],e]}),n(0,m=t)}function v(t){t.status=4,I(L,o=!0),M(k("/orders"),{_id:t._id,status:t.status,sub:s.fire_id},"PUT").then(e=>{I(L,o=!1),I(w,r={order:t})})}function $(t){i.settings.billplz_token?(I(L,o=!0),M(k("/payment/billplz"),{order_id:t.invoice_id}).then(e=>{g=g.map(n=>(n.invoice_id==t.invoice_id&&(n.status=3,n.payment={bill_id:e.bill_id,url:e.url}),n)),y(),I(L,o=!1)})):I(H,a=[...a,{view:nt}])}function b(t){let e=t.guest.phone;e.startsWith("01")&&(e="6"+e);let n=`https://api.whatsapp.com/send?phone=${e}&text=`,a="";4==t.status?(a=`Hey, we are contacting from *(${s.name||i.settings.name})*. Unfortunately we can't serve you at this moment. Please note that your order has been *canceled*.`,a=`${a} üëâüèª https://pay.getorders.app/?i=${t.invoice_id}\n\n`):t.status>=3&&(a=`Hey there! We *(${s.name||i.settings.name})* have received your order, tap here to pay now.`,a=`${a} üëâüèª https://pay.getorders.app/?i=${t.invoice_id}\n\n`);let r=encodeURIComponent(a);document.location.href=`${n}${r}`}c(t,h,t=>n(4,l=t)),h.subscribe(t=>{t.sub&&I(_,s=u.find(e=>e.fire_id==t.sub)),x(0)}),x(0),w.subscribe(t=>{t.order&&(g=g.map(e=>(e.invoice_id==t.order.invoice_id&&(e=t.order),e)),I(w,r={}),y())});return[m,f,u,a,l,i,p,[50,100,150],[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],h,function(t){switch(t.detail.function){case"refresh":x(0);break;case"export":I(H,a=[...a,{view:Ut}])}},x,v,$,b,["bg-gray-400","bg-gray-400","bg-gray-400","bg-yellow-500","bg-red-400","bg-green-500","bg-pink-500","bg-theme"],g,s,r,o,y,function(){l.sub=G(this),h.set(l),n(2,u)},function(){l.pages=G(this),h.set(l),n(2,u)},t=>I(H,a=[...a,{view:Yt,order:t}]),t=>$(t),t=>v(t),t=>b(t),()=>x(p+1)]}export default class extends t{constructor(t){var s;super(),St.getElementById("svelte-riaew6-style")||((s=u("style")).id="svelte-riaew6-style",s.textContent=".action.svelte-riaew6{border-radius:9999px;color:#fff;margin-right:0.75rem;width:3rem;height:3rem;text-align:center;align-self:center;font-size:1.5rem;flex:none;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)}",h(St.head,s)),e(this,t,re,ae,n,{},[-1,-1])}}
//# sourceMappingURL=OrdersMan-2090c49e.js.map
