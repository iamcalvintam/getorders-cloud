import{S as e,i as t,s as n,ak as s,e as a,d as r,a as l,b as o,a7 as i,c,ac as d,w as u,l as p,t as m,g as f,h as g,n as h,y as b,x,k as v,j as y,m as w,o as $,p as _,r as Y,u as k,q as A,ai as M,C as D,U as j,R as U,z as E,F as I,D as T,E as z,aj as C,ad as P}from"./App-b2a4afcd.js";import{T as H}from"./UIToolbar-db7a75c2.js";import{U as N}from"./UIItem-bcb0abb5.js";import"./UISegmented-74b52ecc.js";import{d as O}from"./dayjs.min-d290c2ff.js";import{O as R,A as B,I as L}from"./OrdersExport-2169d1de.js";const{document:S}=s;function q(e,t,n){const s=e.slice();return s[31]=t[n],s}function G(e,t,n){const s=e.slice();return s[28]=t[n],s}function W(e,t,n){const s=e.slice();return s[6]=t[n],s}function F(e,t,n){const s=e.slice();return s[36]=t[n],s}function K(e){let t,n,s,m,f,h,x,v,y,w,$,_=e[2],Y=[];for(let t=0;t<_.length;t+=1)Y[t]=J(F(e,_,t));let k=e[7],A=[];for(let t=0;t<k.length;t+=1)A[t]=Q(W(e,k,t));return{c(){t=a("div"),n=a("div"),s=a("label"),s.textContent="Account",m=l(),f=a("select");for(let e=0;e<Y.length;e+=1)Y[e].c();h=l(),x=a("div"),v=a("label"),v.textContent="Per Page",y=l(),w=a("select");for(let e=0;e<A.length;e+=1)A[e].c();o(s,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),void 0===e[4].sub&&i(()=>e[21].call(f)),o(n,"class","p-2 flex-none"),o(v,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),void 0===e[4].pages&&i(()=>e[22].call(w)),o(x,"class","p-2 flex-none"),o(t,"class","border-t border-b border-gray-200 flex")},m(a,l,o){c(a,t,l),r(t,n),r(n,s),r(n,m),r(n,f);for(let e=0;e<Y.length;e+=1)Y[e].m(f,null);d(f,e[4].sub),r(t,h),r(t,x),r(x,v),r(x,y),r(x,w);for(let e=0;e<A.length;e+=1)A[e].m(w,null);d(w,e[4].pages),o&&u($),$=[p(f,"change",e[21]),p(w,"change",e[22])]},p(e,t){if(4&t[0]){let n;for(_=e[2],n=0;n<_.length;n+=1){const s=F(e,_,n);Y[n]?Y[n].p(s,t):(Y[n]=J(s),Y[n].c(),Y[n].m(f,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=_.length}if(16&t[0]&&d(f,e[4].sub),128&t[0]){let n;for(k=e[7],n=0;n<k.length;n+=1){const s=W(e,k,n);A[n]?A[n].p(s,t):(A[n]=Q(s),A[n].c(),A[n].m(w,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=k.length}16&t[0]&&d(w,e[4].pages)},d(e){e&&g(t),b(Y,e),b(A,e),u($)}}}function J(e){let t,n,s,l=e[36].name+"";return{c(){t=a("option"),n=m(l),t.__value=s=e[36].fire_id,t.value=t.__value},m(e,s){c(e,t,s),r(t,n)},p(e,a){4&a[0]&&l!==(l=e[36].name+"")&&f(n,l),4&a[0]&&s!==(s=e[36].fire_id)&&(t.__value=s),t.value=t.__value},d(e){e&&g(t)}}}function Q(e){let t,n,s,l=e[6]+"";return{c(){t=a("option"),n=m(l),t.__value=s=e[6],t.value=t.__value},m(e,s){c(e,t,s),r(t,n)},p:h,d(e){e&&g(t)}}}function V(e){let t,n,s,l=e[5].settings.statuses[e[31].status]+"";return{c(){t=a("span"),n=m(l),o(t,"class",s="ml-2 rounded-lg "+e[15][e[31].status]+" text-white text-sm px-2 capitalize svelte-riaew6")},m(e,s){c(e,t,s),r(t,n)},p(e,a){33&a[0]&&l!==(l=e[5].settings.statuses[e[31].status]+"")&&f(n,l),1&a[0]&&s!==(s="ml-2 rounded-lg "+e[15][e[31].status]+" text-white text-sm px-2 capitalize svelte-riaew6")&&o(t,"class",s)},d(e){e&&g(t)}}}function X(e){let t;return{c(){t=m("PICKUP ORDER")},m(e,n){c(e,t,n)},p:h,d(e){e&&g(t)}}}function Z(e){let t,n,s,a=e[31].guest.address+"",r=e[31].guest.address2+"";return{c(){t=m(a),n=l(),s=m(r)},m(e,a){c(e,t,a),c(e,n,a),c(e,s,a)},p(e,n){1&n[0]&&a!==(a=e[31].guest.address+"")&&f(t,a),1&n[0]&&r!==(r=e[31].guest.address2+"")&&f(s,r)},d(e){e&&g(t),e&&g(n),e&&g(s)}}}function ee(e){let t,n,s,l,i=O(e[31].payment.paidAt).format("DD/MM/YYYY h:mmA")+"";return{c(){t=a("p"),n=a("i"),s=m(" Paid on "),l=m(i),o(n,"class","icon ion-md-checkmark-circle pr-1"),o(t,"class","text-sm text-green-500 font-semibold")},m(e,a){c(e,t,a),r(t,n),r(t,s),r(t,l)},p(e,t){1&t[0]&&i!==(i=O(e[31].payment.paidAt).format("DD/MM/YYYY h:mmA")+"")&&f(l,i)},d(e){e&&g(t)}}}function te(e){let t,n,s,l,i=O(e[31].delivery.createdAt).format("DD/MM/YYYY h:mmA")+"";return{c(){t=a("p"),n=a("i"),s=m(" Delivery requested on "),l=m(i),o(n,"class","icon ion-md-cube pr-1"),o(t,"class","text-sm text-orange-500 font-semibold")},m(e,a){c(e,t,a),r(t,n),r(t,s),r(t,l)},p(e,t){1&t[0]&&i!==(i=O(e[31].delivery.createdAt).format("DD/MM/YYYY h:mmA")+"")&&f(l,i)},d(e){e&&g(t)}}}function ne(e){let t,n,s,r;function i(...t){return e[24](e[31],...t)}function d(...t){return e[25](e[31],...t)}return{c(){t=a("button"),t.innerHTML='<i class="icon ion-md-checkmark"></i>',n=l(),s=a("button"),s.innerHTML='<i class="icon ion-md-close"></i>',o(t,"class","action bg-theme svelte-riaew6"),o(s,"class","action bg-theme svelte-riaew6")},m(e,a,l){c(e,t,a),c(e,n,a),c(e,s,a),l&&u(r),r=[p(t,"click",i),p(s,"click",d)]},p(t,n){e=t},d(e){e&&g(t),e&&g(n),e&&g(s),u(r)}}}function se(e){let t,n,s,i,d,h,b,x,v,y,w,$,_,Y,k,A,M,D,j,U=O(e[31].createdAt).format("h:mmA")+"",E=e[31].guest.name+"",I=e[31].guest.phone+"",T=e[5].settings&&V(e);function z(e,t){return e[31].guest.address?Z:X}let C=z(e),P=C(e),H=e[31].payment&&e[31].payment.paidAt&&ee(e),N=e[31].delivery&&te(e);function R(...t){return e[23](e[31],...t)}let B=2==e[31].status&&ne(e);function L(...t){return e[26](e[31],...t)}return{c(){t=a("div"),n=a("p"),s=m(U),i=l(),T&&T.c(),d=l(),h=a("p"),b=m(E),x=l(),v=a("p"),y=m(I),w=l(),$=a("p"),P.c(),_=l(),H&&H.c(),Y=l(),N&&N.c(),A=l(),B&&B.c(),M=l(),D=a("button"),D.innerHTML='<i class="icon ion-logo-whatsapp"></i>',o(n,"class","text-theme font-semibold"),o(h,"class","font-semibold leading-tight"),o(v,"class","leading-tight text-gray-600"),o($,"class","text-sm"),o(t,"class",k="flex-grow p-2 cursor-pointer "+(7==e[31].status||4==e[31].status?"opacity-25":"")),o(D,"class","action bg-theme svelte-riaew6")},m(e,a,l){c(e,t,a),r(t,n),r(n,s),r(n,i),T&&T.m(n,null),r(t,d),r(t,h),r(h,b),r(t,x),r(t,v),r(v,y),r(t,w),r(t,$),P.m($,null),r(t,_),H&&H.m(t,null),r(t,Y),N&&N.m(t,null),c(e,A,a),B&&B.m(e,a),c(e,M,a),c(e,D,a),l&&u(j),j=[p(t,"click",R),p(D,"click",L)]},p(a,r){e=a,1&r[0]&&U!==(U=O(e[31].createdAt).format("h:mmA")+"")&&f(s,U),e[5].settings?T?T.p(e,r):(T=V(e),T.c(),T.m(n,null)):T&&(T.d(1),T=null),1&r[0]&&E!==(E=e[31].guest.name+"")&&f(b,E),1&r[0]&&I!==(I=e[31].guest.phone+"")&&f(y,I),C===(C=z(e))&&P?P.p(e,r):(P.d(1),P=C(e),P&&(P.c(),P.m($,null))),e[31].payment&&e[31].payment.paidAt?H?H.p(e,r):(H=ee(e),H.c(),H.m(t,Y)):H&&(H.d(1),H=null),e[31].delivery?N?N.p(e,r):(N=te(e),N.c(),N.m(t,null)):N&&(N.d(1),N=null),1&r[0]&&k!==(k="flex-grow p-2 cursor-pointer "+(7==e[31].status||4==e[31].status?"opacity-25":""))&&o(t,"class",k),2==e[31].status?B?B.p(e,r):(B=ne(e),B.c(),B.m(M.parentNode,M)):B&&(B.d(1),B=null)},d(e){e&&g(t),T&&T.d(),P.d(),H&&H.d(),N&&N.d(),e&&g(A),B&&B.d(e),e&&g(M),e&&g(D),u(j)}}}function ae(e){let t;const n=new N({props:{$$slots:{default:[se]},$$scope:{ctx:e}}});return{c(){y(n.$$.fragment)},m(e,s){w(n,e,s),t=!0},p(e,t){const s={};41&t[0]|256&t[1]&&(s.$$scope={dirty:t,ctx:e}),n.$set(s)},i(e){t||(v(n.$$.fragment,e),t=!0)},o(e){$(n.$$.fragment,e),t=!1},d(e){_(n,e)}}}function re(e){let t,n,s,i,d,u=O(e[28]).format("ddd D/M/YY")+"",p=e[0][e[28]],h=[];for(let t=0;t<p.length;t+=1)h[t]=ae(q(e,p,t));const y=e=>$(h[e],1,1,()=>{h[e]=null});return{c(){t=a("div"),n=m(u),s=l();for(let e=0;e<h.length;e+=1)h[e].c();i=x(),o(t,"class","rounded-lg bg-theme text-white text-lg font-semibold m-2 p-2")},m(e,a){c(e,t,a),r(t,n),c(e,s,a);for(let t=0;t<h.length;t+=1)h[t].m(e,a);c(e,i,a),d=!0},p(e,t){if((!d||1&t[0])&&u!==(u=O(e[28]).format("ddd D/M/YY")+"")&&f(n,u),61481&t[0]){let n;for(p=e[0][e[28]],n=0;n<p.length;n+=1){const s=q(e,p,n);h[n]?(h[n].p(s,t),v(h[n],1)):(h[n]=ae(s),h[n].c(),v(h[n],1),h[n].m(i.parentNode,i))}for(Y(),n=p.length;n<h.length;n+=1)y(n);k()}},i(e){if(!d){for(let e=0;e<p.length;e+=1)v(h[e]);d=!0}},o(e){h=h.filter(Boolean);for(let e=0;e<h.length;e+=1)$(h[e]);d=!1},d(e){e&&g(t),e&&g(s),b(h,e),e&&g(i)}}}function le(e){let t,n,s;return{c(){t=a("div"),n=a("button"),n.textContent="Show More",o(n,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),o(t,"class","flex justify-center mt-2")},m(a,l,o){c(a,t,l),r(t,n),o&&s(),s=p(n,"click",e[27])},p:h,d(e){e&&g(t),s()}}}function oe(e){let t,n,s,i,d,u,p,m;const f=new H({props:{class:"border-b border-gray-300",tools:e[8]}});f.$on("selected",e[10]);let h=e[2]&&K(e),A=Object.keys(e[0]),M=[];for(let t=0;t<A.length;t+=1)M[t]=re(G(e,A,t));const D=e=>$(M[e],1,1,()=>{M[e]=null});let j=e[1]&&le(e);return{c(){t=a("script"),s=l(),y(f.$$.fragment),i=l(),h&&h.c(),d=l();for(let e=0;e<M.length;e+=1)M[e].c();u=l(),j&&j.c(),p=x(),t.src!==(n="https://unpkg.com/papaparse@latest/papaparse.min.js")&&o(t,"src","https://unpkg.com/papaparse@latest/papaparse.min.js")},m(e,n){r(S.head,t),c(e,s,n),w(f,e,n),c(e,i,n),h&&h.m(e,n),c(e,d,n);for(let t=0;t<M.length;t+=1)M[t].m(e,n);c(e,u,n),j&&j.m(e,n),c(e,p,n),m=!0},p(e,t){if(e[2]?h?h.p(e,t):(h=K(e),h.c(),h.m(d.parentNode,d)):h&&(h.d(1),h=null),61481&t[0]){let n;for(A=Object.keys(e[0]),n=0;n<A.length;n+=1){const s=G(e,A,n);M[n]?(M[n].p(s,t),v(M[n],1)):(M[n]=re(s),M[n].c(),v(M[n],1),M[n].m(u.parentNode,u))}for(Y(),n=A.length;n<M.length;n+=1)D(n);k()}e[1]?j?j.p(e,t):(j=le(e),j.c(),j.m(p.parentNode,p)):j&&(j.d(1),j=null)},i(e){if(!m){v(f.$$.fragment,e);for(let e=0;e<A.length;e+=1)v(M[e]);m=!0}},o(e){$(f.$$.fragment,e),M=M.filter(Boolean);for(let e=0;e<M.length;e+=1)$(M[e]);m=!1},d(e){g(t),e&&g(s),_(f,e),e&&g(i),h&&h.d(e),e&&g(d),b(M,e),e&&g(u),j&&j.d(e),e&&g(p)}}}function ie(e,t,n){let s,a,r,l,o,i;A(e,M,e=>n(17,s=e)),A(e,D,e=>n(3,a=e)),A(e,j,e=>n(18,r=e)),A(e,U,e=>n(19,l=e)),A(e,E,e=>n(5,i=e));let c,d={},u=0,p=!0,m=[],f=C({});function g(e){0==e&&n(1,p=!0),n(6,u=e),I(U,l=!0),T(z(`/orders/${u}`),o,"GET").then(e=>{I(U,l=!1),e.subs&&n(2,c=e.subs),0==e.orders.length?n(1,p=!1):(m=0==u?e.orders:[...m,...e.orders],h())})}function h(){let e={};m.forEach(t=>{let n=O(t.createdAt).format("YYYY-MM-DD");e[n]=[...e[n]||[],t]}),n(0,d=e)}function b(e){e.status=4,I(U,l=!0),T(z("/orders"),{_id:e._id,status:e.status,sub:s.fire_id},"PUT").then(t=>{I(U,l=!1),I(j,r={order:e})})}function x(e){i.settings.billplz_token?(I(U,l=!0),T(z("/payment/billplz"),{order_id:e.invoice_id},"GET").then(t=>{m=m.map(n=>(n.invoice_id==e.invoice_id&&(n.status=3,n.payment={bill_id:t.bill_id,url:t.url}),n)),h(),I(U,l=!1)})):I(D,a=[...a,{view:B}])}function v(e){let t=e.guest.phone;t.startsWith("01")&&(t="6"+t);let n=`https://api.whatsapp.com/send?phone=${t}&text=`,a="";4==e.status?(a=`Hey, we are contacting from *(${s.name||i.settings.name})*. Unfortunately we can't serve you at this moment. Please note that your order has been *canceled*.`,a=`${a} 👉🏻 https://pay.getorders.app/?i=${e.invoice_id}\n\n`):e.status>=3&&(a=`Hey there! We *(${s.name||i.settings.name})* have received your order, tap here to pay now.`,a=`${a} 👉🏻 https://pay.getorders.app/?i=${e.invoice_id}\n\n`);let r=encodeURIComponent(a);document.location.href=`${n}${r}`}A(e,f,e=>n(4,o=e)),f.subscribe(e=>{e.sub&&I(M,s=c.find(t=>t.fire_id==e.sub)),g(0)}),g(0),j.subscribe(e=>{e.order&&(m=m.map(t=>(t.invoice_id==e.order.invoice_id&&(t=e.order),t)),I(j,r={}),h())});return[d,p,c,a,o,i,u,[50,100,150],[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],f,function(e){switch(e.detail.function){case"refresh":g(0);break;case"export":I(D,a=[...a,{view:R}])}},g,b,x,v,["bg-gray-400","bg-gray-400","bg-gray-400","bg-yellow-500","bg-red-400","bg-green-500","bg-pink-500","bg-theme"],m,s,r,l,h,function(){o.sub=P(this),f.set(o),n(2,c)},function(){o.pages=P(this),f.set(o),n(2,c)},e=>I(D,a=[...a,{view:L,order:e}]),e=>x(e),e=>b(e),e=>v(e),()=>g(u+1)]}export default class extends e{constructor(e){var s;super(),S.getElementById("svelte-riaew6-style")||((s=a("style")).id="svelte-riaew6-style",s.textContent=".action.svelte-riaew6{border-radius:9999px;color:#fff;margin-right:0.75rem;width:3rem;height:3rem;text-align:center;align-self:center;font-size:1.5rem;flex:none;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)}",r(S.head,s)),t(this,e,ie,oe,n,{},[-1,-1])}}
//# sourceMappingURL=OrdersMan-102f41ac.js.map
