import{S as t,i as e,s as n,M as r,j as o,m as s,k as l,o as a,p as i,q as c,z as d,e as m,b as u,c as p,h as f,a as g,d as h,w as x,l as y,Q as v,n as $,ae as b,W as w,D as M,E as k,r as _,u as D,t as Y,g as A,x as j,y as T,F as C,L as F,af as I,R as q,C as R,a1 as E}from"./App-d5782211.js";import{T as P}from"./UIToolbar-0212ff30.js";import{U}from"./UIItem-fde1b024.js";import{c as N,a as O,d as z}from"./dayjs.min-d290c2ff.js";function H(t){let e;return{c(){e=m("div"),e.textContent="Activate GetPayments",u(e,"slot","title"),u(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function L(t){let e,n,r,o,s,l,a,i,c;return{c(){e=m("div"),n=m("p"),n.innerHTML="\n            In order to accept payments, your account has to first activate <b>GetPayments</b>.<br>\n            Tap here to contact our support to activate now.\n        ",r=g(),o=m("div"),s=m("button"),s.textContent="Contact Support",l=g(),a=m("div"),i=m("button"),i.textContent="Cancel",u(n,"class","text-gray-800 mb-6 text-center"),u(s,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),u(o,"class","flex justify-center mt-2"),u(i,"class","p-2 w-1/2 shadow-md bg-gray-400 text-white rounded-lg capitalize font-bold h-full shadow-md"),u(a,"class","flex justify-center mt-2"),u(e,"slot","content"),u(e,"class","h-64 p-2")},m(d,m,u){p(d,e,m),h(e,n),h(e,r),h(e,o),h(o,s),h(e,l),h(e,a),h(a,i),u&&x(c),c=[y(s,"click",t[0]),y(i,"click",v)]},p:$,d(t){t&&f(e),x(c)}}}function G(t){let e;return{c(){e=g()},m(t,n){p(t,e,n)},p:$,d(t){t&&f(e)}}}function B(t){let e;const n=new r({props:{$$slots:{default:[G],content:[L],title:[H]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,r){s(n,t,r),e=!0},p(t,[e]){const r={};4&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(l(n.$$.fragment,t),e=!0)},o(t){a(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function S(t,e,n){let r;return c(t,d,t=>n(1,r=t)),[function(){b(`Hello, I would like to activate payments for my GetOrders account.\n üëâüèª My ID : ${r.settings.fire_id}`)}]}class W extends t{constructor(t){super(),e(this,t,S,B,n,{})}}var K=N((function(t,e){t.exports=function(t,e,n){var r=e.prototype;n.en.relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};var o=function(t,e,r,o){for(var s,l,a,i=r.$locale().relativeTime,c=[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],d=c.length,m=0;m<d;m+=1){var u=c[m];u.d&&(s=o?n(t).diff(r,u.d,!0):r.diff(t,u.d,!0));var p=Math.round(Math.abs(s));if(a=s>0,p<=u.r||!u.r){1===p&&m>0&&(u=c[m-1]);var f=i[u.l];l="string"==typeof f?f.replace("%d",p):f(p,e,u.l,a);break}}return e?l:(a?i.future:i.past).replace("%s",l)};r.to=function(t,e){return o(t,e,this,!0)},r.from=function(t,e){return o(t,e,this)};var s=function(t){return t.$u?n.utc():n()};r.toNow=function(t){return this.to(s(this),t)},r.fromNow=function(t){return this.from(s(this),t)}}}));function Q(t,e,n){const r=t.slice();return r[11]=e[n],r}function V(t,e,n){const r=t.slice();return r[14]=e[n],r}function J(t,e,n){const r=t.slice();return r[8]=e[n],r[10]=n,r}function X(t){let e;const n=new F({props:{$$slots:{message:[Z]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,r){s(n,t,r),e=!0},i(t){e||(l(n.$$.fragment,t),e=!0)},o(t){a(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function Z(t){let e;return{c(){e=m("div"),e.textContent="One Moment Please..",u(e,"slot","message")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function tt(t){let e,n,r=t[2]&&X(t);return{c(){e=m("div"),r&&r.c(),u(e,"slot","loader")},m(t,o){p(t,e,o),r&&r.m(e,null),n=!0},p(t,n){t[2]?r?l(r,1):(r=X(t),r.c(),l(r,1),r.m(e,null)):r&&(_(),a(r,1,1,()=>{r=null}),D())},i(t){n||(l(r),n=!0)},o(t){a(r),n=!1},d(t){t&&f(e),r&&r.d()}}}function et(t){let e;return{c(){e=m("div"),e.textContent="View Order",u(e,"slot","title"),u(e,"class","font-semibold text-xl text-gray-600")},m(t,n){p(t,e,n)},d(t){t&&f(e)}}}function nt(t){let e,n,r,o=xt(t[0].guest.phone)+"";return{c(){e=m("p"),n=m("a"),u(n,"href",r="tel:"+t[0].guest.phone),u(e,"class","leading-tight text-lg text-gray-700 mb-2")},m(t,r){p(t,e,r),h(e,n),n.innerHTML=o},p(t,e){1&e&&o!==(o=xt(t[0].guest.phone)+"")&&(n.innerHTML=o),1&e&&r!==(r="tel:"+t[0].guest.phone)&&u(n,"href",r)},d(t){t&&f(e)}}}function rt(t){let e;return{c(){e=m("p"),e.textContent="PICKUP ORDER",u(e,"class","text-sm text-theme uppercase")},m(t,n){p(t,e,n)},p:$,d(t){t&&f(e)}}}function ot(t){let e,n,r,o,s=ht(t[0].guest.address)+"",l=ht(t[0].guest.address2)+"";return{c(){e=m("p"),n=Y(s),r=g(),o=Y(l),u(e,"class","text-sm text-theme uppercase")},m(t,s){p(t,e,s),h(e,n),h(e,r),h(e,o)},p(t,e){1&e&&s!==(s=ht(t[0].guest.address)+"")&&A(n,s),1&e&&l!==(l=ht(t[0].guest.address2)+"")&&A(o,l)},d(t){t&&f(e)}}}function st(t){let e,n=t[8].variant,r=[];for(let e=0;e<n.length;e+=1)r[e]=lt(V(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=j()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);p(t,e,n)},p(t,o){if(1&o){let s;for(n=t[8].variant,s=0;s<n.length;s+=1){const l=V(t,n,s);r[s]?r[s].p(l,o):(r[s]=lt(l),r[s].c(),r[s].m(e.parentNode,e))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(t){T(r,t),t&&f(e)}}}function lt(t){let e,n,r,o=t[14].name+"";return{c(){e=m("p"),n=Y(o),r=g(),u(e,"class","text-sm text-gray-700")},m(t,o){p(t,e,o),h(e,n),h(e,r)},p(t,e){1&e&&o!==(o=t[14].name+"")&&A(n,o)},d(t){t&&f(e)}}}function at(t){let e,n,r,o=yt(t[11])+"";return{c(){e=m("p"),n=Y(o),r=g(),u(e,"class","text-sm text-gray-700")},m(t,o){p(t,e,o),h(e,n),h(e,r)},p(t,e){1&e&&o!==(o=yt(t[11])+"")&&A(n,o)},d(t){t&&f(e)}}}function it(t){let e,n,r,o,s,l,a,i,c,d,x,y,v,$,b,w=t[8].quantity+"",M=(t[8].name||"")+"",k=parseFloat(t[8].unit_price||0).toFixed(2)+"",_=t[8].variant&&st(t),D=t[8].modifiers,j=[];for(let e=0;e<D.length;e+=1)j[e]=at(Q(t,D,e));return{c(){e=m("div"),n=m("div"),r=m("span"),o=Y(w),s=Y("x"),l=g(),a=m("div"),i=m("p"),c=Y(M),d=g(),_&&_.c(),x=g();for(let t=0;t<j.length;t+=1)j[t].c();y=g(),v=m("div"),$=Y(k),u(r,"class","table-cell align-middle"),u(n,"class","flex-none w-10 h-10 text-center rounded-lg bg-gray-200 table text-sm text-gray-700"),u(i,"class","font-semibold"),u(a,"class","flex-grow px-2"),u(v,"class","flex-none w-20 text-right text-sm text-gray-700"),u(e,"class",b="flex "+(t[10]<t[0].cart.length-1?"border-b":"")+" mx-2 p-2 border-gray-200 list-item")},m(t,m){p(t,e,m),h(e,n),h(n,r),h(r,o),h(r,s),h(e,l),h(e,a),h(a,i),h(i,c),h(a,d),_&&_.m(a,null),h(a,x);for(let t=0;t<j.length;t+=1)j[t].m(a,null);h(e,y),h(e,v),h(v,$)},p(t,n){if(1&n&&w!==(w=t[8].quantity+"")&&A(o,w),1&n&&M!==(M=(t[8].name||"")+"")&&A(c,M),t[8].variant?_?_.p(t,n):(_=st(t),_.c(),_.m(a,x)):_&&(_.d(1),_=null),1&n){let e;for(D=t[8].modifiers,e=0;e<D.length;e+=1){const r=Q(t,D,e);j[e]?j[e].p(r,n):(j[e]=at(r),j[e].c(),j[e].m(a,null))}for(;e<j.length;e+=1)j[e].d(1);j.length=D.length}1&n&&k!==(k=parseFloat(t[8].unit_price||0).toFixed(2)+"")&&A($,k),1&n&&b!==(b="flex "+(t[10]<t[0].cart.length-1?"border-b":"")+" mx-2 p-2 border-gray-200 list-item")&&u(e,"class",b)},d(t){t&&f(e),_&&_.d(),T(j,t)}}}function ct(t){let e,n,r,o,s,l,a,i=parseFloat(t[0].delivery_fees).toFixed(2)+"";return{c(){e=m("div"),n=m("p"),r=Y("Delivery charges of "),o=m("b"),s=Y("RM"),l=Y(i),a=Y(" applies for delivery."),u(n,"class","text-green-500"),u(e,"class","p-2 text-right text-sm")},m(t,i){p(t,e,i),h(e,n),h(n,r),h(n,o),h(o,s),h(o,l),h(n,a)},p(t,e){1&e&&i!==(i=parseFloat(t[0].delivery_fees).toFixed(2)+"")&&A(l,i)},d(t){t&&f(e)}}}function dt(t){let e,n,r=t[0].payment.paid?"Thanks! This invoice has been paid.":"Unpaid Invoice";return{c(){e=m("p"),n=Y(r),u(e,"class","text-center text-theme font-semibold")},m(t,r){p(t,e,r),h(e,n)},p(t,e){1&e&&r!==(r=t[0].payment.paid?"Thanks! This invoice has been paid.":"Unpaid Invoice")&&A(n,r)},d(t){t&&f(e)}}}function mt(t){let e,n,r,o,s,l,a,i,c,d,x,y,v,$,b,w,M,k,_,D,j=t[0].guest.name+"",C=z().to(z(t[0].createdAt))+"",F=parseFloat(t[0].grand_total).toFixed(2)+"",I=t[0].guest.phone&&nt(t);function q(t,e){return t[0].guest.address?ot:rt}let R=q(t),E=R(t),P=t[0].cart,U=[];for(let e=0;e<P.length;e+=1)U[e]=it(J(t,P,e));let N=t[0].delivery_fees&&ct(t),O=t[0].payment&&dt(t);return{c(){e=m("div"),n=m("div"),r=m("p"),o=Y(j),s=g(),I&&I.c(),l=g(),E.c(),a=g(),i=m("div"),c=Y(C),d=g();for(let t=0;t<U.length;t+=1)U[t].c();x=g(),y=m("div"),N&&N.c(),v=g(),$=m("div"),b=m("div"),b.textContent="Grand Total",w=g(),M=m("div"),k=Y("RM"),_=Y(F),D=g(),O&&O.c(),u(r,"class","leading-tight font-semibold"),u(n,"class","m-2"),u(i,"class","rounded-lg bg-teal-400 text-white text-sm font-semibold m-2 p-2"),u(b,"class","flex-grow text-left"),u(M,"class","flex-grow text-right ml-2"),u($,"class","flex px-2 mb-2 font-bold"),u(y,"class","flex-none w-full bg-gray-100 shadow-xs p-3 text-center"),u(e,"slot","content"),u(e,"class","p-2")},m(t,m){p(t,e,m),h(e,n),h(n,r),h(r,o),h(n,s),I&&I.m(n,null),h(n,l),E.m(n,null),h(e,a),h(e,i),h(i,c),h(e,d);for(let t=0;t<U.length;t+=1)U[t].m(e,null);h(e,x),h(e,y),N&&N.m(y,null),h(y,v),h(y,$),h($,b),h($,w),h($,M),h(M,k),h(M,_),h(y,D),O&&O.m(y,null)},p(t,r){if(1&r&&j!==(j=t[0].guest.name+"")&&A(o,j),t[0].guest.phone?I?I.p(t,r):(I=nt(t),I.c(),I.m(n,l)):I&&(I.d(1),I=null),R===(R=q(t))&&E?E.p(t,r):(E.d(1),E=R(t),E&&(E.c(),E.m(n,null))),1&r&&C!==(C=z().to(z(t[0].createdAt))+"")&&A(c,C),1&r){let n;for(P=t[0].cart,n=0;n<P.length;n+=1){const o=J(t,P,n);U[n]?U[n].p(o,r):(U[n]=it(o),U[n].c(),U[n].m(e,x))}for(;n<U.length;n+=1)U[n].d(1);U.length=P.length}t[0].delivery_fees?N?N.p(t,r):(N=ct(t),N.c(),N.m(y,v)):N&&(N.d(1),N=null),1&r&&F!==(F=parseFloat(t[0].grand_total).toFixed(2)+"")&&A(_,F),t[0].payment?O?O.p(t,r):(O=dt(t),O.c(),O.m(y,null)):O&&(O.d(1),O=null)},d(t){t&&f(e),I&&I.d(),E.d(),T(U,t),N&&N.d(),O&&O.d()}}}function ut(t){let e,n;const r=new P({props:{tools:t[1],style:t[3]}});return r.$on("selected",t[4]),{c(){e=m("div"),o(r.$$.fragment),u(e,"slot","toolbar")},m(t,o){p(t,e,o),s(r,e,null),n=!0},p(t,e){const n={};2&e&&(n.tools=t[1]),r.$set(n)},i(t){n||(l(r.$$.fragment,t),n=!0)},o(t){a(r.$$.fragment,t),n=!1},d(t){t&&f(e),i(r)}}}function pt(t){let e,n,r;return{c(){e=g(),n=g(),r=g()},m(t,o){p(t,e,o),p(t,n,o),p(t,r,o)},p:$,i:$,o:$,d(t){t&&f(e),t&&f(n),t&&f(r)}}}function ft(t){let e;const n=new r({props:{style:t[5],$$slots:{default:[pt],toolbar:[ut],content:[mt],title:[et],loader:[tt]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,r){s(n,t,r),e=!0},p(t,[e]){const r={};131079&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(l(n.$$.fragment,t),e=!0)},o(t){a(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function gt(t,e,n){return t.replace(new RegExp(e,"g"),n)}function ht(t){return gt(gt(t,", ",","),",",", ")}function xt(t){if(!t)return"";let e=t.match(/.{3}|.{1,2}/g),n="";return e.forEach((t,e)=>{n+=t+(e<2?"<span class='text-gray-600 px-1'>-</span>":"")}),n}function yt(t){let e=1==t.mode?"+ ":2==t.mode?"- ":"",n=3==t.mode?"% ":"",r=parseFloat(t.amount),o=r>0?` ${e}${r.toFixed(2)}${n}`:"";return`${t.name}${o}`}function vt(t,e,n){let r,o;c(t,d,t=>n(6,r=t)),c(t,w,t=>n(7,o=t));let{order:s={}}=e,l=[{name:"Order Link",icon:"paper-plane",function:"link"},{name:"Close",icon:"close-circle",function:"pop_modal"}],a=!1;r.settings&&r.settings.delivery_token&&(l=s.delivery?[{name:"Track Delivery",icon:"cube",function:"track"},...l]:[{name:"Request Delivery",icon:"cube",function:"deliver"},...l]),z.extend(K),a=!0,M(k("/guest/invoice"),{order_id:s.invoice_id},"GET").then(t=>{n(2,a=!1),n(0,s={...s,...t})});return t.$set=t=>{"order"in t&&n(0,s=t.order)},[s,l,a,{container:"justify-end"},function(t){"pop_modal"==t.detail.function&&v(),"link"==t.detail.function&&window.open(`https://pay.getorders.app/?i=${s.invoice_id}`,"_blank"),"track"==t.detail.function&&window.open(`https://www.tracking.my/matdespatch/${s.delivery.tracking_no}`,"_blank"),"deliver"==t.detail.function&&r.settings.delivery_token&&(n(2,a=!0),M(k("/deliver"),{order_id:s.invoice_id}).then(t=>{t._id?(n(0,s.delivery=t,s),C(w,o={order:s}),v()):alert("Delivery request failed. Despatch might be busy, try again."),n(2,a=!1)}))},{content:"overflow-y-scroll scrolling-touch"}]}class $t extends t{constructor(t){super(),e(this,t,vt,ft,n,{order:0})}}const{document:bt}=I;function wt(t,e,n){const r=t.slice();return r[20]=e[n],r}function Mt(t,e,n){const r=t.slice();return r[17]=e[n],r}function kt(t){let e;return{c(){e=Y("PICKUP ORDER")},m(t,n){p(t,e,n)},p:$,d(t){t&&f(e)}}}function _t(t){let e,n,r,o=t[20].guest.address+"",s=t[20].guest.address2+"";return{c(){e=Y(o),n=g(),r=Y(s)},m(t,o){p(t,e,o),p(t,n,o),p(t,r,o)},p(t,n){1&n&&o!==(o=t[20].guest.address+"")&&A(e,o),1&n&&s!==(s=t[20].guest.address2+"")&&A(r,s)},d(t){t&&f(e),t&&f(n),t&&f(r)}}}function Dt(t){let e,n,r,o,s=z(t[20].payment.paidAt).format("DD/MM/YYYY h:mmA")+"";return{c(){e=m("p"),n=m("i"),r=Y(" Paid on "),o=Y(s),u(n,"class","icon ion-md-checkmark-circle pr-1"),u(e,"class","text-sm text-green-500 font-semibold")},m(t,s){p(t,e,s),h(e,n),h(e,r),h(e,o)},p(t,e){1&e&&s!==(s=z(t[20].payment.paidAt).format("DD/MM/YYYY h:mmA")+"")&&A(o,s)},d(t){t&&f(e)}}}function Yt(t){let e,n,r,o,s=z(t[20].delivery.createdAt).format("DD/MM/YYYY h:mmA")+"";return{c(){e=m("p"),n=m("i"),r=Y(" Delivery requested on "),o=Y(s),u(n,"class","icon ion-md-cube pr-1"),u(e,"class","text-sm text-orange-500 font-semibold")},m(t,s){p(t,e,s),h(e,n),h(e,r),h(e,o)},p(t,e){1&e&&s!==(s=z(t[20].delivery.createdAt).format("DD/MM/YYYY h:mmA")+"")&&A(o,s)},d(t){t&&f(e)}}}function At(t){let e,n;function r(...e){return t[14](t[20],...e)}return{c(){e=m("button"),e.innerHTML='<i class="icon ion-md-checkmark-circle-outline"></i>',u(e,"class","action bg-theme svelte-qjn5fh")},m(t,o,s){p(t,e,o),s&&n(),n=y(e,"click",r)},p(e,n){t=e},d(t){t&&f(e),n()}}}function jt(t){let e,n,r,o,s,l,a,i,c,d,v,$,b,w,M,k,_,D=z(t[20].createdAt).format("h:mmA")+"",j=t[20].guest.name+"",T=t[20].guest.phone+"";function C(t,e){return t[20].guest.address?_t:kt}let F=C(t),I=F(t),q=t[20].payment&&t[20].payment.paidAt&&Dt(t),R=t[20].delivery&&Yt(t);function E(...e){return t[13](t[20],...e)}let P=!t[20].payment&&At(t);function U(...e){return t[15](t[20],...e)}return{c(){e=m("div"),n=m("p"),r=Y(D),o=g(),s=m("p"),l=Y(j),a=g(),i=m("p"),c=Y(T),d=g(),v=m("p"),I.c(),$=g(),q&&q.c(),b=g(),R&&R.c(),w=g(),P&&P.c(),M=g(),k=m("button"),k.innerHTML='<i class="icon ion-logo-whatsapp"></i>',u(n,"class","text-theme font-semibold"),u(s,"class","font-semibold leading-tight"),u(i,"class","leading-tight text-gray-600"),u(v,"class","text-sm"),u(e,"class","flex-grow p-2 cursor-pointer"),u(k,"class","action bg-theme svelte-qjn5fh")},m(t,m,u){p(t,e,m),h(e,n),h(n,r),h(e,o),h(e,s),h(s,l),h(e,a),h(e,i),h(i,c),h(e,d),h(e,v),I.m(v,null),h(e,$),q&&q.m(e,null),h(e,b),R&&R.m(e,null),p(t,w,m),P&&P.m(t,m),p(t,M,m),p(t,k,m),u&&x(_),_=[y(e,"click",E),y(k,"click",U)]},p(n,o){t=n,1&o&&D!==(D=z(t[20].createdAt).format("h:mmA")+"")&&A(r,D),1&o&&j!==(j=t[20].guest.name+"")&&A(l,j),1&o&&T!==(T=t[20].guest.phone+"")&&A(c,T),F===(F=C(t))&&I?I.p(t,o):(I.d(1),I=F(t),I&&(I.c(),I.m(v,null))),t[20].payment&&t[20].payment.paidAt?q?q.p(t,o):(q=Dt(t),q.c(),q.m(e,b)):q&&(q.d(1),q=null),t[20].delivery?R?R.p(t,o):(R=Yt(t),R.c(),R.m(e,null)):R&&(R.d(1),R=null),t[20].payment?P&&(P.d(1),P=null):P?P.p(t,o):(P=At(t),P.c(),P.m(M.parentNode,M))},d(t){t&&f(e),I.d(),q&&q.d(),R&&R.d(),t&&f(w),P&&P.d(t),t&&f(M),t&&f(k),x(_)}}}function Tt(t){let e;const n=new U({props:{$$slots:{default:[jt]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,r){s(n,t,r),e=!0},p(t,e){const r={};8388617&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(l(n.$$.fragment,t),e=!0)},o(t){a(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function Ct(t){let e,n,r,o,s,i=z(t[17]).format("ddd D/M/YY")+"",c=t[0][t[17]],d=[];for(let e=0;e<c.length;e+=1)d[e]=Tt(wt(t,c,e));const x=t=>a(d[t],1,1,()=>{d[t]=null});return{c(){e=m("div"),n=Y(i),r=g();for(let t=0;t<d.length;t+=1)d[t].c();o=j(),u(e,"class","rounded-lg bg-theme text-white text-lg font-semibold m-2 p-2")},m(t,l){p(t,e,l),h(e,n),p(t,r,l);for(let e=0;e<d.length;e+=1)d[e].m(t,l);p(t,o,l),s=!0},p(t,e){if((!s||1&e)&&i!==(i=z(t[17]).format("ddd D/M/YY")+"")&&A(n,i),393&e){let n;for(c=t[0][t[17]],n=0;n<c.length;n+=1){const r=wt(t,c,n);d[n]?(d[n].p(r,e),l(d[n],1)):(d[n]=Tt(r),d[n].c(),l(d[n],1),d[n].m(o.parentNode,o))}for(_(),n=c.length;n<d.length;n+=1)x(n);D()}},i(t){if(!s){for(let t=0;t<c.length;t+=1)l(d[t]);s=!0}},o(t){d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)a(d[t]);s=!1},d(t){t&&f(e),t&&f(r),T(d,t),t&&f(o)}}}function Ft(t){let e,n,r;return{c(){e=m("div"),n=m("button"),n.textContent="Show More",u(n,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),u(e,"class","flex justify-center mt-2")},m(o,s,l){p(o,e,s),h(e,n),l&&r(),r=y(n,"click",t[16])},p:$,d(t){t&&f(e),r()}}}function It(t){let e,n,r,c,d,x,y;const v=new P({props:{class:"border-b border-gray-300",tools:t[4]}});v.$on("selected",t[5]);let $=Object.keys(t[0]),b=[];for(let e=0;e<$.length;e+=1)b[e]=Ct(Mt(t,$,e));const w=t=>a(b[t],1,1,()=>{b[t]=null});let M=t[2]&&Ft(t);return{c(){e=m("script"),r=g(),o(v.$$.fragment),c=g();for(let t=0;t<b.length;t+=1)b[t].c();d=g(),M&&M.c(),x=j(),e.src!==(n="https://unpkg.com/papaparse@latest/papaparse.min.js")&&u(e,"src","https://unpkg.com/papaparse@latest/papaparse.min.js")},m(t,n){h(bt.head,e),p(t,r,n),s(v,t,n),p(t,c,n);for(let e=0;e<b.length;e+=1)b[e].m(t,n);p(t,d,n),M&&M.m(t,n),p(t,x,n),y=!0},p(t,[e]){if(393&e){let n;for($=Object.keys(t[0]),n=0;n<$.length;n+=1){const r=Mt(t,$,n);b[n]?(b[n].p(r,e),l(b[n],1)):(b[n]=Ct(r),b[n].c(),l(b[n],1),b[n].m(d.parentNode,d))}for(_(),n=$.length;n<b.length;n+=1)w(n);D()}t[2]?M?M.p(t,e):(M=Ft(t),M.c(),M.m(x.parentNode,x)):M&&(M.d(1),M=null)},i(t){if(!y){l(v.$$.fragment,t);for(let t=0;t<$.length;t+=1)l(b[t]);y=!0}},o(t){a(v.$$.fragment,t),b=b.filter(Boolean);for(let t=0;t<b.length;t+=1)a(b[t]);y=!1},d(t){f(e),t&&f(r),i(v,t),t&&f(c),T(b,t),t&&f(d),M&&M.d(t),t&&f(x)}}}function qt(t,e,n){let r,o,s;c(t,q,t=>n(10,r=t)),c(t,d,t=>n(11,o=t)),c(t,R,t=>n(3,s=t));let l={},a=0,i=!0,m=[];function u(t){0==t&&n(2,i=!0),n(1,a=t),C(q,r=!0),M(k(`/orders/${a}`)).then(t=>{C(q,r=!1),0==t.orders.length?n(2,i=!1):(m=0==a?t.orders:[...m,...t.orders],p())})}function p(){let t={};m.forEach(e=>{let n=z(e.createdAt).format("YYYY-MM-DD");t[n]=[...t[n]||[],e]}),n(0,l=t)}function f(t){o.settings.billplz_token?(C(q,r=!0),M(k("/payment/billplz"),{order_id:t.invoice_id}).then(e=>{m=m.map(n=>(n.invoice_id==t.invoice_id&&(n.payment={bill_id:e.bill_id,url:e.url}),n)),p(),C(q,r=!1)})):C(R,s=[...s,{view:W}])}function g(t){let e=t.guest.phone;e.startsWith("01")&&(e="6"+e);let n=`https://api.whatsapp.com/send?phone=${e}&text=`,r="";t.payment&&(r=`Hey there! We *(${o.settings.name})* have received your order, tap here to pay now.`,r=`${r} üëâüèª https://pay.getorders.app/?i=${t.invoice_id}\n\n`);let s=encodeURIComponent(r);document.location.href=`${n}${s}`}u(0),w.subscribe(t=>{t.order&&(m=m.map(e=>(e.invoice_id==t.order.invoice_id&&(e=t.order),e)),p())});return[l,a,i,s,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],function(t){switch(t.detail.function){case"refresh":u(0);break;case"export":{let t=[];m.forEach(e=>{if(e.payment){let n={order_date:z(e.createdAt).format("MM/DD h:mmA"),name:e.guest.name,phone:e.guest.phone,address:`${e.guest.address||""} ${e.guest.address2||""}`,isPickUp:e.guest.address?"N":"Y",amount:e.payment.amount.toFixed(2),paid:e.payment.paidAt?z(e.payment.paidAt).format("MM/DD h:mmA"):"",invoice:`https://pay.getorders.app/?i=${e.invoice_id}`};t=[...t,n]}}),E(Papa.unparse(t),"orders.csv","text/csv;encoding:utf-8")}}},u,f,g,m,r,o,p,t=>C(R,s=[...s,{view:$t,order:t}]),t=>f(t),t=>g(t),()=>u(a+1)]}export default class extends t{constructor(t){var r;super(),bt.getElementById("svelte-qjn5fh-style")||((r=m("style")).id="svelte-qjn5fh-style",r.textContent=".action.svelte-qjn5fh{border-radius:9999px;color:#fff;margin-right:0.75rem;width:4rem;height:4rem;text-align:center;align-self:center;font-size:1.5rem;flex:none;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)}",h(bt.head,r)),e(this,t,qt,It,n,{})}}
//# sourceMappingURL=OrdersMan-96c9fe10.js.map
