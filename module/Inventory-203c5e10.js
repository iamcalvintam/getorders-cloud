import{S as t,i as e,s as n,e as l,d as s,M as a,j as c,m as o,k as i,o as r,p as d,q as u,X as f,C as m,aj as p,F as v,b as h,c as g,r as y,u as x,h as $,t as b,g as _,a as k,Q as j,R as w,f as A,w as z,l as D,y as P,n as I,T,D as C,E as M,U as q,L as S,x as Y,W as O}from"./App-2e907280.js";import"./UITextField-5853b053.js";import{T as E}from"./UIToolbar-2e400b4e.js";import"./UIItem-770ef2b8.js";import"./UISegmented-9844668a.js";import{d as L}from"./dayjs.min-d290c2ff.js";import{P as U}from"./ProductSelectionView-dd2d3ed8.js";function H(t,e,n){const l=t.slice();return l[25]=e[n],l}function Q(t,e,n){const l=t.slice();return l[28]=e[n],l}function V(t,e,n){const l=t.slice();return l[22]=e[n],l[23]=e,l[24]=n,l}function B(t){let e;const n=new S({props:{$$slots:{message:[F]},$$scope:{ctx:t}}});return{c(){c(n.$$.fragment)},m(t,l){o(n,t,l),e=!0},i(t){e||(i(n.$$.fragment,t),e=!0)},o(t){r(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function F(t){let e;return{c(){e=l("div"),e.textContent="One Moment Please..",h(e,"slot","message")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function G(t){let e,n,s=t[2]&&B(t);return{c(){e=l("div"),s&&s.c(),h(e,"slot","loader")},m(t,l){g(t,e,l),s&&s.m(e,null),n=!0},p(t,n){t[2]?s?i(s,1):(s=B(t),s.c(),i(s,1),s.m(e,null)):s&&(y(),r(s,1,1,()=>{s=null}),x())},i(t){n||(i(s),n=!0)},o(t){r(s),n=!1},d(t){t&&$(e),s&&s.d()}}}function N(t){let e,n,a,c,o=t[1].name+"";return{c(){e=l("div"),n=l("b"),a=b(o),c=b(" Outlet Inventory"),h(e,"slot","title"),h(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,l){g(t,e,l),s(e,n),s(n,a),s(e,c)},p(t,e){2&e[0]&&o!==(o=t[1].name+"")&&_(a,o)},d(t){t&&$(e)}}}function R(t){let e,n,a,c=t[28].name+"";return{c(){e=l("option"),n=b(c),e.__value=a=t[28].id,e.value=e.__value},m(t,l){g(t,e,l),s(e,n)},p(t,l){1&l[0]&&c!==(c=t[28].name+"")&&_(n,c),1&l[0]&&a!==(a=t[28].id)&&(e.__value=a),e.value=e.__value},d(t){t&&$(e)}}}function W(t){let e,n,a,c,o,i,r=t[25].name+"";function d(){t[19].call(n,t[22],t[25])}return{c(){e=l("label"),n=l("input"),a=k(),c=b(r),o=k(),h(n,"type","checkbox"),h(e,"class","px-2 text-sm")},m(l,r,u){g(l,e,r),s(e,n),n.checked=t[22].soldAt[t[25].id],s(e,a),s(e,c),s(e,o),u&&i(),i=D(n,"change",d)},p(e,l){t=e,1&l[0]&&(n.checked=t[22].soldAt[t[25].id])},d(t){t&&$(e),i()}}}function X(t){let e,n,a,c,o,i,r,d,u,f,m,p,v,y,x,I,T,C,M,q,S=t[22].name+"",Y=t[22].variants,O=[];for(let e=0;e<Y.length;e+=1)O[e]=R(Q(t,Y,e));function E(){t[17].call(i,t[22])}function L(){t[18].call(f,t[22])}let U=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],V=[];for(let e=0;e<3;e+=1)V[e]=W(H(t,U,e));function B(){t[20].call(x,t[22])}function F(...e){return t[21](t[22],...e)}return{c(){e=l("tr"),n=l("td"),a=b(S),c=k(),o=l("td"),i=l("select"),r=l("option"),r.textContent="All";for(let t=0;t<O.length;t+=1)O[t].c();d=k(),u=l("td"),f=l("input"),m=k(),p=l("td");for(let t=0;t<3;t+=1)V[t].c();v=k(),y=l("td"),x=l("input"),I=k(),T=l("td"),C=l("button"),C.innerHTML='<i class="icon ion-md-close w-8 h-8 text-center"></i>',M=k(),h(n,"class","text-gray-800 text-left svelte-61u4ux"),r.__value="All",r.value=r.__value,h(i,"class","text-sm"),void 0===t[22].variant_id&&j(E),h(o,"class","svelte-61u4ux"),h(f,"class","border border-gray-300 p-1 w-full"),h(f,"type","text"),h(f,"placeholder","10"),h(u,"class","svelte-61u4ux"),h(p,"class","svelte-61u4ux"),h(x,"type","checkbox"),h(y,"class","svelte-61u4ux"),h(T,"class","svelte-61u4ux"),h(e,"class","text-center")},m(l,h,$){g(l,e,h),s(e,n),s(n,a),s(e,c),s(e,o),s(o,i),s(i,r);for(let t=0;t<O.length;t+=1)O[t].m(i,null);w(i,t[22].variant_id),s(e,d),s(e,u),s(u,f),A(f,t[22].quantity),s(e,m),s(e,p);for(let t=0;t<3;t+=1)V[t].m(p,null);s(e,v),s(e,y),s(y,x),x.checked=t[22].track,s(e,I),s(e,T),s(T,C),s(e,M),$&&z(q),q=[D(i,"change",E),D(f,"input",L),D(x,"change",B),D(C,"click",F)]},p(e,n){if(t=e,1&n[0]&&S!==(S=t[22].name+"")&&_(a,S),1&n[0]){let e;for(Y=t[22].variants,e=0;e<Y.length;e+=1){const l=Q(t,Y,e);O[e]?O[e].p(l,n):(O[e]=R(l),O[e].c(),O[e].m(i,null))}for(;e<O.length;e+=1)O[e].d(1);O.length=Y.length}if(1&n[0]&&w(i,t[22].variant_id),1&n[0]&&f.value!==t[22].quantity&&A(f,t[22].quantity),1&n[0]){let e;for(U=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],e=0;e<3;e+=1){const l=H(t,U,e);V[e]?V[e].p(l,n):(V[e]=W(l),V[e].c(),V[e].m(p,null))}for(;e<3;e+=1)V[e].d(1)}1&n[0]&&(x.checked=t[22].track)},d(t){t&&$(e),P(O,t),P(V,t),z(q)}}}function J(t){let e,n,a,c,o,i,r,d=t[0],u=[];for(let e=0;e<d.length;e+=1)u[e]=X(V(t,d,e));return{c(){e=l("div"),n=l("div"),n.innerHTML='<p class="text-gray-600"><i class="pr-3 self-center fas fa-plus"></i>\n            Add Products\n        </p>',a=k(),c=l("table"),o=l("tr"),o.innerHTML='<td class="svelte-61u4ux">Product</td> \n            <td class="svelte-61u4ux">Variant</td> \n            <td class="w-6 svelte-61u4ux">Quantity</td> \n            <td class="svelte-61u4ux">Stores</td> \n            <td class="svelte-61u4ux">Track</td> \n            <td class="svelte-61u4ux"></td>',i=k();for(let t=0;t<u.length;t+=1)u[t].c();h(n,"class","rounded-lg p-2 border border-dashed cursor-pointer"),h(o,"class","font-semibold text-theme text-sm text-center"),h(c,"class","my-2 svelte-61u4ux"),h(e,"slot","content"),h(e,"class","p-2")},m(l,d,f){g(l,e,d),s(e,n),s(e,a),s(e,c),s(c,o),s(c,i);for(let t=0;t<u.length;t+=1)u[t].m(c,null);f&&r(),r=D(n,"click",t[6])},p(t,e){if(129&e[0]){let n;for(d=t[0],n=0;n<d.length;n+=1){const l=V(t,d,n);u[n]?u[n].p(l,e):(u[n]=X(l),u[n].c(),u[n].m(c,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=d.length}},d(t){t&&$(e),P(u,t),r()}}}function K(t){let e,n;const s=new E({props:{tools:t[4],style:t[3]}});return s.$on("selected",t[5]),{c(){e=l("div"),c(s.$$.fragment),h(e,"slot","toolbar")},m(t,l){g(t,e,l),o(s,e,null),n=!0},p:I,i(t){n||(i(s.$$.fragment,t),n=!0)},o(t){r(s.$$.fragment,t),n=!1},d(t){t&&$(e),d(s)}}}function Z(t){let e,n,l;return{c(){e=k(),n=k(),l=k()},m(t,s){g(t,e,s),g(t,n,s),g(t,l,s)},p:I,i:I,o:I,d(t){t&&$(e),t&&$(n),t&&$(l)}}}function tt(t){let e;const n=new a({props:{style:{body:"screen-height",content:"overflow-y-scroll scrolling-touch"},$$slots:{default:[Z],toolbar:[K],content:[J],title:[N],loader:[G]},$$scope:{ctx:t}}});return{c(){c(n.$$.fragment)},m(t,l){o(n,t,l),e=!0},p(t,e){const l={};7&e[0]|1&e[1]&&(l.$$scope={dirty:e,ctx:t}),n.$set(l)},i(t){e||(i(n.$$.fragment,t),e=!0)},o(t){r(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function et(t,e,n){let l,s,a;u(t,f,t=>n(10,l=t)),u(t,m,t=>n(11,s=t)),u(t,p,t=>n(12,a=t));let c=!1,{defaults:o={}}=e,{account:i={}}=e,{outlet:r={}}=e,{inventories:d=[]}=e,h={container:`justify-end ${c?"opacity-25":""}`};function g(t){n(0,d=d.filter(e=>e.id!=t))}f.subscribe(t=>{t.selected_prods&&(n(0,d=[...d,...t.selected_prods.map(t=>(t.outlet_id||((t={...o,...t}).product_id=t.id,t.variant_id="",t.soldAt={0:!0,1:!0,2:!0}),t))]),v(f,l={}))});return t.$set=t=>{"defaults"in t&&n(8,o=t.defaults),"account"in t&&n(9,i=t.account),"outlet"in t&&n(1,r=t.outlet),"inventories"in t&&n(0,d=t.inventories)},[d,r,c,h,[{name:"Close",icon:"close-circle",function:"pop_modal"},{name:"Save",icon:"checkmark-circle",function:"save"}],async function(t){"pop_modal"==t.detail.function&&T(),"save"==t.detail.function&&(n(2,c=!0),C(M("/inventory"),d.map(t=>{let e=[];return Object.keys(t.soldAt).map(n=>{1==t.soldAt[n]&&(e=[...e,parseInt(n)])}),{...t,soldAt:e}})).then(t=>{v(f,l={inventory:t}),T()}))},function(){v(m,s=[...s,{selected_prods:[],products:a,view:U}])},g,o,i,l,s,a,void 0,void 0,{body:"screen-height",content:"overflow-y-scroll scrolling-touch"},{container:"w-1/2 mx-2"},function(t){t.variant_id=q(this),n(0,d)},function(t){t.quantity=this.value,n(0,d)},function(t,e){t.soldAt[e.id]=this.checked,n(0,d)},function(t){t.track=this.checked,n(0,d)},t=>g(t.id)]}class nt extends t{constructor(t){var a;super(),document.getElementById("svelte-61u4ux-style")||((a=l("style")).id="svelte-61u4ux-style",a.textContent="table.svelte-61u4ux{width:100%}td.svelte-61u4ux{padding-left:0.5rem;padding-right:0.5rem}",s(document.head,a)),e(this,t,et,tt,n,{defaults:8,account:9,outlet:1,inventories:0},[-1,-1])}}function lt(t,e,n){const l=t.slice();return l[21]=e[n],l}function st(t,e,n){const l=t.slice();return l[18]=e[n],l[19]=e,l[20]=n,l}function at(t,e,n){const l=t.slice();return l[3]=e[n],l[25]=n,l}function ct(t){let e,n,a,c=0==t[2].outlets.length&&ot(),o=t[2].outlets,i=[];for(let e=0;e<o.length;e+=1)i[e]=it(at(t,o,e));return{c(){e=l("select"),c&&c.c(),n=Y();for(let t=0;t<i.length;t+=1)i[t].c();h(e,"class","text-xl my-2 w-48")},m(l,o,r){g(l,e,o),c&&c.m(e,null),s(e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null);r&&a(),a=D(e,"change",t[15])},p(t,l){if(0==t[2].outlets.length?c||(c=ot(),c.c(),c.m(e,n)):c&&(c.d(1),c=null),4&l){let n;for(o=t[2].outlets,n=0;n<o.length;n+=1){const s=at(t,o,n);i[n]?i[n].p(s,l):(i[n]=it(s),i[n].c(),i[n].m(e,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=o.length}},d(t){t&&$(e),c&&c.d(),P(i,t),a()}}}function ot(t){let e;return{c(){e=l("option"),e.textContent="Default",e.__value="0",e.value=e.__value},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function it(t){let e,n,a,c=t[3].name+"";return{c(){e=l("option"),n=b(c),e.__value=a=""+t[3].id,e.value=e.__value},m(t,l){g(t,e,l),s(e,n)},p(t,l){4&l&&c!==(c=t[3].name+"")&&_(n,c),4&l&&a!==(a=""+t[3].id)&&(e.__value=a),e.value=e.__value},d(t){t&&$(e)}}}function rt(t){let e,n,a,c=t[0],o=[];for(let e=0;e<c.length;e+=1)o[e]=ft(st(t,c,e));return{c(){e=l("table"),n=l("tr"),n.innerHTML='<td class="svelte-1jp14zd">Product</td> \n        <td class="svelte-1jp14zd">Variant</td> \n        <td class="w-6 svelte-1jp14zd">Quantity</td> \n        <td class="svelte-1jp14zd">Current Qty</td> \n        <td class="svelte-1jp14zd">Stores</td> \n        <td class="svelte-1jp14zd">Track</td> \n        <td class="svelte-1jp14zd">Date/Time</td>',a=k();for(let t=0;t<o.length;t+=1)o[t].c();h(n,"class","font-semibold text-theme text-sm text-center"),h(e,"class","my-2 svelte-1jp14zd")},m(t,l){g(t,e,l),s(e,n),s(e,a);for(let t=0;t<o.length;t+=1)o[t].m(e,null)},p(t,n){if(1&n){let l;for(c=t[0],l=0;l<c.length;l+=1){const s=st(t,c,l);o[l]?o[l].p(s,n):(o[l]=ft(s),o[l].c(),o[l].m(e,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=c.length}},i:I,o:I,d(t){t&&$(e),P(o,t)}}}function dt(t){let e;const n=new S({props:{type:"h-64",$$slots:{message:[mt]},$$scope:{ctx:t}}});return{c(){c(n.$$.fragment)},m(t,l){o(n,t,l),e=!0},p(t,e){const l={};67108864&e&&(l.$$scope={dirty:e,ctx:t}),n.$set(l)},i(t){e||(i(n.$$.fragment,t),e=!0)},o(t){r(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function ut(t){let e,n,a,c,o,i,r=t[21].name+"";return{c(){e=l("label"),n=l("input"),c=k(),o=b(r),i=k(),h(n,"type","checkbox"),n.checked=a=t[18].soldAt.includes(t[21].id),n.disabled=!0,h(e,"class","px-2 text-sm")},m(t,l){g(t,e,l),s(e,n),s(e,c),s(e,o),s(e,i)},p(t,e){1&e&&a!==(a=t[18].soldAt.includes(t[21].id))&&(n.checked=a)},d(t){t&&$(e)}}}function ft(t){let e,n,a,c,o,i,r,d,u,f,m,p,v,y,x,j,w,I,T,C,M,q,S=t[18].name+"",Y=t[18].variant+"",O=t[18].total_left+"",E=L(t[18].createdAt).format("DD/MM/YYYY h:mmA")+"";function U(){t[16].call(u,t[18])}let H=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],Q=[];for(let e=0;e<3;e+=1)Q[e]=ut(lt(t,H,e));function V(){t[17].call(w,t[18])}return{c(){e=l("tr"),n=l("td"),a=b(S),c=k(),o=l("td"),i=b(Y),r=k(),d=l("td"),u=l("input"),f=k(),m=l("td"),p=b(O),v=k(),y=l("td");for(let t=0;t<3;t+=1)Q[t].c();x=k(),j=l("td"),w=l("input"),I=k(),T=l("td"),C=b(E),M=k(),h(n,"class","text-gray-800 text-left svelte-1jp14zd"),h(o,"class","svelte-1jp14zd"),h(u,"class","border border-gray-300 p-1 w-full"),h(u,"type","text"),h(u,"placeholder","10"),u.disabled=!0,h(d,"class","svelte-1jp14zd"),h(m,"class","svelte-1jp14zd"),h(y,"class","svelte-1jp14zd"),h(w,"type","checkbox"),w.disabled=!0,h(j,"class","svelte-1jp14zd"),h(T,"class","text-sm text-gray-700 svelte-1jp14zd"),h(e,"class","text-center hover:bg-gray-200")},m(l,h,$){g(l,e,h),s(e,n),s(n,a),s(e,c),s(e,o),s(o,i),s(e,r),s(e,d),s(d,u),A(u,t[18].quantity),s(e,f),s(e,m),s(m,p),s(e,v),s(e,y);for(let t=0;t<3;t+=1)Q[t].m(y,null);s(e,x),s(e,j),s(j,w),w.checked=t[18].track,s(e,I),s(e,T),s(T,C),s(e,M),$&&z(q),q=[D(u,"input",U),D(w,"change",V)]},p(e,n){if(t=e,1&n&&S!==(S=t[18].name+"")&&_(a,S),1&n&&Y!==(Y=t[18].variant+"")&&_(i,Y),1&n&&u.value!==t[18].quantity&&A(u,t[18].quantity),1&n&&O!==(O=t[18].total_left+"")&&_(p,O),1&n){let e;for(H=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],e=0;e<3;e+=1){const l=lt(t,H,e);Q[e]?Q[e].p(l,n):(Q[e]=ut(l),Q[e].c(),Q[e].m(y,null))}for(;e<3;e+=1)Q[e].d(1)}1&n&&(w.checked=t[18].track),1&n&&E!==(E=L(t[18].createdAt).format("DD/MM/YYYY h:mmA")+"")&&_(C,E)},d(t){t&&$(e),P(Q,t),z(q)}}}function mt(t){let e;return{c(){e=l("div"),e.textContent="One Moment Please..",h(e,"slot","message")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function pt(t){let e,n,a,u,f,m,p,v,b,_,j,w;const A=new E({props:{style:t[4],tools:t[5]}});A.$on("selected",t[6]);let z=t[2]&&ct(t);const D=[dt,rt],P=[];function I(t,e){return!t[0]||t[1]?0:1}return b=I(t),_=P[b]=D[b](t),{c(){e=l("div"),c(A.$$.fragment),a=k(),u=l("div"),f=l("div"),m=l("label"),m.textContent="Outlet",p=k(),z&&z.c(),v=k(),_.c(),j=Y(),h(e,"class",n=t[1]?"opacity-25":""),h(m,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),h(f,"class","p-2 flex-none"),h(u,"class","border-t border-b border-gray-200 flex")},m(t,n){g(t,e,n),o(A,e,null),g(t,a,n),g(t,u,n),s(u,f),s(f,m),s(f,p),z&&z.m(f,null),g(t,v,n),P[b].m(t,n),g(t,j,n),w=!0},p(t,[l]){(!w||2&l&&n!==(n=t[1]?"opacity-25":""))&&h(e,"class",n),t[2]?z?z.p(t,l):(z=ct(t),z.c(),z.m(f,null)):z&&(z.d(1),z=null);let s=b;b=I(t),b===s?P[b].p(t,l):(y(),r(P[s],1,1,()=>{P[s]=null}),x(),_=P[b],_||(_=P[b]=D[b](t),_.c()),i(_,1),_.m(j.parentNode,j))},i(t){w||(i(A.$$.fragment,t),i(_),w=!0)},o(t){r(A.$$.fragment,t),r(_),w=!1},d(t){t&&$(e),d(A),t&&$(a),t&&$(u),z&&z.d(),t&&$(v),P[b].d(t),t&&$(j)}}}function vt(t,e,n){let l,s,a;u(t,p,t=>n(7,l=t)),u(t,f,t=>n(8,s=t)),u(t,m,t=>n(9,a=t));let c,o,i,r=!1,d={container:"border-b border-gray-300"};async function h(){let t={};o.franchise_id&&(t={fran_id:o.franchise_id,outlet_id:i.id}),n(0,c=await C(M("/inventory"),t,"GET"))}async function g(){n(1,r=!0);let t,e={fire_id:o.fire_id};if(o.franchise_id){e={fran_id:o.franchise_id,outlet_id:i.id};try{t=await C(`https://db.getorders.app/products.sl.${o.franchise_id}.${i.id}.json`),"[object Array]"!=Object.prototype.toString.call(t)&&(t=void 0),console.log(t)}catch{console.log("S3 not found")}}return t||(t=await C(M("/guest/products"),e,"GET")),v(p,l=t),n(1,r=!1),l}function y(t){let e=l.find(e=>""+e.id==t.product_id)||{name:"-",variants:[]};if(e.variant="All",t.variant_id){let n=e.variants.find(e=>""+e.id==t.variant_id);n&&(e.variant=n.name)}return{...e,...t}}O(async()=>{let t=await C(M("/accounts"));n(2,o=t[0]),n(3,i=o.outlets.length>0?o.outlets[0]:{id:"",name:"Default"})}),f.subscribe(t=>{t.inventory&&(n(1,r=!0),Promise.all([h()]).then(t=>{n(1,r=!1)}),v(f,s={}))});return t.$$.update=()=>{8&t.$$.dirty&&i&&(v(p,l=[]),n(0,c=[]),n(1,r=!0),Promise.all([g(),h()]).then(t=>{n(1,r=!1)})),129&t.$$.dirty&&l.length>0&&c&&c.length>0&&(n(0,c=c.map(t=>y(t))),console.log(c))},[c,r,o,i,d,[{name:"Create",icon:"add",function:"add"}],function(t){if("add"==t.detail.function&&!r){let t={totals:[],quantity:0,track:!1,enforce:!0,outlet_id:i.id};v(m,a=[...a,{outlet:i,defaults:{...t},view:nt}])}},l,s,a,h,g,function(t){v(m,a=[...a,{product:t,view:ProductView}])},function(t){n(1,r=!0);let e=new Date;t.deletedAt=t.deletedAt?null:e,C(M("/products")).then(t=>{n(1,r=!1),v(f,s={product:t})})},y,t=>n(3,i=o.outlets.find(e=>""+e.id==t.target.value)),function(t){t.quantity=this.value,n(0,c),n(3,i),n(7,l)},function(t){t.track=this.checked,n(0,c),n(3,i),n(7,l)}]}export default class extends t{constructor(t){var a;super(),document.getElementById("svelte-1jp14zd-style")||((a=l("style")).id="svelte-1jp14zd-style",a.textContent="table.svelte-1jp14zd{width:100%}td.svelte-1jp14zd{padding-left:0.5rem;padding-right:0.5rem}",s(document.head,a)),e(this,t,vt,pt,n,{})}}
//# sourceMappingURL=Inventory-203c5e10.js.map
