import{S as t,i as e,s,al as l,e as n,d as a,F as r,G as o,t as c,a as i,x as d,b as u,c as f,g as m,h as p,y as g,j as h,m as y,l as v,v as x,k as j,o as b,p as $,w as O,q as k,U as w,z as E,D as F,E as T,C as q,ak as M,a3 as A}from"./Web-e295f046.js";import{T as P}from"./UIToolbar-5535454f.js";import"./UIItem-4ddab414.js";import{S}from"./UISegmented-8e6dd59f.js";import{d as U}from"./dayjs.min-056200c8.js";const{document:I}=l;function N(t,e,s){const l=t.slice();return l[35]=e[s],l}function D(t,e,s){const l=t.slice();return l[32]=e[s],l}function V(t,e,s){const l=t.slice();return l[29]=e[s],l}function Y(t,e,s){const l=t.slice();return l[26]=e[s],l}function B(t){let e,s,l,r,o,d,g,h,y,v,x,j,b,$,O,k,w,E,F,T=t[8](t[29]).name+"",q=t[32]+"",M=t[35]+"",A=t[2][t[29]][t[32]][t[35]].quantity+"",P=t[2][t[29]][t[32]][t[35]].amount.toFixed(2)+"",S=(t[2][t[29]][t[32]][t[35]].quantity*t[2][t[29]][t[32]][t[35]].amount).toFixed(2)+"";return{c(){e=n("tr"),s=n("td"),l=c(T),r=i(),o=n("td"),d=c(q),g=i(),h=n("td"),y=c(M),v=i(),x=n("td"),j=c(A),b=i(),$=n("td"),O=c(P),k=i(),w=n("td"),E=c(S),F=i(),u(s,"class","svelte-1ioxuj4"),u(o,"class","svelte-1ioxuj4"),u(h,"class","svelte-1ioxuj4"),u(x,"class","svelte-1ioxuj4"),u($,"class","svelte-1ioxuj4"),u(w,"class","svelte-1ioxuj4")},m(t,n){f(t,e,n),a(e,s),a(s,l),a(e,r),a(e,o),a(o,d),a(e,g),a(e,h),a(h,y),a(e,v),a(e,x),a(x,j),a(e,b),a(e,$),a($,O),a(e,k),a(e,w),a(w,E),a(e,F)},p(t,e){8&e[0]&&T!==(T=t[8](t[29]).name+"")&&m(l,T),12&e[0]&&q!==(q=t[32]+"")&&m(d,q),12&e[0]&&M!==(M=t[35]+"")&&m(y,M),12&e[0]&&A!==(A=t[2][t[29]][t[32]][t[35]].quantity+"")&&m(j,A),12&e[0]&&P!==(P=t[2][t[29]][t[32]][t[35]].amount.toFixed(2)+"")&&m(O,P),12&e[0]&&S!==(S=(t[2][t[29]][t[32]][t[35]].quantity*t[2][t[29]][t[32]][t[35]].amount).toFixed(2)+"")&&m(E,S)},d(t){t&&p(e)}}}function H(t){let e,s=Object.keys(t[2][t[29]][t[32]]),l=[];for(let e=0;e<s.length;e+=1)l[e]=B(N(t,s,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=d()},m(t,s){for(let e=0;e<l.length;e+=1)l[e].m(t,s);f(t,e,s)},p(t,n){if(780&n[0]){let a;for(s=Object.keys(t[2][t[29]][t[32]]),a=0;a<s.length;a+=1){const r=N(t,s,a);l[a]?l[a].p(r,n):(l[a]=B(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=s.length}},d(t){g(l,t),t&&p(e)}}}function L(t){let e,s=Object.keys(t[2][t[29]]),l=[];for(let e=0;e<s.length;e+=1)l[e]=H(D(t,s,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=d()},m(t,s){for(let e=0;e<l.length;e+=1)l[e].m(t,s);f(t,e,s)},p(t,n){if(780&n[0]){let a;for(s=Object.keys(t[2][t[29]]),a=0;a<s.length;a+=1){const r=D(t,s,a);l[a]?l[a].p(r,n):(l[a]=H(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=s.length}},d(t){g(l,t),t&&p(e)}}}function C(t){let e,s,l,r,o,h,y,v,x,j,b=t[26]+"",$=t[9](t[26]),O=[];for(let e=0;e<$.length;e+=1)O[e]=L(V(t,$,e));return{c(){e=n("tr"),s=n("td"),l=c(b),r=n("td"),o=n("td"),h=n("td"),y=n("td"),v=n("td"),x=i();for(let t=0;t<O.length;t+=1)O[t].c();j=d(),u(s,"class","svelte-1ioxuj4"),u(r,"class","svelte-1ioxuj4"),u(o,"class","svelte-1ioxuj4"),u(h,"class","svelte-1ioxuj4"),u(y,"class","svelte-1ioxuj4"),u(v,"class","svelte-1ioxuj4"),u(e,"class","bg-gray-600 text-white")},m(t,n){f(t,e,n),a(e,s),a(s,l),a(e,r),a(e,o),a(e,h),a(e,y),a(e,v),f(t,x,n);for(let e=0;e<O.length;e+=1)O[e].m(t,n);f(t,j,n)},p(t,e){if(8&e[0]&&b!==(b=t[26]+"")&&m(l,b),780&e[0]){let s;for($=t[9](t[26]),s=0;s<$.length;s+=1){const l=V(t,$,s);O[s]?O[s].p(l,e):(O[s]=L(l),O[s].c(),O[s].m(j.parentNode,j))}for(;s<O.length;s+=1)O[s].d(1);O.length=$.length}},d(t){t&&p(e),t&&p(x),g(O,t),t&&p(j)}}}function G(t){let e,s,l,d,k,w,E,F,T,q,M,A,U,N,D,V,B,H,L,G,J,Q,z,R,W,_,K,X=t[0].format("ddd D/M/YY")+"";function Z(e){t[12].call(null,e)}d=new P({props:{class:"border-b border-gray-300",tools:t[6]}}),d.$on("selected",t[7]);let tt={style:t[11],label:"Orders Filter",segments:[{name:"Paid",value:"paid"},{name:"All",value:"all"}]};function et(e){t[13].call(null,e)}void 0!==t[4].type&&(tt.value=t[4].type),E=new S({props:tt}),r.push(()=>o(E,"value",Z));let st={style:t[11],label:"Display",segments:[{name:"All",value:""},{name:"By Vendor",value:"true"}]};void 0!==t[1]&&(st.value=t[1]),q=new S({props:st}),r.push(()=>o(q,"value",et));let lt=Object.keys(t[3]),nt=[];for(let e=0;e<lt.length;e+=1)nt[e]=C(Y(t,lt,e));return{c(){e=n("script"),l=i(),h(d.$$.fragment),k=i(),w=n("div"),h(E.$$.fragment),T=i(),h(q.$$.fragment),A=i(),U=n("div"),N=n("button"),N.innerHTML='<i class="far fa-arrow-alt-circle-left"></i>',D=i(),V=n("div"),B=c(X),H=i(),L=n("button"),L.innerHTML='<i class="far fa-arrow-alt-circle-right"></i>',G=i(),J=n("div"),Q=n("table"),z=n("tr"),z.innerHTML='<td class="svelte-1ioxuj4">Product</td> \n            <td class="svelte-1ioxuj4">Variant</td> \n            <td class="svelte-1ioxuj4">Modifiers</td> \n            <td class="svelte-1ioxuj4">Quantity</td> \n            <td class="svelte-1ioxuj4">Unit Price</td> \n            <td class="svelte-1ioxuj4"><b>Total</b></td>',R=i();for(let t=0;t<nt.length;t+=1)nt[t].c();e.src!==(s="https://unpkg.com/papaparse@latest/papaparse.min.js")&&u(e,"src","https://unpkg.com/papaparse@latest/papaparse.min.js"),u(w,"class","border-t border-b border-gray-200 flex"),u(V,"class","flex-grow self-center text-center"),u(U,"class","flex text-lg font-semibold m-2"),u(z,"class","bg-theme text-white rounded-lg"),u(Q,"class","w-full"),u(J,"class","m-2")},m(s,n){a(I.head,e),f(s,l,n),y(d,s,n),f(s,k,n),f(s,w,n),y(E,w,null),a(w,T),y(q,w,null),f(s,A,n),f(s,U,n),a(U,N),a(U,D),a(U,V),a(V,B),a(U,H),a(U,L),f(s,G,n),f(s,J,n),a(J,Q),a(Q,z),a(Q,R);for(let t=0;t<nt.length;t+=1)nt[t].m(Q,null);W=!0,_||(K=[v(N,"click",t[14]),v(L,"click",t[15])],_=!0)},p(t,e){const s={};!F&&16&e[0]&&(F=!0,s.value=t[4].type,x(()=>F=!1)),E.$set(s);const l={};if(!M&&2&e[0]&&(M=!0,l.value=t[1],x(()=>M=!1)),q.$set(l),(!W||1&e[0])&&X!==(X=t[0].format("ddd D/M/YY")+"")&&m(B,X),780&e[0]){let s;for(lt=Object.keys(t[3]),s=0;s<lt.length;s+=1){const l=Y(t,lt,s);nt[s]?nt[s].p(l,e):(nt[s]=C(l),nt[s].c(),nt[s].m(Q,null))}for(;s<nt.length;s+=1)nt[s].d(1);nt.length=lt.length}},i(t){W||(j(d.$$.fragment,t),j(E.$$.fragment,t),j(q.$$.fragment,t),W=!0)},o(t){b(d.$$.fragment,t),b(E.$$.fragment,t),b(q.$$.fragment,t),W=!1},d(t){p(e),t&&p(l),$(d,t),t&&p(k),t&&p(w),$(E),$(q),t&&p(A),t&&p(U),t&&p(G),t&&p(J),g(nt,t),_=!1,O(K)}}}function J(t,e,s){let l,n,a;k(t,w,t=>s(20,l=t)),k(t,E,t=>s(21,a=t));let r=U(),o=M({type:"paid"}),c="";k(t,o,t=>s(4,n=t));let i={},d=[],u=[],f={"All Orders":[]};function m(t){q(w,l=!0),F(T("/orders"),{groupBy:"products",order_type:n.type,from:r.startOf("day").toJSON(),to:r.endOf("day").toJSON()},"GET").then(t=>{q(w,l=!1),s(2,i=t.variants),d=t.products,s(3,f),s(1,c),s(19,u)})}function p(t){return d.find(e=>e.id.toString()==t)||{name:"-"}}function g(t){return"All Orders"==t?Object.keys(i):Object.keys(i).filter(e=>f[t].includes(e))}function h(t){s(0,r=r.add(t,"day")),m()}m(),F(T("/vendor")).then(t=>{s(19,u=t)}),o.subscribe(t=>{m()});return t.$$.update=()=>{if(524290&t.$$.dirty[0])if("true"==c){let t={};u.forEach(e=>{t[e.name]=e.products.map(t=>t.id)}),s(3,f=t)}else s(3,f={"All Orders":[]})},[r,c,i,f,n,o,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],function(t){switch(t.detail.function){case"refresh":m();break;case"export":{let t=[];Object.keys(f).forEach(e=>{g(e).forEach(s=>{Object.keys(i[s]).forEach(l=>{Object.keys(i[s][l]).forEach(n=>{let a=i[s][l][n],r={Product:p(s).name,Variant:l,Modifiers:n,Quantity:a.quantity,"Unit Price":a.amount.toFixed(2),Total:(a.quantity*a.amount).toFixed(2)};"All Orders"!=e&&(r.Vendor=e),t=[...t,r]})})})}),A(Papa.unparse(t),"orders.csv","text/csv;encoding:utf-8")}}},p,g,h,{container:"p-2 flex-none",label:"w-32"},function(t){n.type=t,o.set(n)},function(t){c=t,s(1,c)},()=>h(-1),()=>h(1)]}export default class extends t{constructor(t){var l;super(),I.getElementById("svelte-1ioxuj4-style")||((l=n("style")).id="svelte-1ioxuj4-style",l.textContent="td.svelte-1ioxuj4{padding:0.5rem}",a(I.head,l)),e(this,t,J,G,s,{},[-1,-1])}}
//# sourceMappingURL=OrderSummary-1b6e3a15.js.map
