{"version":3,"file":"Settings-5ec62cd9.js","sources":["../../src/UI/UIList.html","../../src/Settings.html"],"sourcesContent":["<script>\n  import { slide } from 'svelte/transition';\n  import { quintInOut } from 'svelte/easing';\n  export let value = [], label = \"\", placeholder = \"\", style = {}\n  function add(){\n    value = [...value, \"\"]\n  }\n  function remove(index){\n    value = [...value.slice(0,index), ...value.slice(index+1,value.length)];\n  }\n</script>\n<div class=\"{style.container}\">\n    <div class=\"flex\">\n      <label class=\"flex-grow self-center text-xs uppercase text-gray-500 font-semibold\">{label}</label>\n      <button class=\"flex-none\" on:click=\"{add}\">\n        <i class=\"icon ion-md-add text-xl\"></i>\n      </button>\n    </div>\n  {#each value as field, i}\n    <div class=\"flex rounded-lg bg-gray-100 p-2 my-2\" transition:slide=\"{{ duration: 300, easing: quintInOut }}\">\n      <input type=\"text\" class=\"flex-grow bg-gray-100 self-center\" placeholder=\"{placeholder}\" value=\"{field}\"/>\n      <button class=\"flex-none ml-2\" on:click=\"{ ()=>remove(i)}\">\n        <i class=\"icon ion-md-close text-xl\"></i>\n      </button>\n    </div>\n  {/each}\n</div>","<script>\n  import dayjs from \"dayjs\";\n  import Segmented from \"./UI/UISegmented.html\";\n  import TextField from \"./UI/UITextField.html\";\n  import Toolbar from \"./UI/UIToolbar.html\";\n  import List from \"./UI/UIList.html\";\n  import { onMount } from \"svelte\";\n  import {\n    session,\n    loading,\n    api,\n    alert,\n    accounts,\n    account,\n    trigger,\n    fetch,\n    settings,\n    s3,\n  } from \"./CTStore.js\";\n  let intervals = [45, 30, 15, 10, 5],\n    interval = 30;\n  let tools = [{ name: \"Save\", icon: \"cloud-done\", function: \"save\" }],\n    start_time = [8, 0],\n    end_time = [23, 30];\n\n  console.log($settings.settings);\n  if ($settings.settings.speedy_token) {\n    $settings.setting.delivery_method = 0;\n  }\n  if ($settings.settings.bungkusit_id) {\n    $settings.setting.delivery_method = 0;\n  }\n  let file;\n  function selected(e) {\n    switch (e.detail.function) {\n      case \"save\":\n        $loading = true;\n        //      if ($settings.settings.speedy_token) {\n        //   $settings.setting.delivery_method = 0;\n        // }\n        // if ($settings.settings.bungkusit_id) {\n        //   $settings.setting.delivery_method = 0;\n        // }\n        console.log($settings.setting);\n        // fetch(api(\"/settings\"), $settings.settings)\n        //   .then((o) => {\n        //     $settings = o;\n        //     $loading = false;\n        //   })\n        //   .catch((e) => {});\n        break;\n    }\n  }\n\n  function tf_disp(t) {\n    var ta = t.split(\":\"),\n      am = \"AM\";\n    var hr = parseInt(ta);\n    if (hr > 12) {\n      hr -= 12;\n      am = \"PM\";\n    }\n    return `${hr}:${ta[1]}${am}`;\n  }\n  function tf(t) {\n    var min = `${t[1]}`;\n    if (t[1] < 10) min = `0${min}`;\n    return `${t[0]}:${min}`;\n  }\n  function removeSlot(slot) {\n    $settings.settings.timeslots = $settings.settings.timeslots.filter(\n      (t) => t != slot\n    );\n  }\n  function resetSlots(interval) {\n    var time = start_time.slice();\n    let slots = [tf(time)];\n    for (var i = 1; i < 60; i++) {\n      if (time[0] >= end_time[0] && time[1] >= end_time[1]) break;\n      time[1] += interval;\n      if (time[1] >= 60) {\n        time[0] += 1;\n        time[1] = time[1] - 60;\n      }\n      slots = [...slots, tf(time)];\n    }\n    $settings.settings.timeslots = slots;\n  }\n  let field_style = { container: \"p-2 md:w-1/2 flex-none\", label: \"w-32\" };\n  function readFile() {\n    let reader = new FileReader();\n    reader.readAsDataURL(file.files[0]);\n    reader.onload = () => {\n      let file_content = reader.result;\n      $settings.settings.logo_raw = file_content;\n    };\n  }\n</script>\n<style>\n  .sect {\n    @apply text-xl font-bold mt-3;\n  }\n</style>\n<Toolbar\n  class=\"border-b border-gray-300\"\n  on:selected=\"{selected}\"\n  tools=\"{tools}\"\n/>\n{#if $settings.settings}\n<p class=\"sect text-theme\">Your Details</p>\n<TextField\n  style=\"{field_style}\"\n  label=\"Business Name\"\n  bind:value=\"{$settings.settings.name}\"\n/>\n<div class=\"{field_style.container}\">\n  <label\n    class=\"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2\"\n    >Business Logo</label\n  >\n  <label\n    class=\"p-2 block rounded cursor-pointer border shadow-sm { !$settings.settings.logo_raw ? '' : 'bg-theme text-white'}\"\n  >\n    {#if !$settings.settings.logo_raw}\n    <i class=\"icon ion-md-cloud-upload px-1\"></i>\n    <span class=\"mt-2 text-base leading-normal\">Upload Image</span>\n    {:else}\n    <i class=\"icon ion-md-cloud-done px-1\"></i>\n    <span class=\"mt-2 text-base leading-normal\">Image Selected</span>\n    {/if}\n    <input\n      type=\"file\"\n      class=\"hidden\"\n      bind:this=\"{file}\"\n      on:change=\"{readFile}\"\n    />\n  </label>\n  {#if $settings.settings.logo}\n  <div\n    class=\"w-16 h-16 m-1 border bg-cover bg-center\"\n    style=\"background-image: url({s3}{$settings.settings.logo})\"\n  ></div>\n  {/if}\n</div>\n\n<div class=\"{field_style.container}\">\n  <label\n    class=\"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2 {field_style.label}\"\n    >Time Slots</label\n  >\n  <div class=\"border rounded shadow-sm p-2 w-full flex flex-wrap mb-2\">\n    {#if $settings.settings.timeslots.length > 0} {#each\n    $settings.settings.timeslots as timeslot}\n    <span\n      class=\"inline-block p-2 rounded-lg text-xs bg-theme text-white m-1\"\n      on:click=\"{ () => removeSlot(timeslot) }\"\n      >{tf_disp(timeslot)}<i class=\"icon ion-md-close pl-2 font-semibold\"></i\n    ></span>\n    {/each} {:else}\n    <p\n      class=\"text-gray-500 cursor-pointer\"\n      on:click=\"{ () => resetSlots(interval) }\"\n    >\n      No Time Slots Specified. Tap To Add Time Slots.\n    </p>\n    {/if}\n  </div>\n  {#if $settings.settings.timeslots.length > 0}\n  <button\n    on:click=\"{ () => $settings.settings.timeslots = [] }\"\n    class=\"p-1 px-2 bg-theme rounded-lg text-sm text-white mr-2\"\n  >\n    Clear\n  </button>\n  <button\n    on:click=\"{ () => resetSlots(interval) }\"\n    class=\"p-1 px-2 bg-theme rounded-lg text-sm text-white mr-2\"\n  >\n    Reset\n  </button>\n  <select bind:value=\"{interval}\" on:change=\"{ () => resetSlots(interval) }\">\n    {#each intervals as itv}\n    <option value=\"{itv}\">{itv} minutes</option>\n    {/each}\n  </select>\n  {/if}\n</div>\n\n<p class=\"sect text-theme\">Pickup Location</p>\n<TextField\n  style=\"{field_style}\"\n  label=\"Address\"\n  bind:value=\"{$settings.settings.address}\"\n/>\n<TextField\n  style=\"{field_style}\"\n  label=\"Address 2\"\n  bind:value=\"{$settings.settings.address2}\"\n/>\n<TextField\n  style=\"{field_style}\"\n  label=\"Postcode\"\n  bind:value=\"{$settings.settings.postcode}\"\n/>\n<TextField\n  style=\"{field_style}\"\n  label=\"Coordinates\"\n  placeholder=\"3.123123,4.123231\"\n  bind:value=\"{$settings.settings.coordinates}\"\n/>\n\n<p class=\"text-xs px-3 mb-3 font-semibold\">\n  Ensure that the details above is correct, as price estimation and riders\n  depend on the accuracy of this information.\n</p>\n<p class=\"sect text-theme\">Orders</p>\n<div>\n  <Segmented\n    style=\"{field_style}\"\n    label=\"Status\"\n    segments=\"{[{ name : 'Online', value : false}, { name : 'Offline', value : true}]}\"\n    bind:value=\"{$settings.settings.offline}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"Identifier\"\n    bind:value=\"{$settings.settings.short_id}\"\n  />\n  <p class=\"text-xs px-3 mb-3 font-semibold\">\n    <a\n      href=\"https://getorders.app/#{$settings.settings.short_id}\"\n      target=\"_blank\"\n      >https://getorders.app/#{$settings.settings.short_id}</a\n    >\n  </p>\n  <TextField\n    style=\"{field_style}\"\n    label=\"SST Tax (%)\"\n    bind:value=\"{$settings.settings.tax}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"Delivery Fees\"\n    bind:value=\"{$settings.settings.delivery_fees}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"Phone Number\"\n    bind:value=\"{$settings.settings.phone}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"Announcement\"\n    bind:value=\"{$settings.settings.announcement}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"Checkout Notes\"\n    bind:value=\"{$settings.settings.checkout_notes}\"\n  />\n  {#if $settings.settings.order_methods != 'no_delivery'}\n  <TextField\n    style=\"{field_style}\"\n    label=\"MrSpeedy ID\"\n    bind:value=\"{$settings.settings.speedy_token}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"BungkusIt ID\"\n    bind:value=\"{$settings.settings.bungkusit_id}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"BungkusIt Key\"\n    bind:value=\"{$settings.settings.bungkusit_key}\"\n  />\n  {/if}\n  <!-- {#if $settings.settings.speedy_token && $settings.settings.bungkusit_id\n  && $settings.settings.bungkusit_key} -->\n  <Segmented\n    style=\"{field_style}\"\n    label=\"Delivery Methods\"\n    segments=\"{[{ name : 'MrSpeedy', value : 0, hidden: true },\n   { name : 'Bungkusit', value : 1, hidden : $settings.settings.bungkusit_id? false : true }]}\"\n    bind:value=\"{$settings.settings.delivery_method}\"\n  />\n  <!-- {/if} -->\n  <Segmented\n    style=\"{field_style}\"\n    label=\"Order Methods\"\n    segments=\"{[{ name : 'All', value : ''}, { name : 'No Delivery', value : 'no_delivery'}, { name : 'No Pickup', value : 'no_pickup'}]}\"\n    bind:value=\"{$settings.settings.order_methods}\"\n  />\n  <Segmented\n    style=\"{field_style}\"\n    label=\"List Layout\"\n    segments=\"{[{ name : 'Grid', value : ''}, { name : 'List', value : 'list'}]}\"\n    bind:value=\"{$settings.settings.list_style}\"\n  />\n</div>\n<p class=\"sect text-theme\">Loyalty</p>\n<div>\n  <TextField\n    style=\"{field_style}\"\n    label=\"Multiplier\"\n    bind:value=\"{$settings.settings.multiplier}\"\n  />\n  <Segmented\n    style=\"{field_style}\"\n    label=\"Rounding\"\n    segments=\"{[{ name : 'No Rounding', value : ''}, { name : 'Round Down', value : 'round_down'}, { name : 'Round Up', value : 'round_up'}]}\"\n    bind:value=\"{$settings.settings.rounding}\"\n  />\n  <List\n    style=\"{field_style}\"\n    label=\"Deduction Presets\"\n    placeholder=\"e.g : 100\"\n    bind:value=\"{$settings.settings.deduct_presets}\"\n  />\n</div>\n<p class=\"sect text-theme\">Website</p>\n<div>\n  <TextField\n    style=\"{field_style}\"\n    label=\"Google Analytic ID\"\n    bind:value=\"{$settings.settings.google_analytic_id}\"\n  />\n  <TextField\n    style=\"{field_style}\"\n    label=\"Facebook Pixel ID\"\n    bind:value=\"{$settings.settings.facebook_pixel_id}\"\n  />\n</div>\n{/if}\n"],"names":["ctx","duration","easing","quintInOut","length","container","value","label","placeholder","style","remove","index","slice","i","settings","short_id","logo_raw","name","logo","timeslots","address","address2","postcode","coordinates","offline","tax","delivery_fees","phone","announcement","checkout_notes","order_methods","hidden","bungkusit_id","delivery_method","list_style","multiplier","rounding","deduct_presets","google_analytic_id","facebook_pixel_id","s3","tf_disp","speedy_token","bungkusit_key","t","ta","split","am","hr","parseInt","tf","min","file","intervals","interval","start_time","end_time","removeSlot","slot","$settings","filter","resetSlots","time","slots","console","log","setting","icon","function","e","detail","$loading","reader","FileReader","readAsDataURL","files","onload","file_content","result","timeslot"],"mappings":"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"}