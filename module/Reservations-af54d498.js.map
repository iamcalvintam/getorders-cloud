{"version":3,"file":"Reservations-af54d498.js","sources":["../../src/ReservationSlots.html","../../src/ReservationBooking.html","../../src/Reservations.html"],"sourcesContent":["<script>\n  import { fly, fade } from 'svelte/transition';\n  import { quintInOut } from 'svelte/easing';\n  import dayjs from \"dayjs\"\n  import { session, loading, api, alert, trigger, login_errors, public_key, headers, settings } from './CTStore.js';\n  let slots = $settings.settings.time_slots || []\n  let intervals = [], def_interval = 0, start_time = [8, 30], end_time = [21, 30]\n  for (var i = 1; i < 60; i++) {\n    var m = 5 * i\n    intervals = [...intervals, m]\n    if (m >= 60) break;\n  }\n  function tf_disp(t) {\n    var ta = t.split(':'), am = 'AM'\n    var hr = parseInt(ta)\n    if (hr > 12) {\n      hr -= 12\n      am = 'PM'\n    }\n    return `${hr}:${ta[1]}${am}`\n  }\n  function tf(t) {\n    var min = `${t[1]}`\n    if (t[1] < 10) min = `0${min}`\n    return `${t[0]}:${min}`\n  }\n  function resetSlots(interval) {\n    def_interval = interval\n    var time = start_time.slice()\n    slots = [tf(time)]\n    for (var i = 1; i < 60; i++) {\n      if (time[0] >= end_time[0] && time[1] >= end_time[1]) break;\n      time[1] += interval\n      if (time[1] >= 60) {\n        time[0] += 1\n        time[1] = time[1] - 60\n      }\n      slots = [...slots, tf(time)]\n    }\n  }\n  function removeSlot(slot) {\n    slots = slots.filter(s => s != slot)\n  }\n  function save() {\n    $loading = true;\n    $settings.settings.time_slots = slots\n    fetch(api('/settings'), headers($settings.settings)).then(r => r.json()).then(o => {\n      $settings = o;\n      $loading = false;\n      $trigger = undefined;\n    }).catch(e => { });\n  }\n</script>\n<div class=\"flex flex-col-reverse absolute w-full h-full z-50 antialiased\">\n  <div class=\"flex-none md:flex-grow\"></div>\n  <div transition:fly=\"{{ y : 300, easing : quintInOut }}\"\n    class=\"rounded-t-lg md:rounded-lg flex-none bg-white w-full self-center md:w-1/2\">\n    <p class=\"text-center font-semibold text-2xl text-gray-600 m-2\">\n      Time Slots\n    </p>\n    {#if slots.length==0}\n<div class=\"flex flex-col w-full text-center h-64\">\n  <div class=\"flex-grow\"></div>\n  <div class=\"text-gray-600 text-xl\">\n    <p>No time slots added. Select an interval to generate time slots.</p>\n  </div>\n  <div class=\"flex-grow\"></div>\n</div>\n    {:else}\n  <div class=\"flex flex-wrap m-3 overflow-y-auto h-64\">\n    {#each slots as slot}\n    <button class=\"border-orange-400 border-2 p-2 m-2 rounded-lg text-orange-400\" on:click=\"{ () => removeSlot(slot)}\">\n      {tf_disp(slot)} <i class=\"far fa-times-circle pl-2\"></i>\n    </button>\n    {/each}\n  \n  </div>\n    {/if}\n  <div class=\"shadow-inner p-2\">\n  <div class=\"text-sm text-gray-500 font-semibold\">Interval</div>\n  <div class=\"p-2 overflow-x-auto w-full flex flex-no-wrap\">\n    {#each intervals as interval}\n    <div class=\"flex-none bg-blue-{ def_interval==interval ? '500' : '300'} text-white p-2 mx-2 rounded text-sm float-left\" on:click=\"{ () => resetSlots(interval)}\">\n      {interval} min\n    </div>\n    {/each}\n  </div>\n  </div>\n  <div class=\"border-t border-gray-200 flex flex-row-reverse\">\n  <button class=\"w-1/3 m-2 px-2 bg-green-400 rounded-lg font-bold h-10 text-white\" on:click=\"{save}\">\n      Save\n  </button>\n  <button class=\"w-1/3 m-2 px-2 bg-gray-400 rounded-lg font-bold h-10 text-white\" on:click=\"{ () => $trigger = undefined}\">\n      Cancel\n  </button>\n  </div>\n    \n  </div>\n  <div class=\"flex-none md:flex-grow\"></div>\n</div>\n<div class=\"bg-dark fixed h-full z-40 w-full\" transition:fade=\"{{ easing : quintInOut }}\" on:click=\"{ () => $trigger = undefined }\"></div>","<script>\n  import { fly, fade } from 'svelte/transition';\n  import { quintInOut } from 'svelte/easing';\n  import dayjs from \"dayjs\"\n  import { onMount } from 'svelte';\n  import { session, loading, api, alert, trigger, login_errors, public_key, headers, settings } from './CTStore.js';\n  let bookings = [], booking_fields = [], def_booking = $settings.settings.booking_slots || 0\n  let fields = $settings.settings.booking_fields || []\n  let allFields = ['name','email','phone']\n  let msg = $settings.settings.booking_message || \"\"\n  for(var i=1;i<60;i++){\n    bookings = [...bookings, i]\n  }\n  onMount(() => {\n      booking_fields[def_booking].scrollIntoView();\n  });\n  function toggleField(f){\n    var len = fields.length\n    fields = fields.filter(o => o!=f)\n    if(fields.length==len){\n      fields = [...fields,f]\n    }\n  }\n  function save(){\n    $loading = true;\n    let changes = {booking_fields : fields, booking_slots : def_booking, booking_message : msg}\n    fetch(api('/settings'), headers(changes)).then(r => r.json()).then(o => {\n          $settings = o;\n          $loading = false;\n      $trigger = undefined;\n    }).catch(e => {});\n  }\n</script>\n<div class=\"flex flex-col-reverse absolute w-full h-full z-50 antialiased\">\n  <div class=\"flex-none md:flex-grow\"></div>\n  <div transition:fly=\"{{ y : 300, easing : quintInOut }}\" class=\"rounded-t-lg md:rounded-lg flex-none bg-white w-full self-center md:w-1/2\">\n  <p class=\"text-center font-semibold text-2xl text-gray-600 m-2\">\n    Bookings\n  </p>\n\n  <div class=\"shadow-lg p-3\">\n  <div class=\"text-sm text-gray-500 font-semibold\">Open Bookings Per Time Slot</div>\n  <div class=\"p-2 overflow-x-auto w-full flex flex-no-wrap\">\n    {#each bookings as booking,i}\n    <button bind:this=\"{booking_fields[i]}\" class=\"flex-none w-20 bg-blue-{ def_booking==booking ? '500' : '300'} text-white p-2 mx-2 rounded text-sm float-left\" on:click=\"{ () => def_booking = booking}\">\n      {booking}\n    </button>\n    {/each}\n  </div>\n  </div>\n<div class=\"shadow-lg p-3\">\n  <div class=\"text-sm text-gray-500 font-semibold\">Required Information</div>\n  <div class=\"p-2 overflow-x-auto w-full flex flex-no-wrap\">\n    {#each allFields as f}\n    <button class=\"border-blue-400 border-2 p-2 m-2 w-32 rounded-lg text-blue-400 bounce capitalize\" on:click=\"{ () => toggleField(f) }\">\n      <i class=\"far fa{fields.includes(f) ? '-check' : '' }-circle pr-2\"></i>{f}\n    </button>\n    {/each}\n  </div>\n  <div class=\"text-sm text-gray-500 font-semibold\">Display Message</div>\n  <div class=\"border border-gray-300 focus-within:border-teal-500 rounded-lg p-2 my-2 bg-white flex\">\n    <input class=\"flex-grow focus:outline-none\" type=\"text\" placeholder=\"Hello, we are open daily from 9-5. Book an hour before.\" bind:value=\"{msg}\"/>\n  </div>\n</div>\n<div class=\"border-t border-gray-200 flex flex-row-reverse\">\n  <button class=\"w-1/3 m-2 px-2 bg-green-400 rounded-lg font-bold h-10 text-white\" on:click=\"{save}\">\n      Save\n  </button>\n  <button class=\"w-1/3 m-2 px-2 bg-gray-400 rounded-lg font-bold h-10 text-white\" on:click=\"{ () => $trigger = undefined}\">\n      Cancel\n  </button>\n</div>\n    \n  </div>\n  <div class=\"flex-none md:flex-grow\"></div>\n</div>\n<div class=\"bg-dark fixed h-full z-40 w-full\" transition:fade=\"{{ easing : quintInOut }}\" on:click=\"{ () => $trigger = undefined }\"></div>","<script>\n  import { onMount } from 'svelte';\n  import { session, loading, api, alert, accounts, trigger, settings, headers } from './CTStore.js';\n  import Slots from './ReservationSlots.html'\n  import Bookings from './ReservationBooking.html'\n  function toggleLive() {\n    $loading = true;\n    let reservations = $settings.settings.reservations == true ? false : true;\n    $settings.settings.reservations = reservations;\n    fetch(api('/settings'), headers($settings.settings)).then(r => r.json()).then(o => {\n      $settings = o;\n      $loading = false;\n      $trigger = undefined;\n    }).catch(e => { });\n  }\n</script>\n\n<div class=\"border-b border-gray-300 p-3 m-0 clearfix\">\n  <button class=\"float-left mr-2 px-2 bg-gray-600 rounded-lg capitalize font-bold h-10 text-white\"\n    on:click=\"{ () => $trigger = { class : Slots }}\">\n    <i class=\"fas fa-clock pr-2\"></i> Slots\n  </button>\n  <button class=\"float-left px-2 bg-gray-600 rounded-lg capitalize font-bold h-10 text-white\"\n    on:click=\"{ () => $trigger = { class : Bookings }}\">\n    <i class=\"fas fa-book pr-2\"></i> Settings\n  </button>\n  {#if $settings.settings}\n    <div class=\"float-right\">\n\t\t\t      <button class=\"bg-gray-300 w-16 px-2 h-10 rounded-lg clearfix\" on:click=\"{toggleLive}\">\n\t\t\t      <div class=\"w-1/2 rounded-lg h-6 {$settings.settings.reservations==true ? 'float-right bg-green-300 text-green-300' : 'bg-gray-500 text-gray-500'}\">o</div>\n\t\t\t      </button>\n\t\t\t      <p class=\"inline-block text-gray-500 pl-1\">Live</p>\n\t\t\t    </div>\n    {/if}\n  </div>"],"names":["ctx","length","tf_disp","y","easing","quintInOut","t","ta","split","am","hr","parseInt","tf","min","slots","$settings","settings","time_slots","intervals","def_interval","start_time","end_time","i","m","resetSlots","interval","time","slice","removeSlot","slot","filter","s","$loading","fetch","api","headers","then","r","json","o","$trigger","undefined","catch","e","includes","bookings","booking_fields","def_booking","booking_slots","fields","msg","booking_message","toggleField","f","len","onMount","scrollIntoView","changes","booking","reservations","class","Slots","Bookings"],"mappings":"6ZAsEWA,0BAALC,wOAAKD,aAALC,6HAAAA,qYAECC,EAAQF,6TAARE,EAAQF,qEAWRA,sIAD6BA,MAAcA,MAAW,MAAQ,2IAC9DA,oDAD6BA,MAAcA,MAAW,MAAQ,uLAtB9C,GAAdA,KAAMC,+BAqBJD,0BAALC,4yCAQwFD,yIARnFA,aAALC,6HAAAA,sCA1BoBE,EAAI,IAAKC,OAASC,uCA6CsBD,OAASC,4CA7CjDF,EAAI,IAAKC,OAASC,8BA6CsBD,OAASC,6GAxFhEH,EAAQI,OACXC,EAAKD,EAAEE,MAAM,KAAMC,EAAK,KACxBC,EAAKC,SAASJ,UACdG,EAAK,KACPA,GAAM,GACND,EAAK,SAEGC,KAAMH,EAAG,KAAKE,aAEjBG,EAAGN,OACNO,KAASP,EAAE,YACXA,EAAE,GAAK,KAAIO,MAAUA,QACfP,EAAE,MAAMO,6FAnBhBC,EAAQC,EAAUC,SAASC,eAC3BC,KAAgBC,EAAe,EAAGC,GAAc,EAAG,IAAKC,GAAY,GAAI,YACnEC,EAAI,EAAGA,EAAI,GAAIA,SAClBC,EAAI,EAAID,KACZJ,MAAgBA,EAAWK,GACvBA,GAAK,kBAgBFC,EAAWC,OAClBN,EAAeM,OACXC,EAAON,EAAWO,YACtBb,GAASF,EAAGc,aACHJ,EAAI,EAAGA,EAAI,MACdI,EAAK,IAAML,EAAS,IAAMK,EAAK,IAAML,EAAS,IAD5BC,IAEtBI,EAAK,IAAMD,EACPC,EAAK,IAAM,KACbA,EAAK,IAAM,EACXA,EAAK,GAAKA,EAAK,GAAK,QAEtBZ,MAAYA,EAAOF,EAAGc,cAGjBE,EAAWC,OAClBf,EAAQA,EAAMgB,OAAOC,GAAKA,GAAKF,sCAG/BG,GAAW,OACXjB,EAAUC,SAASC,WAAaH,KAChCmB,MAAMC,EAAI,aAAcC,EAAQpB,EAAUC,WAAWoB,KAAKC,GAAKA,EAAEC,QAAQF,KAAKG,QAC5ExB,EAAYwB,OACZP,GAAW,OACXQ,OAAWC,KACVC,MAAMC,uBAqBuFf,EAAWC,MAW+BL,EAAWC,WAUrDe,OAAWC,WAQHD,OAAWC,sNCvDhHzC,oLADqEA,MAAaA,MAAU,MAAQ,+IACpGA,yDADqEA,MAAaA,MAAU,MAAQ,6JAW7BA,0HAAvDA,KAAO4C,SAAS5C,OAAK,SAAW,sNAAhCA,KAAO4C,SAAS5C,OAAK,SAAW,8IAZ5CA,2BAALC,qCAUKD,4BAALC,i7DAQyID,wHAIjDA,2EAtBnFA,aAALC,qIAAAA,8BAUKD,cAALC,uIAAAA,uBAQyID,UAAAA,oCA1BrHG,EAAI,IAAKC,OAASC,uCAyCsBD,OAASC,4CAzCjDF,EAAI,IAAKC,OAASC,8BAyCsBD,OAASC,kMAtErEwC,KAAeC,KAAqBC,EAAchC,EAAUC,SAASgC,eAAiB,EACtFC,EAASlC,EAAUC,SAAS8B,mBAE5BI,EAAMnC,EAAUC,SAASmC,iBAAmB,WACxC7B,EAAE,EAAEA,EAAE,GAAGA,IACfuB,MAAeA,EAAUvB,YAKlB8B,EAAYC,OACfC,EAAML,EAAOhD,WACjBgD,EAASA,EAAOnB,OAAOS,GAAKA,GAAGc,IAC5BJ,EAAOhD,QAAQqD,OAChBL,MAAaA,EAAOI,IAPxBE,OACIT,EAAeC,GAAaS,yCANf,OAAO,QAAQ,0BAgB9BxB,GAAW,OACPyB,GAAWX,eAAiBG,EAAQD,cAAgBD,EAAaI,gBAAkBD,GACvFjB,MAAMC,EAAI,aAAcC,EAAQsB,IAAUrB,KAAKC,GAAKA,EAAEC,QAAQF,KAAKG,QAC7DxB,EAAYwB,OACZP,GAAW,OACfQ,OAAWC,KACVC,MAAMC,0BAcWG,EAAexB,mCAAfwB,EAAexB,sBAA6IyB,EAAcW,MAU3EN,EAAYC,cAOYH,6BAO3CV,OAAWC,WAQHD,OAAWC,sOC/C3C,GAAjCzC,KAAUgB,SAAS2C,aAAqB,0CAA4C,iPAD5C3D,mDACP,GAAjCA,KAAUgB,SAAS2C,aAAqB,0CAA4C,kGAHxH3D,KAAUgB,wjBAAVhB,KAAUgB,uNApBbgB,GAAW,OACP2B,EAAkD,GAAnC5C,EAAUC,SAAS2C,iBACtC5C,EAAUC,SAAS2C,aAAeA,KAClC1B,MAAMC,EAAI,aAAcC,EAAQpB,EAAUC,WAAWoB,KAAKC,GAAKA,EAAEC,QAAQF,KAAKG,QAC5ExB,EAAYwB,OACZP,GAAW,OACXQ,OAAWC,KACVC,MAAMC,kBAMSH,GAAaoB,MAAQC,YAIrBrB,GAAaoB,MAAQE"}