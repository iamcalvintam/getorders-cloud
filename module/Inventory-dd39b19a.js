import{S as t,i as e,s as n,e as l,d as s,M as a,j as c,m as o,k as i,o as r,p as u,q as d,X as f,B as m,aj as p,C as v,b,c as h,r as g,u as x,h as y,t as $,g as _,a as k,P as w,Q as A,f as D,l as j,y as P,w as I,n as T,R as C,D as M,E as q,T as S,L as Y,x as O,V as E}from"./Web-531cadf8.js";import"./UITextField-21781ba2.js";import{T as L}from"./UIToolbar-e99beaea.js";import"./UIItem-4c1b8fbb.js";import"./UISegmented-55cf01e5.js";import{d as H}from"./dayjs.min-056200c8.js";import{P as Q}from"./ProductSelectionView-ce9ee763.js";function U(t,e,n){const l=t.slice();return l[26]=e[n],l[27]=e,l[28]=n,l}function V(t,e,n){const l=t.slice();return l[29]=e[n],l}function B(t,e,n){const l=t.slice();return l[23]=e[n],l[24]=e,l[25]=n,l}function G(t){let e,n;return e=new Y({props:{$$slots:{message:[F]},$$scope:{ctx:t}}}),{c(){c(e.$$.fragment)},m(t,l){o(e,t,l),n=!0},i(t){n||(i(e.$$.fragment,t),n=!0)},o(t){r(e.$$.fragment,t),n=!1},d(t){u(e,t)}}}function F(t){let e;return{c(){e=l("div"),e.textContent="One Moment Please..",b(e,"slot","message")},m(t,n){h(t,e,n)},d(t){t&&y(e)}}}function N(t){let e,n,s=t[2]&&G(t);return{c(){e=l("div"),s&&s.c(),b(e,"slot","loader")},m(t,l){h(t,e,l),s&&s.m(e,null),n=!0},p(t,n){t[2]?s?4&n[0]&&i(s,1):(s=G(t),s.c(),i(s,1),s.m(e,null)):s&&(g(),r(s,1,1,()=>{s=null}),x())},i(t){n||(i(s),n=!0)},o(t){r(s),n=!1},d(t){t&&y(e),s&&s.d()}}}function R(t){let e,n,a,c,o=t[1].name+"";return{c(){e=l("div"),n=l("b"),a=$(o),c=$(" Outlet Inventory"),b(e,"slot","title"),b(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,l){h(t,e,l),s(e,n),s(n,a),s(e,c)},p(t,e){2&e[0]&&o!==(o=t[1].name+"")&&_(a,o)},d(t){t&&y(e)}}}function W(t){let e,n,a,c=t[29].name+"";return{c(){e=l("option"),n=$(c),e.__value=a=t[29].id,e.value=e.__value},m(t,l){h(t,e,l),s(e,n)},p(t,l){1&l[0]&&c!==(c=t[29].name+"")&&_(n,c),1&l[0]&&a!==(a=t[29].id)&&(e.__value=a,e.value=e.__value)},d(t){t&&y(e)}}}function X(t){let e,n,a,c,o,i,r,u=t[26].name+"";function d(){t[12].call(n,t[26],t[24],t[25])}return{c(){e=l("label"),n=l("input"),a=k(),c=$(u),o=k(),b(n,"type","checkbox"),b(e,"class","px-2 text-sm")},m(l,u){h(l,e,u),s(e,n),n.checked=t[23].soldAt[t[26].id],s(e,a),s(e,c),s(e,o),i||(r=j(n,"change",d),i=!0)},p(e,l){t=e,1&l[0]&&(n.checked=t[23].soldAt[t[26].id])},d(t){t&&y(e),i=!1,r()}}}function z(t){let e,n,a,c,o,i,r,u,d,f,m,p,v,g,x,T,C,M,q,S,Y,O=t[23].name+"",E=t[23].variants,L=[];for(let e=0;e<E.length;e+=1)L[e]=W(V(t,E,e));function H(){t[10].call(i,t[24],t[25])}function Q(){t[11].call(f,t[24],t[25])}let B=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],G=[];for(let e=0;e<3;e+=1)G[e]=X(U(t,B,e));function F(){t[13].call(x,t[24],t[25])}function N(...e){return t[14](t[23],...e)}return{c(){e=l("tr"),n=l("td"),a=$(O),c=k(),o=l("td"),i=l("select"),r=l("option"),r.textContent="All";for(let t=0;t<L.length;t+=1)L[t].c();u=k(),d=l("td"),f=l("input"),m=k(),p=l("td");for(let t=0;t<3;t+=1)G[t].c();v=k(),g=l("td"),x=l("input"),T=k(),C=l("td"),M=l("button"),M.innerHTML='<i class="icon ion-md-close w-8 h-8 text-center"></i>',q=k(),b(n,"class","text-gray-800 text-left svelte-90ubxu"),r.__value="All",r.value=r.__value,b(i,"class","text-sm"),void 0===t[23].variant_id&&w(H),b(o,"class","svelte-90ubxu"),b(f,"class","border border-gray-300 p-1 w-full"),b(f,"type","text"),b(f,"placeholder","10"),b(d,"class","svelte-90ubxu"),b(p,"class","svelte-90ubxu"),b(x,"type","checkbox"),b(g,"class","svelte-90ubxu"),b(C,"class","svelte-90ubxu"),b(e,"class","text-center")},m(l,b){h(l,e,b),s(e,n),s(n,a),s(e,c),s(e,o),s(o,i),s(i,r);for(let t=0;t<L.length;t+=1)L[t].m(i,null);A(i,t[23].variant_id),s(e,u),s(e,d),s(d,f),D(f,t[23].quantity),s(e,m),s(e,p);for(let t=0;t<3;t+=1)G[t].m(p,null);s(e,v),s(e,g),s(g,x),x.checked=t[23].track,s(e,T),s(e,C),s(C,M),s(e,q),S||(Y=[j(i,"change",H),j(f,"input",Q),j(x,"change",F),j(M,"click",N)],S=!0)},p(e,n){if(t=e,1&n[0]&&O!==(O=t[23].name+"")&&_(a,O),1&n[0]){let e;for(E=t[23].variants,e=0;e<E.length;e+=1){const l=V(t,E,e);L[e]?L[e].p(l,n):(L[e]=W(l),L[e].c(),L[e].m(i,null))}for(;e<L.length;e+=1)L[e].d(1);L.length=E.length}if(1&n[0]&&A(i,t[23].variant_id),1&n[0]&&f.value!==t[23].quantity&&D(f,t[23].quantity),1&n[0]){let e;for(B=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],e=0;e<3;e+=1){const l=U(t,B,e);G[e]?G[e].p(l,n):(G[e]=X(l),G[e].c(),G[e].m(p,null))}for(;e<3;e+=1)G[e].d(1)}1&n[0]&&(x.checked=t[23].track)},d(t){t&&y(e),P(L,t),P(G,t),S=!1,I(Y)}}}function J(t){let e,n,a,c,o,i,r,u,d=t[0],f=[];for(let e=0;e<d.length;e+=1)f[e]=z(B(t,d,e));return{c(){e=l("div"),n=l("div"),n.innerHTML='<p class="text-gray-600"><i class="pr-3 self-center fas fa-plus"></i>\n            Add Products</p>',a=k(),c=l("table"),o=l("tr"),o.innerHTML='<td class="svelte-90ubxu">Product</td> \n            <td class="svelte-90ubxu">Variant</td> \n            <td class="w-6 svelte-90ubxu">Quantity</td> \n            <td class="svelte-90ubxu">Stores</td> \n            <td class="svelte-90ubxu">Track</td> \n            <td class="svelte-90ubxu"></td>',i=k();for(let t=0;t<f.length;t+=1)f[t].c();b(n,"class","rounded-lg p-2 border border-dashed cursor-pointer"),b(o,"class","font-semibold text-theme text-sm text-center"),b(c,"class","my-2 svelte-90ubxu"),b(e,"slot","content"),b(e,"class","p-2")},m(l,d){h(l,e,d),s(e,n),s(e,a),s(e,c),s(c,o),s(c,i);for(let t=0;t<f.length;t+=1)f[t].m(c,null);r||(u=j(n,"click",t[6]),r=!0)},p(t,e){if(129&e[0]){let n;for(d=t[0],n=0;n<d.length;n+=1){const l=B(t,d,n);f[n]?f[n].p(l,e):(f[n]=z(l),f[n].c(),f[n].m(c,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=d.length}},d(t){t&&y(e),P(f,t),r=!1,u()}}}function K(t){let e,n,s;return n=new L({props:{tools:t[4],style:t[3]}}),n.$on("selected",t[5]),{c(){e=l("div"),c(n.$$.fragment),b(e,"slot","toolbar")},m(t,l){h(t,e,l),o(n,e,null),s=!0},p:T,i(t){s||(i(n.$$.fragment,t),s=!0)},o(t){r(n.$$.fragment,t),s=!1},d(t){t&&y(e),u(n)}}}function Z(t){let e,n,l;return{c(){e=k(),n=k(),l=k()},m(t,s){h(t,e,s),h(t,n,s),h(t,l,s)},p:T,i:T,o:T,d(t){t&&y(e),t&&y(n),t&&y(l)}}}function tt(t){let e,n;return e=new a({props:{style:{body:"screen-height",content:"overflow-y-scroll scrolling-touch"},$$slots:{default:[Z],toolbar:[K],content:[J],title:[R],loader:[N]},$$scope:{ctx:t}}}),{c(){c(e.$$.fragment)},m(t,l){o(e,t,l),n=!0},p(t,n){const l={};7&n[0]|2&n[1]&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){n||(i(e.$$.fragment,t),n=!0)},o(t){r(e.$$.fragment,t),n=!1},d(t){u(e,t)}}}function et(t,e,n){let l,s,a;d(t,f,t=>n(15,l=t)),d(t,m,t=>n(16,s=t)),d(t,p,t=>n(17,a=t));let c=!1,{defaults:o={}}=e,{account:i={}}=e,{outlet:r={}}=e,{inventories:u=[]}=e,b={container:"justify-end "+(c?"opacity-25":"")};function h(t){n(0,u=u.filter(e=>e.id!=t))}f.subscribe(t=>{t.selected_prods&&(n(0,u=[...u,...t.selected_prods.map(t=>(t.outlet_id||((t={...o,...t}).product_id=t.id,t.variant_id="",t.soldAt={0:!0,1:!0,2:!0}),t))]),v(f,l={}))});return t.$$set=t=>{"defaults"in t&&n(8,o=t.defaults),"account"in t&&n(9,i=t.account),"outlet"in t&&n(1,r=t.outlet),"inventories"in t&&n(0,u=t.inventories)},[u,r,c,b,[{name:"Close",icon:"close-circle",function:"pop_modal"},{name:"Save",icon:"checkmark-circle",function:"save"}],async function(t){"pop_modal"==t.detail.function&&C(),"save"==t.detail.function&&(n(2,c=!0),M(q("/inventory"),u.map(t=>{let e=[];return Object.keys(t.soldAt).map(n=>{1==t.soldAt[n]&&(e=[...e,parseInt(n)])}),{...t,soldAt:e}})).then(t=>{v(f,l={inventory:t}),C()}))},function(){v(m,s=[...s,{selected_prods:[],products:a,view:Q}])},h,o,i,function(t,e){t[e].variant_id=S(this),n(0,u)},function(t,e){t[e].quantity=this.value,n(0,u)},function(t,e,l){e[l].soldAt[t.id]=this.checked,n(0,u)},function(t,e){t[e].track=this.checked,n(0,u)},t=>h(t.id)]}class nt extends t{constructor(t){var a;super(),document.getElementById("svelte-90ubxu-style")||((a=l("style")).id="svelte-90ubxu-style",a.textContent="table.svelte-90ubxu{width:100%}td.svelte-90ubxu{padding-left:0.5rem;padding-right:0.5rem}",s(document.head,a)),e(this,t,et,tt,n,{defaults:8,account:9,outlet:1,inventories:0},[-1,-1])}}function lt(t,e,n){const l=t.slice();return l[21]=e[n],l}function st(t,e,n){const l=t.slice();return l[18]=e[n],l[19]=e,l[20]=n,l}function at(t,e,n){const l=t.slice();return l[3]=e[n],l[25]=n,l}function ct(t){let e,n,a,c,o=0==t[2].outlets.length&&ot(),i=t[2].outlets,r=[];for(let e=0;e<i.length;e+=1)r[e]=it(at(t,i,e));return{c(){e=l("select"),o&&o.c(),n=O();for(let t=0;t<r.length;t+=1)r[t].c();b(e,"class","text-xl my-2 w-48")},m(l,i){h(l,e,i),o&&o.m(e,null),s(e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null);a||(c=j(e,"change",t[7]),a=!0)},p(t,l){if(0==t[2].outlets.length?o||(o=ot(),o.c(),o.m(e,n)):o&&(o.d(1),o=null),4&l){let n;for(i=t[2].outlets,n=0;n<i.length;n+=1){const s=at(t,i,n);r[n]?r[n].p(s,l):(r[n]=it(s),r[n].c(),r[n].m(e,null))}for(;n<r.length;n+=1)r[n].d(1);r.length=i.length}},d(t){t&&y(e),o&&o.d(),P(r,t),a=!1,c()}}}function ot(t){let e;return{c(){e=l("option"),e.textContent="Default",e.__value="0",e.value=e.__value},m(t,n){h(t,e,n)},d(t){t&&y(e)}}}function it(t){let e,n,a,c=t[3].name+"";return{c(){e=l("option"),n=$(c),e.__value=a=""+t[3].id,e.value=e.__value},m(t,l){h(t,e,l),s(e,n)},p(t,l){4&l&&c!==(c=t[3].name+"")&&_(n,c),4&l&&a!==(a=""+t[3].id)&&(e.__value=a,e.value=e.__value)},d(t){t&&y(e)}}}function rt(t){let e,n,a,c=t[0],o=[];for(let e=0;e<c.length;e+=1)o[e]=ft(st(t,c,e));return{c(){e=l("table"),n=l("tr"),n.innerHTML='<td class="svelte-90ubxu">Product</td> \n        <td class="svelte-90ubxu">Variant</td> \n        <td class="w-6 svelte-90ubxu">Quantity</td> \n        <td class="svelte-90ubxu">Current Qty</td> \n        <td class="svelte-90ubxu">Stores</td> \n        <td class="svelte-90ubxu">Track</td> \n        <td class="svelte-90ubxu">Date/Time</td>',a=k();for(let t=0;t<o.length;t+=1)o[t].c();b(n,"class","font-semibold text-theme text-sm text-center"),b(e,"class","my-2 svelte-90ubxu")},m(t,l){h(t,e,l),s(e,n),s(e,a);for(let t=0;t<o.length;t+=1)o[t].m(e,null)},p(t,n){if(1&n){let l;for(c=t[0],l=0;l<c.length;l+=1){const s=st(t,c,l);o[l]?o[l].p(s,n):(o[l]=ft(s),o[l].c(),o[l].m(e,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=c.length}},i:T,o:T,d(t){t&&y(e),P(o,t)}}}function ut(t){let e,n;return e=new Y({props:{type:"h-64",$$slots:{message:[mt]},$$scope:{ctx:t}}}),{c(){c(e.$$.fragment)},m(t,l){o(e,t,l),n=!0},p(t,n){const l={};67108864&n&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){n||(i(e.$$.fragment,t),n=!0)},o(t){r(e.$$.fragment,t),n=!1},d(t){u(e,t)}}}function dt(t){let e,n,a,c,o,i,r=t[21].name+"";return{c(){e=l("label"),n=l("input"),c=k(),o=$(r),i=k(),b(n,"type","checkbox"),n.checked=a=t[18].soldAt.includes(t[21].id),n.disabled=!0,b(e,"class","px-2 text-sm")},m(t,l){h(t,e,l),s(e,n),s(e,c),s(e,o),s(e,i)},p(t,e){1&e&&a!==(a=t[18].soldAt.includes(t[21].id))&&(n.checked=a)},d(t){t&&y(e)}}}function ft(t){let e,n,a,c,o,i,r,u,d,f,m,p,v,g,x,w,A,T,C,M,q,S,Y,O=t[18].name+"",E=t[18].variant+"",L=t[18].total_left+"",Q=H(t[18].createdAt).format("DD/MM/YYYY h:mmA")+"";function U(){t[8].call(d,t[19],t[20])}let V=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],B=[];for(let e=0;e<3;e+=1)B[e]=dt(lt(t,V,e));function G(){t[9].call(A,t[19],t[20])}return{c(){e=l("tr"),n=l("td"),a=$(O),c=k(),o=l("td"),i=$(E),r=k(),u=l("td"),d=l("input"),f=k(),m=l("td"),p=$(L),v=k(),g=l("td");for(let t=0;t<3;t+=1)B[t].c();x=k(),w=l("td"),A=l("input"),T=k(),C=l("td"),M=$(Q),q=k(),b(n,"class","text-gray-800 text-left svelte-90ubxu"),b(o,"class","svelte-90ubxu"),b(d,"class","border border-gray-300 p-1 w-full"),b(d,"type","text"),b(d,"placeholder","10"),d.disabled=!0,b(u,"class","svelte-90ubxu"),b(m,"class","svelte-90ubxu"),b(g,"class","svelte-90ubxu"),b(A,"type","checkbox"),A.disabled=!0,b(w,"class","svelte-90ubxu"),b(C,"class","text-sm text-gray-700 svelte-90ubxu"),b(e,"class","text-center hover:bg-gray-200")},m(l,b){h(l,e,b),s(e,n),s(n,a),s(e,c),s(e,o),s(o,i),s(e,r),s(e,u),s(u,d),D(d,t[18].quantity),s(e,f),s(e,m),s(m,p),s(e,v),s(e,g);for(let t=0;t<3;t+=1)B[t].m(g,null);s(e,x),s(e,w),s(w,A),A.checked=t[18].track,s(e,T),s(e,C),s(C,M),s(e,q),S||(Y=[j(d,"input",U),j(A,"change",G)],S=!0)},p(e,n){if(t=e,1&n&&O!==(O=t[18].name+"")&&_(a,O),1&n&&E!==(E=t[18].variant+"")&&_(i,E),1&n&&d.value!==t[18].quantity&&D(d,t[18].quantity),1&n&&L!==(L=t[18].total_left+"")&&_(p,L),1&n){let e;for(V=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],e=0;e<3;e+=1){const l=lt(t,V,e);B[e]?B[e].p(l,n):(B[e]=dt(l),B[e].c(),B[e].m(g,null))}for(;e<3;e+=1)B[e].d(1)}1&n&&(A.checked=t[18].track),1&n&&Q!==(Q=H(t[18].createdAt).format("DD/MM/YYYY h:mmA")+"")&&_(M,Q)},d(t){t&&y(e),P(B,t),S=!1,I(Y)}}}function mt(t){let e;return{c(){e=l("div"),e.textContent="One Moment Please..",b(e,"slot","message")},m(t,n){h(t,e,n)},d(t){t&&y(e)}}}function pt(t){let e,n,a,d,f,m,p,v,$,_,w,A,D;n=new L({props:{style:t[4],tools:t[5]}}),n.$on("selected",t[6]);let j=t[2]&&ct(t);const P=[ut,rt],I=[];function T(t,e){return!t[0]||t[1]?0:1}return _=T(t),w=I[_]=P[_](t),{c(){e=l("div"),c(n.$$.fragment),d=k(),f=l("div"),m=l("div"),p=l("label"),p.textContent="Outlet",v=k(),j&&j.c(),$=k(),w.c(),A=O(),b(e,"class",a=t[1]?"opacity-25":""),b(p,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),b(m,"class","p-2 flex-none"),b(f,"class","border-t border-b border-gray-200 flex")},m(t,l){h(t,e,l),o(n,e,null),h(t,d,l),h(t,f,l),s(f,m),s(m,p),s(m,v),j&&j.m(m,null),h(t,$,l),I[_].m(t,l),h(t,A,l),D=!0},p(t,[n]){(!D||2&n&&a!==(a=t[1]?"opacity-25":""))&&b(e,"class",a),t[2]?j?j.p(t,n):(j=ct(t),j.c(),j.m(m,null)):j&&(j.d(1),j=null);let l=_;_=T(t),_===l?I[_].p(t,n):(g(),r(I[l],1,1,()=>{I[l]=null}),x(),w=I[_],w||(w=I[_]=P[_](t),w.c()),i(w,1),w.m(A.parentNode,A))},i(t){D||(i(n.$$.fragment,t),i(w),D=!0)},o(t){r(n.$$.fragment,t),r(w),D=!1},d(t){t&&y(e),u(n),t&&y(d),t&&y(f),j&&j.d(),t&&y($),I[_].d(t),t&&y(A)}}}function vt(t,e,n){let l,s,a;d(t,p,t=>n(10,l=t)),d(t,f,t=>n(11,s=t)),d(t,m,t=>n(12,a=t));let c,o,i,r=!1,u={container:"border-b border-gray-300"};async function b(){let t={};o.franchise_id&&(t={fran_id:o.franchise_id,outlet_id:i.id}),n(0,c=await M(q("/inventory"),t,"GET"))}async function h(){n(1,r=!0);let t,e={fire_id:o.fire_id};if(o.franchise_id){e={fran_id:o.franchise_id,outlet_id:i.id};try{t=await M(`https://db.getorders.app/products.sl.${o.franchise_id}.${i.id}.json`),"[object Array]"!=Object.prototype.toString.call(t)&&(t=void 0),console.log(t)}catch{console.log("S3 not found")}}return t||(t=await M(q("/guest/products"),e,"GET")),v(p,l=t),n(1,r=!1),l}E(async()=>{let t=await M(q("/accounts"));n(2,o=t[0]),n(3,i=o.outlets.length>0?o.outlets[0]:{id:"",name:"Default"})}),f.subscribe(t=>{t.inventory&&(n(1,r=!0),Promise.all([b()]).then(t=>{n(1,r=!1)}),v(f,s={}))});return t.$$.update=()=>{8&t.$$.dirty&&i&&(v(p,l=[]),n(0,c=[]),n(1,r=!0),Promise.all([h(),b()]).then(t=>{n(1,r=!1)})),1025&t.$$.dirty&&l.length>0&&c&&c.length>0&&(n(0,c=c.map(t=>function(t){let e=l.find(e=>""+e.id==t.product_id)||{name:"-",variants:[]};if(e.variant="All",t.variant_id){let n=e.variants.find(e=>""+e.id==t.variant_id);n&&(e.variant=n.name)}return{...e,...t}}(t))),console.log(c))},[c,r,o,i,u,[{name:"Create",icon:"add",function:"add"}],function(t){if("add"==t.detail.function&&!r){let t={totals:[],quantity:0,track:!1,enforce:!0,outlet_id:i.id};v(m,a=[...a,{outlet:i,defaults:{...t},view:nt}])}},t=>n(3,i=o.outlets.find(e=>""+e.id==t.target.value)),function(t,e){t[e].quantity=this.value,n(0,c),n(3,i),n(10,l)},function(t,e){t[e].track=this.checked,n(0,c),n(3,i),n(10,l)}]}export default class extends t{constructor(t){var a;super(),document.getElementById("svelte-90ubxu-style")||((a=l("style")).id="svelte-90ubxu-style",a.textContent="table.svelte-90ubxu{width:100%}td.svelte-90ubxu{padding-left:0.5rem;padding-right:0.5rem}",s(document.head,a)),e(this,t,vt,pt,n,{})}}
//# sourceMappingURL=Inventory-dd39b19a.js.map
