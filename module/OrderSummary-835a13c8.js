import{S as e,i as t,s,ag as n,e as a,d as o,x as r,c as l,t as c,a as d,b as i,g as p,h as f,y as m,j as g,m as u,w as h,l as b,k as y,o as v,p as $,q as x,R as j,z as k,D as w,E as M,W as O,F as D,a1 as T}from"./App-e1d5e24f.js";import{T as A}from"./UIToolbar-26db1b96.js";import"./UIItem-00f92045.js";import{d as _}from"./dayjs.min-d290c2ff.js";const{document:q}=n;function E(e,t,s){const n=e.slice();return n[24]=t[s],n}function I(e,t,s){const n=e.slice();return n[21]=t[s],n}function N(e,t,s){const n=e.slice();return n[18]=t[s],n}function Y(e){let t,s,n,r,m,g,u,h,b,y,v,$,x,j,k,w,M=e[4](e[18]).name+"",O=e[21]+"",D=e[24]+"",T=e[1][e[18]][e[21]][e[24]].quantity+"",A=e[1][e[18]][e[21]][e[24]].quantity+"";return{c(){t=a("tr"),s=a("td"),n=c(M),r=d(),m=a("td"),g=c(O),u=d(),h=a("td"),b=c(D),y=d(),v=a("td"),$=c(T),x=d(),j=a("td"),k=c(A),w=d(),i(s,"class","svelte-41lobs"),i(m,"class","svelte-41lobs"),i(h,"class","svelte-41lobs"),i(v,"class","svelte-41lobs"),i(j,"class","svelte-41lobs")},m(e,a){l(e,t,a),o(t,s),o(s,n),o(t,r),o(t,m),o(m,g),o(t,u),o(t,h),o(h,b),o(t,y),o(t,v),o(v,$),o(t,x),o(t,j),o(j,k),o(t,w)},p(e,t){2&t&&M!==(M=e[4](e[18]).name+"")&&p(n,M),2&t&&O!==(O=e[21]+"")&&p(g,O),2&t&&D!==(D=e[24]+"")&&p(b,D),2&t&&T!==(T=e[1][e[18]][e[21]][e[24]].quantity+"")&&p($,T),2&t&&A!==(A=e[1][e[18]][e[21]][e[24]].quantity+"")&&p(k,A)},d(e){e&&f(t)}}}function H(e){let t,s=Object.keys(e[1][e[18]][e[21]]),n=[];for(let t=0;t<s.length;t+=1)n[t]=Y(E(e,s,t));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=r()},m(e,s){for(let t=0;t<n.length;t+=1)n[t].m(e,s);l(e,t,s)},p(e,a){if(18&a){let o;for(s=Object.keys(e[1][e[18]][e[21]]),o=0;o<s.length;o+=1){const r=E(e,s,o);n[o]?n[o].p(r,a):(n[o]=Y(r),n[o].c(),n[o].m(t.parentNode,t))}for(;o<n.length;o+=1)n[o].d(1);n.length=s.length}},d(e){m(n,e),e&&f(t)}}}function P(e){let t,s=Object.keys(e[1][e[18]]),n=[];for(let t=0;t<s.length;t+=1)n[t]=H(I(e,s,t));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=r()},m(e,s){for(let t=0;t<n.length;t+=1)n[t].m(e,s);l(e,t,s)},p(e,a){if(18&a){let o;for(s=Object.keys(e[1][e[18]]),o=0;o<s.length;o+=1){const r=I(e,s,o);n[o]?n[o].p(r,a):(n[o]=H(r),n[o].c(),n[o].m(t.parentNode,t))}for(;o<n.length;o+=1)n[o].d(1);n.length=s.length}},d(e){m(n,e),e&&f(t)}}}function S(e){let t,s,n,r,x,j,k,w,M,O,D,T,_,E,I,Y,H,S,U=e[0].format("ddd D/M/YY")+"";const L=new A({props:{class:"border-b border-gray-300",tools:e[2]}});L.$on("selected",e[3]);let R=Object.keys(e[1]),W=[];for(let t=0;t<R.length;t+=1)W[t]=P(N(e,R,t));return{c(){t=a("script"),n=d(),g(L.$$.fragment),r=d(),x=a("div"),j=a("button"),j.innerHTML='<i class="far fa-arrow-alt-circle-left"></i>',k=d(),w=a("div"),M=c(U),O=d(),D=a("button"),D.innerHTML='<i class="far fa-arrow-alt-circle-right"></i>',T=d(),_=a("div"),E=a("table"),I=a("tr"),I.innerHTML='<td class="svelte-41lobs">Product</td> \n            <td class="svelte-41lobs">Variant</td> \n            <td class="svelte-41lobs">Modifiers</td> \n            <td class="svelte-41lobs">Quantity</td> \n            <td class="svelte-41lobs">Total Price</td>',Y=d();for(let e=0;e<W.length;e+=1)W[e].c();t.src!==(s="https://unpkg.com/papaparse@latest/papaparse.min.js")&&i(t,"src","https://unpkg.com/papaparse@latest/papaparse.min.js"),i(w,"class","flex-grow self-center text-center"),i(x,"class","flex text-lg font-semibold m-2"),i(I,"class","bg-theme text-white rounded-lg"),i(E,"class","w-full"),i(_,"class","m-2")},m(s,a,c){o(q.head,t),l(s,n,a),u(L,s,a),l(s,r,a),l(s,x,a),o(x,j),o(x,k),o(x,w),o(w,M),o(x,O),o(x,D),l(s,T,a),l(s,_,a),o(_,E),o(E,I),o(E,Y);for(let e=0;e<W.length;e+=1)W[e].m(E,null);H=!0,c&&h(S),S=[b(j,"click",e[16]),b(D,"click",e[17])]},p(e,[t]){if((!H||1&t)&&U!==(U=e[0].format("ddd D/M/YY")+"")&&p(M,U),18&t){let s;for(R=Object.keys(e[1]),s=0;s<R.length;s+=1){const n=N(e,R,s);W[s]?W[s].p(n,t):(W[s]=P(n),W[s].c(),W[s].m(E,null))}for(;s<W.length;s+=1)W[s].d(1);W.length=R.length}},i(e){H||(y(L.$$.fragment,e),H=!0)},o(e){v(L.$$.fragment,e),H=!1},d(e){f(t),e&&f(n),$(L,e),e&&f(r),e&&f(x),e&&f(T),e&&f(_),m(W,e),h(S)}}}function U(e,t,s){let n,a;x(e,j,e=>s(10,n=e)),x(e,k,e=>s(11,a=e));let o=_(),r=0,l=!0,c={},d=[],i=[];function p(e){0==e&&(l=!0),r=e,D(j,n=!0),w(M("/orders"),{groupBy:"products",from:o.startOf("day").toJSON(),to:o.endOf("day").toJSON()},"GET").then(e=>{D(j,n=!1),s(1,c=e.variants),d=e.products,console.log(c),console.log(d)})}p(0),w(M("/vendor")).then(e=>{i=e}),O.subscribe(e=>{e.order&&(s(1,c=c.map(t=>(t.invoice_id==e.order.invoice_id&&(t=e.order),t))),process_orders())});function f(e){s(0,o=o.add(e,"day")),p(0)}return[o,c,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],function(e){switch(e.detail.function){case"refresh":p(0);break;case"export":{let e=[];c.forEach(t=>{if(t.payment){let s={order_date:_(t.createdAt).format("MM/DD h:mmA"),name:t.guest.name,phone:t.guest.phone,address:`${t.guest.address||""} ${t.guest.address2||""}`,isPickUp:t.guest.address?"N":"Y",amount:t.payment.amount.toFixed(2),paid:t.payment.paidAt?_(t.payment.paidAt).format("MM/DD h:mmA"):"",invoice:`https://pay.getorders.app/?i=${t.invoice_id}`};e=[...e,s]}}),T(Papa.unparse(e),"orders.csv","text/csv;encoding:utf-8")}}},function(e){return d.find(t=>t.id.toString()==e)||{name:"-"}},f,r,l,d,i,n,a,{},p,function(e){let t=e.guest.phone;t.startsWith("01")&&(t="6"+t);let s=`https://api.whatsapp.com/send?phone=${t}&text=`,n="";e.payment&&(n=`Hey there! We *(${a.settings.name})* have received your order, tap here to pay now.`,n=`${n} ðŸ‘‰ðŸ» https://pay.getorders.app/?i=${e.invoice_id}\n\n`);let o=encodeURIComponent(n);document.location.href=`${s}${o}`},["bg-gray-400","bg-gray-400","bg-gray-400","bg-yellow-500","bg-red-400","bg-green-500","bg-pink-500","bg-theme"],()=>f(-1),()=>f(1)]}export default class extends e{constructor(e){var n;super(),q.getElementById("svelte-41lobs-style")||((n=a("style")).id="svelte-41lobs-style",n.textContent="td.svelte-41lobs{padding:0.5rem}",o(q.head,n)),t(this,e,U,S,s,{})}}
//# sourceMappingURL=OrderSummary-835a13c8.js.map
