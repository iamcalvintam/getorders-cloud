import{S as e,i as t,s,ak as l,e as n,d as a,G as r,H as o,t as c,a as d,x as i,b as f,c as u,g as p,h as m,y as g,j as b,m as h,w as y,l as v,v as $,k as x,o as j,p as O,q as k,R as w,z as E,D as F,E as T,F as q,aj as A,a0 as M}from"./App-106c0643.js";import{T as I}from"./UIToolbar-b15bf635.js";import"./UIItem-6d823834.js";import{S as P}from"./UISegmented-eaaf3c40.js";import{d as S}from"./dayjs.min-d290c2ff.js";const{document:U}=l;function H(e,t,s){const l=e.slice();return l[35]=t[s],l}function N(e,t,s){const l=e.slice();return l[32]=t[s],l}function D(e,t,s){const l=e.slice();return l[29]=t[s],l}function V(e,t,s){const l=e.slice();return l[26]=t[s],l}function Y(e){let t,s,l,r,o,i,g,b,h,y,v,$,x,j,O,k,w,E,F,T=e[8](e[29]).name+"",q=e[32]+"",A=e[35]+"",M=e[2][e[29]][e[32]][e[35]].quantity+"",I=e[2][e[29]][e[32]][e[35]].amount.toFixed(2)+"",P=(e[2][e[29]][e[32]][e[35]].quantity*e[2][e[29]][e[32]][e[35]].amount).toFixed(2)+"";return{c(){t=n("tr"),s=n("td"),l=c(T),r=d(),o=n("td"),i=c(q),g=d(),b=n("td"),h=c(A),y=d(),v=n("td"),$=c(M),x=d(),j=n("td"),O=c(I),k=d(),w=n("td"),E=c(P),F=d(),f(s,"class","svelte-41lobs"),f(o,"class","svelte-41lobs"),f(b,"class","svelte-41lobs"),f(v,"class","svelte-41lobs"),f(j,"class","svelte-41lobs"),f(w,"class","svelte-41lobs")},m(e,n){u(e,t,n),a(t,s),a(s,l),a(t,r),a(t,o),a(o,i),a(t,g),a(t,b),a(b,h),a(t,y),a(t,v),a(v,$),a(t,x),a(t,j),a(j,O),a(t,k),a(t,w),a(w,E),a(t,F)},p(e,t){8&t[0]&&T!==(T=e[8](e[29]).name+"")&&p(l,T),12&t[0]&&q!==(q=e[32]+"")&&p(i,q),12&t[0]&&A!==(A=e[35]+"")&&p(h,A),12&t[0]&&M!==(M=e[2][e[29]][e[32]][e[35]].quantity+"")&&p($,M),12&t[0]&&I!==(I=e[2][e[29]][e[32]][e[35]].amount.toFixed(2)+"")&&p(O,I),12&t[0]&&P!==(P=(e[2][e[29]][e[32]][e[35]].quantity*e[2][e[29]][e[32]][e[35]].amount).toFixed(2)+"")&&p(E,P)},d(e){e&&m(t)}}}function B(e){let t,s=Object.keys(e[2][e[29]][e[32]]),l=[];for(let t=0;t<s.length;t+=1)l[t]=Y(H(e,s,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=i()},m(e,s){for(let t=0;t<l.length;t+=1)l[t].m(e,s);u(e,t,s)},p(e,n){if(780&n[0]){let a;for(s=Object.keys(e[2][e[29]][e[32]]),a=0;a<s.length;a+=1){const r=H(e,s,a);l[a]?l[a].p(r,n):(l[a]=Y(r),l[a].c(),l[a].m(t.parentNode,t))}for(;a<l.length;a+=1)l[a].d(1);l.length=s.length}},d(e){g(l,e),e&&m(t)}}}function L(e){let t,s=Object.keys(e[2][e[29]]),l=[];for(let t=0;t<s.length;t+=1)l[t]=B(N(e,s,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=i()},m(e,s){for(let t=0;t<l.length;t+=1)l[t].m(e,s);u(e,t,s)},p(e,n){if(780&n[0]){let a;for(s=Object.keys(e[2][e[29]]),a=0;a<s.length;a+=1){const r=N(e,s,a);l[a]?l[a].p(r,n):(l[a]=B(r),l[a].c(),l[a].m(t.parentNode,t))}for(;a<l.length;a+=1)l[a].d(1);l.length=s.length}},d(e){g(l,e),e&&m(t)}}}function R(e){let t,s,l,r,o,b,h,y,v,$,x=e[26]+"",j=e[9](e[26]),O=[];for(let t=0;t<j.length;t+=1)O[t]=L(D(e,j,t));return{c(){t=n("tr"),s=n("td"),l=c(x),r=n("td"),o=n("td"),b=n("td"),h=n("td"),y=n("td"),v=d();for(let e=0;e<O.length;e+=1)O[e].c();$=i(),f(s,"class","svelte-41lobs"),f(r,"class","svelte-41lobs"),f(o,"class","svelte-41lobs"),f(b,"class","svelte-41lobs"),f(h,"class","svelte-41lobs"),f(y,"class","svelte-41lobs"),f(t,"class","bg-gray-600 text-white")},m(e,n){u(e,t,n),a(t,s),a(s,l),a(t,r),a(t,o),a(t,b),a(t,h),a(t,y),u(e,v,n);for(let t=0;t<O.length;t+=1)O[t].m(e,n);u(e,$,n)},p(e,t){if(8&t[0]&&x!==(x=e[26]+"")&&p(l,x),780&t[0]){let s;for(j=e[9](e[26]),s=0;s<j.length;s+=1){const l=D(e,j,s);O[s]?O[s].p(l,t):(O[s]=L(l),O[s].c(),O[s].m($.parentNode,$))}for(;s<O.length;s+=1)O[s].d(1);O.length=j.length}},d(e){e&&m(t),e&&m(v),g(O,e),e&&m($)}}}function C(e){let t,s,l,i,k,w,E,F,T,q,A,M,S,H,N,D,Y,B,L,C,G,J,Q,W=e[0].format("ddd D/M/YY")+"";const _=new I({props:{class:"border-b border-gray-300",tools:e[6]}});function z(t){e[22].call(null,t)}_.$on("selected",e[7]);let K={style:e[11],label:"Orders Filter",segments:[{name:"Paid",value:"paid"},{name:"All",value:"all"}]};void 0!==e[4].type&&(K.value=e[4].type);const X=new P({props:K});function Z(t){e[23].call(null,t)}r.push(()=>o(X,"value",z));let ee={style:e[11],label:"Display",segments:[{name:"All",value:""},{name:"By Vendor",value:"true"}]};void 0!==e[1]&&(ee.value=e[1]);const te=new P({props:ee});r.push(()=>o(te,"value",Z));let se=Object.keys(e[3]),le=[];for(let t=0;t<se.length;t+=1)le[t]=R(V(e,se,t));return{c(){t=n("script"),l=d(),b(_.$$.fragment),i=d(),k=n("div"),b(X.$$.fragment),E=d(),b(te.$$.fragment),T=d(),q=n("div"),A=n("button"),A.innerHTML='<i class="far fa-arrow-alt-circle-left"></i>',M=d(),S=n("div"),H=c(W),N=d(),D=n("button"),D.innerHTML='<i class="far fa-arrow-alt-circle-right"></i>',Y=d(),B=n("div"),L=n("table"),C=n("tr"),C.innerHTML='<td class="svelte-41lobs">Product</td> \n            <td class="svelte-41lobs">Variant</td> \n            <td class="svelte-41lobs">Modifiers</td> \n            <td class="svelte-41lobs">Quantity</td> \n            <td class="svelte-41lobs">Unit Price</td> \n            <td class="svelte-41lobs"><b>Total</b></td>',G=d();for(let e=0;e<le.length;e+=1)le[e].c();t.src!==(s="https://unpkg.com/papaparse@latest/papaparse.min.js")&&f(t,"src","https://unpkg.com/papaparse@latest/papaparse.min.js"),f(k,"class","border-t border-b border-gray-200 flex"),f(S,"class","flex-grow self-center text-center"),f(q,"class","flex text-lg font-semibold m-2"),f(C,"class","bg-theme text-white rounded-lg"),f(L,"class","w-full"),f(B,"class","m-2")},m(s,n,r){a(U.head,t),u(s,l,n),h(_,s,n),u(s,i,n),u(s,k,n),h(X,k,null),a(k,E),h(te,k,null),u(s,T,n),u(s,q,n),a(q,A),a(q,M),a(q,S),a(S,H),a(q,N),a(q,D),u(s,Y,n),u(s,B,n),a(B,L),a(L,C),a(L,G);for(let e=0;e<le.length;e+=1)le[e].m(L,null);J=!0,r&&y(Q),Q=[v(A,"click",e[24]),v(D,"click",e[25])]},p(e,t){const s={};!w&&16&t[0]&&(w=!0,s.value=e[4].type,$(()=>w=!1)),X.$set(s);const l={};if(!F&&2&t[0]&&(F=!0,l.value=e[1],$(()=>F=!1)),te.$set(l),(!J||1&t[0])&&W!==(W=e[0].format("ddd D/M/YY")+"")&&p(H,W),780&t[0]){let s;for(se=Object.keys(e[3]),s=0;s<se.length;s+=1){const l=V(e,se,s);le[s]?le[s].p(l,t):(le[s]=R(l),le[s].c(),le[s].m(L,null))}for(;s<le.length;s+=1)le[s].d(1);le.length=se.length}},i(e){J||(x(_.$$.fragment,e),x(X.$$.fragment,e),x(te.$$.fragment,e),J=!0)},o(e){j(_.$$.fragment,e),j(X.$$.fragment,e),j(te.$$.fragment,e),J=!1},d(e){m(t),e&&m(l),O(_,e),e&&m(i),e&&m(k),O(X),O(te),e&&m(T),e&&m(q),e&&m(Y),e&&m(B),g(le,e),y(Q)}}}function G(e,t,s){let l,n,a;k(e,w,e=>s(16,l=e)),k(e,E,e=>s(17,a=e));let r=S(),o=A({type:"paid"}),c="";k(e,o,e=>s(4,n=e));let d=0,i=!0,f={},u=[],p=[],m={"All Orders":[]};function g(e){0==e&&(i=!0),d=e,q(w,l=!0),F(T("/orders"),{groupBy:"products",order_type:n.type,from:r.startOf("day").toJSON(),to:r.endOf("day").toJSON()},"GET").then(e=>{q(w,l=!1),s(2,f=e.variants),u=e.products,s(3,m),s(1,c),s(15,p)})}function b(e){return u.find(t=>t.id.toString()==e)||{name:"-"}}function h(e){return"All Orders"==e?Object.keys(f):Object.keys(f).filter(t=>m[e].includes(t))}g(0),F(T("/vendor")).then(e=>{s(15,p=e)}),o.subscribe(e=>{g(0)});function y(e){s(0,r=r.add(e,"day")),g(0)}return e.$$.update=()=>{if(32770&e.$$.dirty[0])if("true"==c){let e={};p.forEach(t=>{e[t.name]=t.products.map(e=>e.id)}),s(3,m=e)}else s(3,m={"All Orders":[]})},[r,c,f,m,n,o,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],function(e){switch(e.detail.function){case"refresh":g(0);break;case"export":{let e=[];Object.keys(m).forEach(t=>{h(t).forEach(s=>{Object.keys(f[s]).forEach(l=>{Object.keys(f[s][l]).forEach(n=>{let a=f[s][l][n],r={Product:b(s).name,Variant:l,Modifiers:n,Quantity:a.quantity,"Unit Price":a.amount.toFixed(2),Total:(a.quantity*a.amount).toFixed(2)};"All Orders"!=t&&(r.Vendor=t),e=[...e,r]})})})}),M(Papa.unparse(e),"orders.csv","text/csv;encoding:utf-8")}}},b,h,y,{container:"p-2 flex-none",label:"w-32"},d,i,u,p,l,a,{},g,function(e){let t=e.guest.phone;t.startsWith("01")&&(t="6"+t);let s=`https://api.whatsapp.com/send?phone=${t}&text=`,l="";e.payment&&(l=`Hey there! We *(${a.settings.name})* have received your order, tap here to pay now.`,l=`${l} 👉🏻 https://pay.getorders.app/?i=${e.invoice_id}\n\n`);let n=encodeURIComponent(l);document.location.href=`${s}${n}`},["bg-gray-400","bg-gray-400","bg-gray-400","bg-yellow-500","bg-red-400","bg-green-500","bg-pink-500","bg-theme"],function(e){n.type=e,o.set(n)},function(e){c=e,s(1,c)},()=>y(-1),()=>y(1)]}export default class extends e{constructor(e){var l;super(),U.getElementById("svelte-41lobs-style")||((l=n("style")).id="svelte-41lobs-style",l.textContent="td.svelte-41lobs{padding:0.5rem}",a(U.head,l)),t(this,e,G,C,s,{},[-1,-1])}}
//# sourceMappingURL=OrderSummary-ab80f4ed.js.map
