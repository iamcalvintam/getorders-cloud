import{S as e,i as t,s,e as l,d as a,x as n,b as r,c as o,l as c,h as d,t as f,g as i,y as u,a as m,j as g,m as p,k as h,o as x,p as v,w as b,q as _,X as y,R as z,C as w,D as j,E as T,a4 as k}from"./Web-0e753209.js";import{T as D}from"./UIToolbar-40511b9d.js";import"./UIItem-0dd40481.js";import"./UISegmented-de73549e.js";import{d as Y}from"./dayjs.min-056200c8.js";import"./OrdersExport-5a7c6a73.js";function M(e,t,s){const l=e.slice();return l[12]=t[s],l}function $(e,t,s){const l=e.slice();return l[3]=t[s],l[16]=s,l}function E(e){let t,s,f,i,m=0==e[2].outlets.length&&O(),g=e[2].outlets,p=[];for(let t=0;t<g.length;t+=1)p[t]=A($(e,g,t));return{c(){t=l("select"),m&&m.c(),s=n();for(let e=0;e<p.length;e+=1)p[e].c();r(t,"class","text-xl my-2 w-48")},m(l,n){o(l,t,n),m&&m.m(t,null),a(t,s);for(let e=0;e<p.length;e+=1)p[e].m(t,null);f||(i=c(t,"change",e[8]),f=!0)},p(e,l){if(0==e[2].outlets.length?m||(m=O(),m.c(),m.m(t,s)):m&&(m.d(1),m=null),4&l){let s;for(g=e[2].outlets,s=0;s<g.length;s+=1){const a=$(e,g,s);p[s]?p[s].p(a,l):(p[s]=A(a),p[s].c(),p[s].m(t,null))}for(;s<p.length;s+=1)p[s].d(1);p.length=g.length}},d(e){e&&d(t),m&&m.d(),u(p,e),f=!1,i()}}}function O(e){let t;return{c(){t=l("option"),t.textContent="Default",t.__value="0",t.value=t.__value},m(e,s){o(e,t,s)},d(e){e&&d(t)}}}function A(e){let t,s,n,r=e[3].name+"";return{c(){t=l("option"),s=f(r),t.__value=n=""+e[3].id,t.value=t.__value},m(e,l){o(e,t,l),a(t,s)},p(e,l){4&l&&r!==(r=e[3].name+"")&&i(s,r),4&l&&n!==(n=""+e[3].id)&&(t.__value=n,t.value=t.__value)},d(e){e&&d(t)}}}function H(e){let t,s=e[1],l=[];for(let t=0;t<s.length;t+=1)l[t]=I(M(e,s,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=n()},m(e,s){for(let t=0;t<l.length;t+=1)l[t].m(e,s);o(e,t,s)},p(e,a){if(2&a){let n;for(s=e[1],n=0;n<s.length;n+=1){const r=M(e,s,n);l[n]?l[n].p(r,a):(l[n]=I(r),l[n].c(),l[n].m(t.parentNode,t))}for(;n<l.length;n+=1)l[n].d(1);l.length=s.length}},d(e){u(l,e),e&&d(t)}}}function I(e){let t,s,n,c,u,g,p,h,x,v,b,_,y,z=Y(e[12].sentAt).format("h:mmA")+"",w=e[12].table_id+"",j=e[12].guest.name+"",T=e[12].guest.phone+"";return{c(){t=l("tr"),s=l("td"),n=f(z),c=m(),u=l("td"),g=f(w),p=m(),h=l("td"),x=f(j),v=m(),b=l("td"),_=f(T),y=m(),r(s,"class","svelte-xffzrg"),r(u,"class","svelte-xffzrg"),r(h,"class","svelte-xffzrg"),r(b,"class","svelte-xffzrg"),r(t,"class","hover:bg-gray-200")},m(e,l){o(e,t,l),a(t,s),a(s,n),a(t,c),a(t,u),a(u,g),a(t,p),a(t,h),a(h,x),a(t,v),a(t,b),a(b,_),a(t,y)},p(e,t){2&t&&z!==(z=Y(e[12].sentAt).format("h:mmA")+"")&&i(n,z),2&t&&w!==(w=e[12].table_id+"")&&i(g,w),2&t&&j!==(j=e[12].guest.name+"")&&i(x,j),2&t&&T!==(T=e[12].guest.phone+"")&&i(_,T)},d(e){e&&d(t)}}}function N(e){let t,s,n,u,_,y,z,w,j,T,k,Y,M,$,O,A,I,N,C,S,L,P,U,J,R,q=e[0].format("ddd D/M/YY")+"";u=new D({props:{class:"border-b border-gray-300",tools:e[4]}}),u.$on("selected",e[7]);let B=e[2]&&E(e),G=e[1]&&H(e);return{c(){t=l("script"),n=m(),g(u.$$.fragment),_=m(),y=l("div"),z=l("div"),w=l("label"),w.textContent="Outlet",j=m(),B&&B.c(),T=m(),k=l("div"),Y=l("button"),Y.innerHTML='<i class="far fa-arrow-alt-circle-left"></i>',M=m(),$=l("div"),O=f(q),A=m(),I=l("button"),I.innerHTML='<i class="far fa-arrow-alt-circle-right"></i>',N=m(),C=l("div"),S=l("table"),L=l("tr"),L.innerHTML='<td class="svelte-xffzrg">Date/Time</td> \n            <td class="svelte-xffzrg">Table</td> \n            <td class="svelte-xffzrg">Name</td> \n            <td class="svelte-xffzrg">Phone</td>',P=m(),G&&G.c(),t.src!==(s="https://unpkg.com/papaparse@latest/papaparse.min.js")&&r(t,"src","https://unpkg.com/papaparse@latest/papaparse.min.js"),r(w,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),r(z,"class","p-2 flex-none"),r(y,"class","border-t border-b border-gray-200 flex"),r($,"class","flex-grow self-center text-center"),r(k,"class","flex text-lg font-semibold m-2"),r(L,"class","bg-theme text-white rounded-lg"),r(S,"class","w-full svelte-xffzrg"),r(C,"class","m-2")},m(s,l){a(document.head,t),o(s,n,l),p(u,s,l),o(s,_,l),o(s,y,l),a(y,z),a(z,w),a(z,j),B&&B.m(z,null),o(s,T,l),o(s,k,l),a(k,Y),a(k,M),a(k,$),a($,O),a(k,A),a(k,I),o(s,N,l),o(s,C,l),a(C,S),a(S,L),a(S,P),G&&G.m(S,null),U=!0,J||(R=[c(Y,"click",e[9]),c(I,"click",e[10])],J=!0)},p(e,[t]){e[2]?B?B.p(e,t):(B=E(e),B.c(),B.m(z,null)):B&&(B.d(1),B=null),(!U||1&t)&&q!==(q=e[0].format("ddd D/M/YY")+"")&&i(O,q),e[1]?G?G.p(e,t):(G=H(e),G.c(),G.m(S,null)):G&&(G.d(1),G=null)},i(e){U||(h(u.$$.fragment,e),U=!0)},o(e){x(u.$$.fragment,e),U=!1},d(e){d(t),e&&d(n),v(u,e),e&&d(_),e&&d(y),B&&B.d(),e&&d(T),e&&d(k),e&&d(N),e&&d(C),G&&G.d(),J=!1,b(R)}}}function C(e,t,s){let l;_(e,y,e=>s(11,l=e));let a,n,r=Y(),o=[];function c(e){s(0,r=r.add(e,"day")),d()}function d(){w(y,l=!0);let e={dine_in:"true",from:r.startOf("day").toJSON(),to:r.endOf("day").toJSON()};a.franchise_id&&(e={...e,fran_id:a.franchise_id,outlet_id:n.id}),j(T("/orders"),e,"GET").then(e=>{w(y,l=!1),s(1,o=e.orders)})}z(async()=>{let e=await j(T("/accounts"));s(2,a=e[0]),s(3,n=a.outlets.length>0?a.outlets[0]:{id:"",name:"Default"}),d()});return[r,o,a,n,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],c,d,function(e){switch(e.detail.function){case"refresh":d();break;case"export":{let e=[];o.forEach(t=>{e=[...e,{"Date/Time":Y(t.sentAt).format("YYYY-MM-DD HH:mm"),Table:t.table_id,Name:t.guest.name,Phone:t.guest.phone}]}),k(Papa.unparse(e),"guestbook.csv","text/csv;encoding:utf-8")}}},e=>{s(3,n=a.outlets.find(t=>""+t.id==e.target.value)),d()},()=>c(-1),()=>c(1)]}export default class extends e{constructor(e){var n;super(),document.getElementById("svelte-xffzrg-style")||((n=l("style")).id="svelte-xffzrg-style",n.textContent="table.svelte-xffzrg td.svelte-xffzrg{padding:0.5rem}",a(document.head,n)),t(this,e,C,N,s,{})}}
//# sourceMappingURL=Guestbook-755b9ff3.js.map
