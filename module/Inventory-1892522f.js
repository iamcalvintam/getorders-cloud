import{S as t,i as e,s as n,e as l,d as s,M as c,j as o,m as a,k as d,o as r,p as i,q as u,U as f,C as m,al as p,F as v,b as h,c as g,r as y,u as x,h as $,t as b,g as k,a as _,f as j,w,l as A,y as z,n as D,Q as I,D as P,E as T,L as M,x as q,T as C}from"./App-2e32add0.js";import"./UITextField-8dfd3980.js";import{T as S}from"./UIToolbar-7f337ee9.js";import"./UIItem-fb799fc8.js";import"./UISegmented-f033910a.js";import{d as Y}from"./dayjs.min-d290c2ff.js";import{P as O}from"./ProductSelectionView-be70e16e.js";function E(t,e,n){const l=t.slice();return l[24]=e[n],l}function L(t,e,n){const l=t.slice();return l[21]=e[n],l[22]=e,l[23]=n,l}function U(t){let e;const n=new M({props:{$$slots:{message:[H]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,l){a(n,t,l),e=!0},i(t){e||(d(n.$$.fragment,t),e=!0)},o(t){r(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function H(t){let e;return{c(){e=l("div"),e.textContent="One Moment Please..",h(e,"slot","message")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function Q(t){let e,n,s=t[2]&&U(t);return{c(){e=l("div"),s&&s.c(),h(e,"slot","loader")},m(t,l){g(t,e,l),s&&s.m(e,null),n=!0},p(t,n){t[2]?s?d(s,1):(s=U(t),s.c(),d(s,1),s.m(e,null)):s&&(y(),r(s,1,1,()=>{s=null}),x())},i(t){n||(d(s),n=!0)},o(t){r(s),n=!1},d(t){t&&$(e),s&&s.d()}}}function B(t){let e,n,c,o,a=t[1].name+"";return{c(){e=l("div"),n=l("b"),c=b(a),o=b(" Outlet Inventory"),h(e,"slot","title"),h(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,l){g(t,e,l),s(e,n),s(n,c),s(e,o)},p(t,e){2&e&&a!==(a=t[1].name+"")&&k(c,a)},d(t){t&&$(e)}}}function F(t){let e,n,c,o,a,d,r=t[24].name+"";function i(){t[18].call(n,t[21],t[24])}return{c(){e=l("label"),n=l("input"),c=_(),o=b(r),a=_(),h(n,"type","checkbox"),h(e,"class","px-2 text-sm")},m(l,r,u){g(l,e,r),s(e,n),n.checked=t[21].soldAt[t[24].id],s(e,c),s(e,o),s(e,a),u&&d(),d=A(n,"change",i)},p(e,l){t=e,1&l&&(n.checked=t[21].soldAt[t[24].id])},d(t){t&&$(e),d()}}}function G(t){let e,n,c,o,a,d,r,i,u,f,m,p,v,y,x,D,I=t[21].name+"";function P(){t[17].call(d,t[21])}let T=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],M=[];for(let e=0;e<3;e+=1)M[e]=F(E(t,T,e));function q(){t[19].call(m,t[21])}function C(...e){return t[20](t[21],...e)}return{c(){e=l("tr"),n=l("td"),c=b(I),o=_(),a=l("td"),d=l("input"),r=_(),i=l("td");for(let t=0;t<3;t+=1)M[t].c();u=_(),f=l("td"),m=l("input"),p=_(),v=l("td"),y=l("button"),y.innerHTML='<i class="icon ion-md-close w-8 h-8 text-center"></i>',x=_(),h(n,"class","text-gray-800 text-left svelte-61u4ux"),h(d,"class","border border-gray-300 p-1 w-full"),h(d,"type","text"),h(d,"placeholder","10"),h(a,"class","svelte-61u4ux"),h(i,"class","svelte-61u4ux"),h(m,"type","checkbox"),h(f,"class","svelte-61u4ux"),h(v,"class","svelte-61u4ux"),h(e,"class","text-center")},m(l,h,$){g(l,e,h),s(e,n),s(n,c),s(e,o),s(e,a),s(a,d),j(d,t[21].quantity),s(e,r),s(e,i);for(let t=0;t<3;t+=1)M[t].m(i,null);s(e,u),s(e,f),s(f,m),m.checked=t[21].track,s(e,p),s(e,v),s(v,y),s(e,x),$&&w(D),D=[A(d,"input",P),A(m,"change",q),A(y,"click",C)]},p(e,n){if(t=e,1&n&&I!==(I=t[21].name+"")&&k(c,I),1&n&&d.value!==t[21].quantity&&j(d,t[21].quantity),1&n){let e;for(T=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],e=0;e<3;e+=1){const l=E(t,T,e);M[e]?M[e].p(l,n):(M[e]=F(l),M[e].c(),M[e].m(i,null))}for(;e<3;e+=1)M[e].d(1)}1&n&&(m.checked=t[21].track)},d(t){t&&$(e),z(M,t),w(D)}}}function V(t){let e,n,c,o,a,d,r,i=t[0],u=[];for(let e=0;e<i.length;e+=1)u[e]=G(L(t,i,e));return{c(){e=l("div"),n=l("div"),n.innerHTML='<p class="text-gray-600"><i class="pr-3 self-center fas fa-plus"></i>\n            Add Products\n        </p>',c=_(),o=l("table"),a=l("tr"),a.innerHTML='<td class="svelte-61u4ux">Product</td> \n            <td class="w-6 svelte-61u4ux">Quantity</td> \n            <td class="svelte-61u4ux">Stores</td> \n            <td class="svelte-61u4ux">Track</td> \n            <td class="svelte-61u4ux"></td>',d=_();for(let t=0;t<u.length;t+=1)u[t].c();h(n,"class","rounded-lg p-2 border border-dashed cursor-pointer"),h(a,"class","font-semibold text-theme text-sm text-center"),h(o,"class","my-2 svelte-61u4ux"),h(e,"slot","content"),h(e,"class","p-2")},m(l,i,f){g(l,e,i),s(e,n),s(e,c),s(e,o),s(o,a),s(o,d);for(let t=0;t<u.length;t+=1)u[t].m(o,null);f&&r(),r=A(n,"click",t[6])},p(t,e){if(129&e){let n;for(i=t[0],n=0;n<i.length;n+=1){const l=L(t,i,n);u[n]?u[n].p(l,e):(u[n]=G(l),u[n].c(),u[n].m(o,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=i.length}},d(t){t&&$(e),z(u,t),r()}}}function N(t){let e,n;const s=new S({props:{tools:t[4],style:t[3]}});return s.$on("selected",t[5]),{c(){e=l("div"),o(s.$$.fragment),h(e,"slot","toolbar")},m(t,l){g(t,e,l),a(s,e,null),n=!0},p:D,i(t){n||(d(s.$$.fragment,t),n=!0)},o(t){r(s.$$.fragment,t),n=!1},d(t){t&&$(e),i(s)}}}function J(t){let e,n,l;return{c(){e=_(),n=_(),l=_()},m(t,s){g(t,e,s),g(t,n,s),g(t,l,s)},p:D,i:D,o:D,d(t){t&&$(e),t&&$(n),t&&$(l)}}}function K(t){let e;const n=new c({props:{style:{body:"screen-height",content:"overflow-y-scroll scrolling-touch"},$$slots:{default:[J],toolbar:[N],content:[V],title:[B],loader:[Q]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,l){a(n,t,l),e=!0},p(t,[e]){const l={};134217735&e&&(l.$$scope={dirty:e,ctx:t}),n.$set(l)},i(t){e||(d(n.$$.fragment,t),e=!0)},o(t){r(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function R(t,e,n){let l,s,c;u(t,f,t=>n(10,l=t)),u(t,m,t=>n(11,s=t)),u(t,p,t=>n(12,c=t));let o=!1,{defaults:a={}}=e,{account:d={}}=e,{outlet:r={}}=e,{inventories:i=[]}=e,h={container:`justify-end ${o?"opacity-25":""}`};function g(t){n(0,i=i.filter(e=>e.id!=t))}f.subscribe(t=>{t.selected_prods&&(n(0,i=[...t.selected_prods.map(t=>(t.outlet_id||((t={...a,...t}).product_id=t.id,t.soldAt={0:!0,1:!0,2:!0}),t))]),console.log(i),v(f,l={}))});return t.$set=t=>{"defaults"in t&&n(8,a=t.defaults),"account"in t&&n(9,d=t.account),"outlet"in t&&n(1,r=t.outlet),"inventories"in t&&n(0,i=t.inventories)},[i,r,o,h,[{name:"Close",icon:"close-circle",function:"pop_modal"},{name:"Save",icon:"checkmark-circle",function:"save"}],async function(t){"pop_modal"==t.detail.function&&I(),"save"==t.detail.function&&(n(2,o=!0),P(T("/inventory"),i.map(t=>{let e=[];return Object.keys(t.soldAt).map(n=>{1==t.soldAt[n]&&(e=[...e,parseInt(n)])}),{...t,soldAt:e}})).then(t=>{v(f,l={inventory:t}),I()}))},function(){v(m,s=[...s,{selected_prods:i,products:c,view:O}])},g,a,d,l,s,c,void 0,void 0,{body:"screen-height",content:"overflow-y-scroll scrolling-touch"},{container:"w-1/2 mx-2"},function(t){t.quantity=this.value,n(0,i)},function(t,e){t.soldAt[e.id]=this.checked,n(0,i)},function(t){t.track=this.checked,n(0,i)},t=>g(t.id)]}class W extends t{constructor(t){var c;super(),document.getElementById("svelte-61u4ux-style")||((c=l("style")).id="svelte-61u4ux-style",c.textContent="table.svelte-61u4ux{width:100%}td.svelte-61u4ux{padding-left:0.5rem;padding-right:0.5rem}",s(document.head,c)),e(this,t,R,K,n,{defaults:8,account:9,outlet:1,inventories:0})}}function X(t,e,n){const l=t.slice();return l[21]=e[n],l}function Z(t,e,n){const l=t.slice();return l[18]=e[n],l[19]=e,l[20]=n,l}function tt(t,e,n){const l=t.slice();return l[3]=e[n],l[25]=n,l}function et(t){let e,n,c,o=0==t[2].outlets.length&&nt(),a=t[2].outlets,d=[];for(let e=0;e<a.length;e+=1)d[e]=lt(tt(t,a,e));return{c(){e=l("select"),o&&o.c(),n=q();for(let t=0;t<d.length;t+=1)d[t].c();h(e,"class","text-xl my-2 w-48")},m(l,a,r){g(l,e,a),o&&o.m(e,null),s(e,n);for(let t=0;t<d.length;t+=1)d[t].m(e,null);r&&c(),c=A(e,"change",t[15])},p(t,l){if(0==t[2].outlets.length?o||(o=nt(),o.c(),o.m(e,n)):o&&(o.d(1),o=null),4&l){let n;for(a=t[2].outlets,n=0;n<a.length;n+=1){const s=tt(t,a,n);d[n]?d[n].p(s,l):(d[n]=lt(s),d[n].c(),d[n].m(e,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=a.length}},d(t){t&&$(e),o&&o.d(),z(d,t),c()}}}function nt(t){let e;return{c(){e=l("option"),e.textContent="Default",e.__value="0",e.value=e.__value},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function lt(t){let e,n,c,o=t[3].name+"";return{c(){e=l("option"),n=b(o),e.__value=c=""+t[3].id,e.value=e.__value},m(t,l){g(t,e,l),s(e,n)},p(t,l){4&l&&o!==(o=t[3].name+"")&&k(n,o),4&l&&c!==(c=""+t[3].id)&&(e.__value=c),e.value=e.__value},d(t){t&&$(e)}}}function st(t){let e,n,c,o=t[0],a=[];for(let e=0;e<o.length;e+=1)a[e]=at(Z(t,o,e));return{c(){e=l("table"),n=l("tr"),n.innerHTML='<td class="svelte-1jp14zd">Product</td> \n        <td class="w-6 svelte-1jp14zd">Quantity</td> \n        <td class="svelte-1jp14zd">Current Qty</td> \n        <td class="svelte-1jp14zd">Stores</td> \n        <td class="svelte-1jp14zd">Track</td> \n        <td class="svelte-1jp14zd">Date/Time</td>',c=_();for(let t=0;t<a.length;t+=1)a[t].c();h(n,"class","font-semibold text-theme text-sm text-center"),h(e,"class","my-2 svelte-1jp14zd")},m(t,l){g(t,e,l),s(e,n),s(e,c);for(let t=0;t<a.length;t+=1)a[t].m(e,null)},p(t,n){if(129&n){let l;for(o=t[0],l=0;l<o.length;l+=1){const s=Z(t,o,l);a[l]?a[l].p(s,n):(a[l]=at(s),a[l].c(),a[l].m(e,null))}for(;l<a.length;l+=1)a[l].d(1);a.length=o.length}},i:D,o:D,d(t){t&&$(e),z(a,t)}}}function ct(t){let e;const n=new M({props:{type:"h-64",$$slots:{message:[dt]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,l){a(n,t,l),e=!0},p(t,e){const l={};67108864&e&&(l.$$scope={dirty:e,ctx:t}),n.$set(l)},i(t){e||(d(n.$$.fragment,t),e=!0)},o(t){r(n.$$.fragment,t),e=!1},d(t){i(n,t)}}}function ot(t){let e,n,c,o,a,d,r=t[21].name+"";return{c(){e=l("label"),n=l("input"),o=_(),a=b(r),d=_(),h(n,"type","checkbox"),n.checked=c=t[18].soldAt.includes(t[21].id),n.disabled=!0,h(e,"class","px-2 text-sm")},m(t,l){g(t,e,l),s(e,n),s(e,o),s(e,a),s(e,d)},p(t,e){1&e&&c!==(c=t[18].soldAt.includes(t[21].id))&&(n.checked=c)},d(t){t&&$(e)}}}function at(t){let e,n,c,o,a,d,r,i,u,f,m,p,v,y,x,D,I,P,T,M=t[7](t[18]).name+"",q=t[18].total_left+"",C=Y(t[18].createdAt).format("DD/MM/YYYY h:mmA")+"";function S(){t[16].call(d,t[18])}let O=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],E=[];for(let e=0;e<3;e+=1)E[e]=ot(X(t,O,e));function L(){t[17].call(y,t[18])}return{c(){e=l("tr"),n=l("td"),c=b(M),o=_(),a=l("td"),d=l("input"),r=_(),i=l("td"),u=b(q),f=_(),m=l("td");for(let t=0;t<3;t+=1)E[t].c();p=_(),v=l("td"),y=l("input"),x=_(),D=l("td"),I=b(C),P=_(),h(n,"class","text-gray-800 text-left svelte-1jp14zd"),h(d,"class","border border-gray-300 p-1 w-full"),h(d,"type","text"),h(d,"placeholder","10"),d.disabled=!0,h(a,"class","svelte-1jp14zd"),h(i,"class","svelte-1jp14zd"),h(m,"class","svelte-1jp14zd"),h(y,"type","checkbox"),y.disabled=!0,h(v,"class","svelte-1jp14zd"),h(D,"class","text-sm text-gray-700 svelte-1jp14zd"),h(e,"class","text-center hover:bg-gray-200")},m(l,h,$){g(l,e,h),s(e,n),s(n,c),s(e,o),s(e,a),s(a,d),j(d,t[18].quantity),s(e,r),s(e,i),s(i,u),s(e,f),s(e,m);for(let t=0;t<3;t+=1)E[t].m(m,null);s(e,p),s(e,v),s(v,y),y.checked=t[18].track,s(e,x),s(e,D),s(D,I),s(e,P),$&&w(T),T=[A(d,"input",S),A(y,"change",L)]},p(e,n){if(t=e,1&n&&M!==(M=t[7](t[18]).name+"")&&k(c,M),1&n&&d.value!==t[18].quantity&&j(d,t[18].quantity),1&n&&q!==(q=t[18].total_left+"")&&k(u,q),1&n){let e;for(O=[{id:0,name:"Pickup"},{id:1,name:"Delivery"},{id:2,name:"Dine-In"}],e=0;e<3;e+=1){const l=X(t,O,e);E[e]?E[e].p(l,n):(E[e]=ot(l),E[e].c(),E[e].m(m,null))}for(;e<3;e+=1)E[e].d(1)}1&n&&(y.checked=t[18].track),1&n&&C!==(C=Y(t[18].createdAt).format("DD/MM/YYYY h:mmA")+"")&&k(I,C)},d(t){t&&$(e),z(E,t),w(T)}}}function dt(t){let e;return{c(){e=l("div"),e.textContent="One Moment Please..",h(e,"slot","message")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function rt(t){let e,n,c,u,f,m,p,v,b,k,j,w;const A=new S({props:{style:t[4],tools:t[5]}});A.$on("selected",t[6]);let z=t[2]&&et(t);const D=[ct,st],I=[];function P(t,e){return!t[0]||t[1]?0:1}return b=P(t),k=I[b]=D[b](t),{c(){e=l("div"),o(A.$$.fragment),c=_(),u=l("div"),f=l("div"),m=l("label"),m.textContent="Outlet",p=_(),z&&z.c(),v=_(),k.c(),j=q(),h(e,"class",n=t[1]?"opacity-25":""),h(m,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),h(f,"class","p-2 flex-none"),h(u,"class","border-t border-b border-gray-200 flex")},m(t,n){g(t,e,n),a(A,e,null),g(t,c,n),g(t,u,n),s(u,f),s(f,m),s(f,p),z&&z.m(f,null),g(t,v,n),I[b].m(t,n),g(t,j,n),w=!0},p(t,[l]){(!w||2&l&&n!==(n=t[1]?"opacity-25":""))&&h(e,"class",n),t[2]?z?z.p(t,l):(z=et(t),z.c(),z.m(f,null)):z&&(z.d(1),z=null);let s=b;b=P(t),b===s?I[b].p(t,l):(y(),r(I[s],1,1,()=>{I[s]=null}),x(),k=I[b],k||(k=I[b]=D[b](t),k.c()),d(k,1),k.m(j.parentNode,j))},i(t){w||(d(A.$$.fragment,t),d(k),w=!0)},o(t){r(A.$$.fragment,t),r(k),w=!1},d(t){t&&$(e),i(A),t&&$(c),t&&$(u),z&&z.d(),t&&$(v),I[b].d(t),t&&$(j)}}}function it(t,e,n){let l,s,c;u(t,p,t=>n(8,l=t)),u(t,f,t=>n(9,s=t)),u(t,m,t=>n(10,c=t));let o,a,d,r=!1,i={container:"border-b border-gray-300"};async function h(){let t={};a.franchise_id&&(t={fran_id:a.franchise_id,outlet_id:d.id}),n(0,o=await P(T("/inventory"),t,"GET"))}async function g(){n(1,r=!0);let t,e={fire_id:a.fire_id};if(a.franchise_id){e={fran_id:a.franchise_id,outlet_id:d.id};try{t=await P(`https://db.getorders.app/products.sl.${a.franchise_id}.${d.id}.json`),"[object Array]"!=Object.prototype.toString.call(t)&&(t=void 0),console.log(t)}catch{console.log("S3 not found")}}return t||(t=await P(T("/guest/products"),e,"GET")),v(p,l=t),n(1,r=!1),l}C(async()=>{let t=await P(T("/accounts"));n(2,a=t[0]),n(3,d=a.outlets.length>0?a.outlets[0]:{id:"",name:"Default"})}),f.subscribe(t=>{if(t.inventory){let e=t.inventory.map(t=>t.product_id);n(0,o=o.filter(t=>!e.includes(t.product_id))),n(0,o=[...t.inventory,...o]),v(f,s={})}});return t.$$.update=()=>{8&t.$$.dirty&&d&&(v(p,l=[]),n(1,r=!0),Promise.all([g(),h()]).then(t=>{n(1,r=!1)}))},[o,r,a,d,i,[{name:"Create",icon:"add",function:"add"}],function(t){if("add"==t.detail.function&&!r){let t={totals:[],quantity:0,track:!1,enforce:!0,outlet_id:d.id};v(m,c=[...c,{outlet:d,defaults:{...t},view:W}])}},function(t){return l.find(e=>""+e.id==t.product_id)||{name:"-"}},l,s,c,h,g,function(t){v(m,c=[...c,{product:t,view:ProductView}])},function(t){n(1,r=!0);let e=new Date;t.deletedAt=t.deletedAt?null:e,P(T("/products")).then(t=>{n(1,r=!1),v(f,s={product:t})})},t=>n(3,d=a.outlets.find(e=>""+e.id==t.target.value)),function(t){t.quantity=this.value,n(0,o)},function(t){t.track=this.checked,n(0,o)}]}export default class extends t{constructor(t){var c;super(),document.getElementById("svelte-1jp14zd-style")||((c=l("style")).id="svelte-1jp14zd-style",c.textContent="table.svelte-1jp14zd{width:100%}td.svelte-1jp14zd{padding-left:0.5rem;padding-right:0.5rem}",s(document.head,c)),e(this,t,it,rt,n,{})}}
//# sourceMappingURL=Inventory-1892522f.js.map
