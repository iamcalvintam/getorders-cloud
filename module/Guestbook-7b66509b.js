import{S as t,i as e,s,e as l,d as a,x as n,b as r,c as o,l as c,h as d,t as i,g as u,y as f,a as m,j as p,m as g,w as h,k as v,o as b,p as j,q as x,V as _,W as y,F as q,D as w,E as T,a3 as k}from"./App-73cfe643.js";import{T as D}from"./UIToolbar-e11d1429.js";import"./UIItem-4ead29f6.js";import"./UISegmented-3d4b37d5.js";import{d as Y}from"./dayjs.min-d290c2ff.js";import"./OrdersExport-970f81e8.js";function M(t,e,s){const l=t.slice();return l[12]=e[s],l}function $(t,e,s){const l=t.slice();return l[3]=e[s],l[16]=s,l}function A(t){let e,s,i,u=0==t[2].outlets.length&&E(),m=t[2].outlets,p=[];for(let e=0;e<m.length;e+=1)p[e]=O($(t,m,e));return{c(){e=l("select"),u&&u.c(),s=n();for(let t=0;t<p.length;t+=1)p[t].c();r(e,"class","text-xl my-2 w-48")},m(l,n,r){o(l,e,n),u&&u.m(e,null),a(e,s);for(let t=0;t<p.length;t+=1)p[t].m(e,null);r&&i(),i=c(e,"change",t[9])},p(t,l){if(0==t[2].outlets.length?u||(u=E(),u.c(),u.m(e,s)):u&&(u.d(1),u=null),4&l){let s;for(m=t[2].outlets,s=0;s<m.length;s+=1){const a=$(t,m,s);p[s]?p[s].p(a,l):(p[s]=O(a),p[s].c(),p[s].m(e,null))}for(;s<p.length;s+=1)p[s].d(1);p.length=m.length}},d(t){t&&d(e),u&&u.d(),f(p,t),i()}}}function E(t){let e;return{c(){e=l("option"),e.textContent="Default",e.__value="0",e.value=e.__value},m(t,s){o(t,e,s)},d(t){t&&d(e)}}}function O(t){let e,s,n,r=t[3].name+"";return{c(){e=l("option"),s=i(r),e.__value=n=""+t[3].id,e.value=e.__value},m(t,l){o(t,e,l),a(e,s)},p(t,l){4&l&&r!==(r=t[3].name+"")&&u(s,r),4&l&&n!==(n=""+t[3].id)&&(e.__value=n),e.value=e.__value},d(t){t&&d(e)}}}function H(t){let e,s=t[1],l=[];for(let e=0;e<s.length;e+=1)l[e]=I(M(t,s,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=n()},m(t,s){for(let e=0;e<l.length;e+=1)l[e].m(t,s);o(t,e,s)},p(t,a){if(2&a){let n;for(s=t[1],n=0;n<s.length;n+=1){const r=M(t,s,n);l[n]?l[n].p(r,a):(l[n]=I(r),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=s.length}},d(t){f(l,t),t&&d(e)}}}function I(t){let e,s,n,c,f,p,g,h,v,b,j,x,_,y=Y(t[12].sentAt).format("h:mmA")+"",q=t[12].table_id+"",w=t[12].guest.name+"",T=t[12].guest.phone+"";return{c(){e=l("tr"),s=l("td"),n=i(y),c=m(),f=l("td"),p=i(q),g=m(),h=l("td"),v=i(w),b=m(),j=l("td"),x=i(T),_=m(),r(s,"class","svelte-1tjcqr"),r(f,"class","svelte-1tjcqr"),r(h,"class","svelte-1tjcqr"),r(j,"class","svelte-1tjcqr"),r(e,"class","hover:bg-gray-200")},m(t,l){o(t,e,l),a(e,s),a(s,n),a(e,c),a(e,f),a(f,p),a(e,g),a(e,h),a(h,v),a(e,b),a(e,j),a(j,x),a(e,_)},p(t,e){2&e&&y!==(y=Y(t[12].sentAt).format("h:mmA")+"")&&u(n,y),2&e&&q!==(q=t[12].table_id+"")&&u(p,q),2&e&&w!==(w=t[12].guest.name+"")&&u(v,w),2&e&&T!==(T=t[12].guest.phone+"")&&u(x,T)},d(t){t&&d(e)}}}function N(t){let e,s,n,f,x,_,y,q,w,T,k,Y,M,$,E,O,I,N,S,C,L,P,U,J=t[0].format("ddd D/M/YY")+"";const B=new D({props:{class:"border-b border-gray-300",tools:t[4]}});B.$on("selected",t[7]);let F=t[2]&&A(t),G=t[1]&&H(t);return{c(){e=l("script"),n=m(),p(B.$$.fragment),f=m(),x=l("div"),_=l("div"),y=l("label"),y.textContent="Outlet",q=m(),F&&F.c(),w=m(),T=l("div"),k=l("button"),k.innerHTML='<i class="far fa-arrow-alt-circle-left"></i>',Y=m(),M=l("div"),$=i(J),E=m(),O=l("button"),O.innerHTML='<i class="far fa-arrow-alt-circle-right"></i>',I=m(),N=l("div"),S=l("table"),C=l("tr"),C.innerHTML='<td class="svelte-1tjcqr">Date/Time</td> \n            <td class="svelte-1tjcqr">Table</td> \n            <td class="svelte-1tjcqr">Name</td> \n            <td class="svelte-1tjcqr">Phone</td>',L=m(),G&&G.c(),e.src!==(s="https://unpkg.com/papaparse@latest/papaparse.min.js")&&r(e,"src","https://unpkg.com/papaparse@latest/papaparse.min.js"),r(y,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),r(_,"class","p-2 flex-none"),r(x,"class","border-t border-b border-gray-200 flex"),r(M,"class","flex-grow self-center text-center"),r(T,"class","flex text-lg font-semibold m-2"),r(C,"class","bg-theme text-white rounded-lg"),r(S,"class","w-full svelte-1tjcqr"),r(N,"class","m-2")},m(s,l,r){a(document.head,e),o(s,n,l),g(B,s,l),o(s,f,l),o(s,x,l),a(x,_),a(_,y),a(_,q),F&&F.m(_,null),o(s,w,l),o(s,T,l),a(T,k),a(T,Y),a(T,M),a(M,$),a(T,E),a(T,O),o(s,I,l),o(s,N,l),a(N,S),a(S,C),a(S,L),G&&G.m(S,null),P=!0,r&&h(U),U=[c(k,"click",t[10]),c(O,"click",t[11])]},p(t,[e]){t[2]?F?F.p(t,e):(F=A(t),F.c(),F.m(_,null)):F&&(F.d(1),F=null),(!P||1&e)&&J!==(J=t[0].format("ddd D/M/YY")+"")&&u($,J),t[1]?G?G.p(t,e):(G=H(t),G.c(),G.m(S,null)):G&&(G.d(1),G=null)},i(t){P||(v(B.$$.fragment,t),P=!0)},o(t){b(B.$$.fragment,t),P=!1},d(t){d(e),t&&d(n),j(B,t),t&&d(f),t&&d(x),F&&F.d(),t&&d(w),t&&d(T),t&&d(I),t&&d(N),G&&G.d(),h(U)}}}function S(t,e,s){let l;x(t,_,t=>s(8,l=t));let a,n,r=Y(),o=[];function c(t){s(0,r=r.add(t,"day")),d()}function d(){q(_,l=!0);let t={dine_in:"true",from:r.startOf("day").toJSON(),to:r.endOf("day").toJSON()};a.franchise_id&&(t={...t,fran_id:a.franchise_id,outlet_id:n.id}),w(T("/orders"),t,"GET").then(t=>{q(_,l=!1),s(1,o=t.orders)})}y(async()=>{let t=await w(T("/accounts"));s(2,a=t[0]),s(3,n=a.outlets.length>0?a.outlets[0]:{id:"",name:"Default"}),d()});return[r,o,a,n,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],c,d,function(t){switch(t.detail.function){case"refresh":d();break;case"export":{let t=[];o.forEach(e=>{t=[...t,{"Date/Time":Y(e.sentAt).format("YYYY-MM-DD HH:mm"),Table:e.table_id,Name:e.guest.name,Phone:e.guest.phone}]}),k(Papa.unparse(t),"guestbook.csv","text/csv;encoding:utf-8")}}},l,t=>{s(3,n=a.outlets.find(e=>""+e.id==t.target.value)),d()},()=>c(-1),()=>c(1)]}export default class extends t{constructor(t){var n;super(),document.getElementById("svelte-1tjcqr-style")||((n=l("style")).id="svelte-1tjcqr-style",n.textContent="table.svelte-1tjcqr td.svelte-1tjcqr{padding:0.5rem}",a(document.head,n)),e(this,t,S,N,s,{})}}
//# sourceMappingURL=Guestbook-7b66509b.js.map
