import{S as t,i as e,s as n,M as s,j as o,m as a,k as r,o as c,p as l,q as i,z as d,e as p,b as m,c as f,h as u,a as h,d as g,w as x,l as y,Q as $,n as b,ae as v,af as w,t as k,x as j,g as A,r as M,u as Y,y as D,R as _,C,F as I,D as z,E,a1 as P}from"./App-cee17e86.js";import{T}from"./UIToolbar-576808c9.js";import{U as q}from"./UIItem-bdd50fc9.js";import{d as U}from"./dayjs.min-366cf409.js";function H(t){let e;return{c(){e=p("div"),e.textContent="Activate GetPayments",m(e,"slot","title"),m(e,"class","font-semibold text-xl text-gray-600 pb-3")},m(t,n){f(t,e,n)},d(t){t&&u(e)}}}function N(t){let e,n,s,o,a,r,c,l,i;return{c(){e=p("div"),n=p("p"),n.innerHTML="\n            In order to accept payments, your account has to first activate <b>GetPayments</b>.<br>\n            Tap here to contact our support to activate now.\n        ",s=h(),o=p("div"),a=p("button"),a.textContent="Contact Support",r=h(),c=p("div"),l=p("button"),l.textContent="Cancel",m(n,"class","text-gray-800 mb-6 text-center"),m(a,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),m(o,"class","flex justify-center mt-2"),m(l,"class","p-2 w-1/2 shadow-md bg-gray-400 text-white rounded-lg capitalize font-bold h-full shadow-md"),m(c,"class","flex justify-center mt-2"),m(e,"slot","content"),m(e,"class","h-64 p-2")},m(d,p,m){f(d,e,p),g(e,n),g(e,s),g(e,o),g(o,a),g(e,r),g(e,c),g(c,l),m&&x(i),i=[y(a,"click",t[0]),y(l,"click",$)]},p:b,d(t){t&&u(e),x(i)}}}function R(t){let e;return{c(){e=h()},m(t,n){f(t,e,n)},p:b,d(t){t&&u(e)}}}function G(t){let e;const n=new s({props:{$$slots:{default:[R],content:[N],title:[H]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,s){a(n,t,s),e=!0},p(t,[e]){const s={};4&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){e||(r(n.$$.fragment,t),e=!0)},o(t){c(n.$$.fragment,t),e=!1},d(t){l(n,t)}}}function O(t,e,n){let s;return i(t,d,t=>n(1,s=t)),[function(){v(`Hello, I would like to activate payments for my GetOrders account.\n üëâüèª My ID : ${s.settings.fire_id}`)}]}class B extends t{constructor(t){super(),e(this,t,O,G,n,{})}}const{document:L}=w;function S(t,e,n){const s=t.slice();return s[19]=e[n],s}function F(t,e,n){const s=t.slice();return s[16]=e[n],s}function W(t){let e;return{c(){e=k("PICKUP ORDER")},m(t,n){f(t,e,n)},p:b,d(t){t&&u(e)}}}function K(t){let e,n,s,o=t[19].guest.address+"",a=t[19].guest.address2+"";return{c(){e=k(o),n=h(),s=k(a)},m(t,o){f(t,e,o),f(t,n,o),f(t,s,o)},p(t,n){1&n&&o!==(o=t[19].guest.address+"")&&A(e,o),1&n&&a!==(a=t[19].guest.address2+"")&&A(s,a)},d(t){t&&u(e),t&&u(n),t&&u(s)}}}function Q(t){let e,n,s,o,a=U(t[19].payment.paidAt).format("DD/MM/YYYY h:mmA")+"";return{c(){e=p("p"),n=p("i"),s=k(" Paid on "),o=k(a),m(n,"class","icon ion-md-checkmark-circle pr-1"),m(e,"class","text-sm text-green-400 font-semibold")},m(t,a){f(t,e,a),g(e,n),g(e,s),g(e,o)},p(t,e){1&e&&a!==(a=U(t[19].payment.paidAt).format("DD/MM/YYYY h:mmA")+"")&&A(o,a)},d(t){t&&u(e)}}}function J(t){let e,n;function s(...e){return t[13](t[19],...e)}return{c(){e=p("button"),e.innerHTML='<i class="icon ion-md-checkmark-circle-outline"></i>',m(e,"class","action bg-theme svelte-qjn5fh")},m(t,o,a){f(t,e,o),a&&n(),n=y(e,"click",s)},p(e,n){t=e},d(t){t&&u(e),n()}}}function V(t){let e,n,s,o,a,r,c,l,i,d,x,$,b,v,w,j,M,Y=U(t[19].createdAt).format("h:mmA")+"",D=t[19].guest.name+"",_=t[19].guest.phone+"";function C(t,e){return t[19].guest.address?K:W}let I=C(t),z=I(t),E=t[19].payment&&t[19].payment.paidAt&&Q(t),P=!t[19].payment&&J(t);function T(...e){return t[14](t[19],...e)}return{c(){e=p("a"),n=p("p"),s=k(Y),o=h(),a=p("p"),r=k(D),c=h(),l=p("p"),i=k(_),d=h(),x=p("p"),z.c(),$=h(),E&&E.c(),v=h(),P&&P.c(),w=h(),j=p("button"),j.innerHTML='<i class="icon ion-logo-whatsapp"></i>',m(n,"class","text-theme font-semibold"),m(a,"class","font-semibold leading-tight"),m(l,"class","leading-tight text-gray-600"),m(x,"class","text-sm"),m(e,"href",b=`https://pay.getorders.app/?i=${t[19].invoice_id}`),m(e,"target","_blank"),m(e,"class","flex-grow p-2"),m(j,"class","action bg-theme svelte-qjn5fh")},m(t,p,m){f(t,e,p),g(e,n),g(n,s),g(e,o),g(e,a),g(a,r),g(e,c),g(e,l),g(l,i),g(e,d),g(e,x),z.m(x,null),g(e,$),E&&E.m(e,null),f(t,v,p),P&&P.m(t,p),f(t,w,p),f(t,j,p),m&&M(),M=y(j,"click",T)},p(n,o){t=n,1&o&&Y!==(Y=U(t[19].createdAt).format("h:mmA")+"")&&A(s,Y),1&o&&D!==(D=t[19].guest.name+"")&&A(r,D),1&o&&_!==(_=t[19].guest.phone+"")&&A(i,_),I===(I=C(t))&&z?z.p(t,o):(z.d(1),z=I(t),z&&(z.c(),z.m(x,null))),t[19].payment&&t[19].payment.paidAt?E?E.p(t,o):(E=Q(t),E.c(),E.m(e,null)):E&&(E.d(1),E=null),1&o&&b!==(b=`https://pay.getorders.app/?i=${t[19].invoice_id}`)&&m(e,"href",b),t[19].payment?P&&(P.d(1),P=null):P?P.p(t,o):(P=J(t),P.c(),P.m(w.parentNode,w))},d(t){t&&u(e),z.d(),E&&E.d(),t&&u(v),P&&P.d(t),t&&u(w),t&&u(j),M()}}}function X(t){let e;const n=new q({props:{$$slots:{default:[V]},$$scope:{ctx:t}}});return{c(){o(n.$$.fragment)},m(t,s){a(n,t,s),e=!0},p(t,e){const s={};4194305&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){e||(r(n.$$.fragment,t),e=!0)},o(t){c(n.$$.fragment,t),e=!1},d(t){l(n,t)}}}function Z(t){let e,n,s,o,a,l=U(t[16]).format("ddd D/M/YY")+"",i=t[0][t[16]],d=[];for(let e=0;e<i.length;e+=1)d[e]=X(S(t,i,e));const x=t=>c(d[t],1,1,()=>{d[t]=null});return{c(){e=p("div"),n=k(l),s=h();for(let t=0;t<d.length;t+=1)d[t].c();o=j(),m(e,"class","rounded-lg bg-theme text-white text-lg font-semibold m-2 p-2")},m(t,r){f(t,e,r),g(e,n),f(t,s,r);for(let e=0;e<d.length;e+=1)d[e].m(t,r);f(t,o,r),a=!0},p(t,e){if((!a||1&e)&&l!==(l=U(t[16]).format("ddd D/M/YY")+"")&&A(n,l),193&e){let n;for(i=t[0][t[16]],n=0;n<i.length;n+=1){const s=S(t,i,n);d[n]?(d[n].p(s,e),r(d[n],1)):(d[n]=X(s),d[n].c(),r(d[n],1),d[n].m(o.parentNode,o))}for(M(),n=i.length;n<d.length;n+=1)x(n);Y()}},i(t){if(!a){for(let t=0;t<i.length;t+=1)r(d[t]);a=!0}},o(t){d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)c(d[t]);a=!1},d(t){t&&u(e),t&&u(s),D(d,t),t&&u(o)}}}function tt(t){let e,n,s;return{c(){e=p("div"),n=p("button"),n.textContent="Show More",m(n,"class","p-2 w-1/2 shadow-md bg-theme text-white rounded-lg capitalize font-bold h-full shadow-md"),m(e,"class","flex justify-center mt-2")},m(o,a,r){f(o,e,a),g(e,n),r&&s(),s=y(n,"click",t[15])},p:b,d(t){t&&u(e),s()}}}function et(t){let e,n,s,i,d,x,y;const $=new T({props:{class:"border-b border-gray-300",tools:t[3]}});$.$on("selected",t[4]);let b=Object.keys(t[0]),v=[];for(let e=0;e<b.length;e+=1)v[e]=Z(F(t,b,e));const w=t=>c(v[t],1,1,()=>{v[t]=null});let k=t[2]&&tt(t);return{c(){e=p("script"),s=h(),o($.$$.fragment),i=h();for(let t=0;t<v.length;t+=1)v[t].c();d=h(),k&&k.c(),x=j(),e.src!==(n="https://unpkg.com/papaparse@latest/papaparse.min.js")&&m(e,"src","https://unpkg.com/papaparse@latest/papaparse.min.js")},m(t,n){g(L.head,e),f(t,s,n),a($,t,n),f(t,i,n);for(let e=0;e<v.length;e+=1)v[e].m(t,n);f(t,d,n),k&&k.m(t,n),f(t,x,n),y=!0},p(t,[e]){if(193&e){let n;for(b=Object.keys(t[0]),n=0;n<b.length;n+=1){const s=F(t,b,n);v[n]?(v[n].p(s,e),r(v[n],1)):(v[n]=Z(s),v[n].c(),r(v[n],1),v[n].m(d.parentNode,d))}for(M(),n=b.length;n<v.length;n+=1)w(n);Y()}t[2]?k?k.p(t,e):(k=tt(t),k.c(),k.m(x.parentNode,x)):k&&(k.d(1),k=null)},i(t){if(!y){r($.$$.fragment,t);for(let t=0;t<b.length;t+=1)r(v[t]);y=!0}},o(t){c($.$$.fragment,t),v=v.filter(Boolean);for(let t=0;t<v.length;t+=1)c(v[t]);y=!1},d(t){u(e),t&&u(s),l($,t),t&&u(i),D(v,t),t&&u(d),k&&k.d(t),t&&u(x)}}}function nt(t,e,n){let s,o,a;i(t,_,t=>n(9,s=t)),i(t,d,t=>n(10,o=t)),i(t,C,t=>n(11,a=t));let r={},c=0,l=!0,p=[];function m(t){0==t&&n(2,l=!0),n(1,c=t),I(_,s=!0),z(E(`/orders/${c}`)).then(t=>{I(_,s=!1),0==t.orders.length?n(2,l=!1):(p=0==c?t.orders:[...p,...t.orders],f())})}function f(){let t={};p.forEach(e=>{let n=U(e.createdAt).format("YYYY-MM-DD");t[n]=[...t[n]||[],e]}),n(0,r=t)}function u(t){o.settings.billplz_token?(I(_,s=!0),z(E("/payment/billplz"),{order_id:t.invoice_id},"GET").then(e=>{p=p.map(n=>(n.invoice_id==t.invoice_id&&(n.payment={bill_id:e.bill_id,url:e.url}),n)),f(),I(_,s=!1)})):I(C,a=[...a,{view:B}])}function h(t){let e=t.guest.phone;e.startsWith("01")&&(e="6"+e);let n=`https://api.whatsapp.com/send?phone=${e}&text=`,s="";t.payment&&(s=`Hey there! We *(${o.settings.name})* have received your order, tap here to pay now.`,s=`${s} üëâüèª https://pay.getorders.app/?i=${t.invoice_id}\n\n`);let a=encodeURIComponent(s);document.location.href=`${n}${a}`}m(0);return[r,c,l,[{name:"Refresh",icon:"refresh",function:"refresh"},{name:"Export",icon:"cloud-download",function:"export"}],function(t){switch(t.detail.function){case"refresh":m(0);break;case"export":{let t=[];p.forEach(e=>{if(e.payment){let n={order_date:U(e.createdAt).format("MM/DD h:mmA"),name:e.guest.name,phone:e.guest.phone,address:`${e.guest.address||""} ${e.guest.address2||""}`,isPickUp:e.guest.address?"N":"Y",amount:e.payment.amount.toFixed(2),paid:e.payment.paidAt?U(e.payment.paidAt).format("MM/DD h:mmA"):"",invoice:`https://pay.getorders.app/?i=${e.invoice_id}`};t=[...t,n]}}),P(Papa.unparse(t),"orders.csv","text/csv;encoding:utf-8")}}},m,u,h,p,s,o,a,f,t=>u(t),t=>h(t),()=>m(c+1)]}export default class extends t{constructor(t){var s;super(),L.getElementById("svelte-qjn5fh-style")||((s=p("style")).id="svelte-qjn5fh-style",s.textContent=".action.svelte-qjn5fh{border-radius:9999px;color:#fff;margin-right:0.75rem;width:4rem;height:4rem;text-align:center;align-self:center;font-size:1.5rem;flex:none;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)}",g(L.head,s)),e(this,t,nt,et,n,{})}}
//# sourceMappingURL=OrdersMan-42f72450.js.map
