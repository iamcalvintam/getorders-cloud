{"version":3,"file":"Settings-1bd5e220.js","sources":["../../src/UI/UIList.html","../../src/Settings.html"],"sourcesContent":["<script>\n  import { slide } from 'svelte/transition';\n  import { quintInOut } from 'svelte/easing';\n  export let value = [], label = \"\", placeholder = \"\", style = {}\n  function add(){\n    value = [...value, \"\"]\n  }\n  function remove(index){\n    value = [...value.slice(0,index), ...value.slice(index+1,value.length)];\n  }\n</script>\n<div class=\"{style.container}\">\n    <div class=\"flex\">\n      <label class=\"flex-grow self-center text-xs uppercase text-gray-500 font-semibold\">{label}</label>\n      <button class=\"flex-none\" on:click=\"{add}\">\n        <i class=\"icon ion-md-add text-xl\"></i>\n      </button>\n    </div>\n  {#each value as field, i}\n    <div class=\"flex rounded-lg bg-gray-100 p-2 my-2\" transition:slide=\"{{ duration: 300, easing: quintInOut }}\">\n      <input type=\"text\" class=\"flex-grow bg-gray-100 self-center\" placeholder=\"{placeholder}\" value=\"{field}\"/>\n      <button class=\"flex-none ml-2\" on:click=\"{ ()=>remove(i)}\">\n        <i class=\"icon ion-md-close text-xl\"></i>\n      </button>\n    </div>\n  {/each}\n</div>","<script>\n  import dayjs from \"dayjs\"\n  import Segmented from './UI/UISegmented.html';\n  import TextField from './UI/UITextField.html';\n  import Toolbar from './UI/UIToolbar.html';\n  import List from './UI/UIList.html';\n  import { onMount } from 'svelte';\n  import { session, loading, api, alert, accounts, account, trigger, fetch, settings, s3 } from './CTStore.js';\n  let intervals = [45, 30,15,10,5], interval = 30;\n  let tools = [{ name: \"Save\", icon: \"cloud-done\", function: \"save\" }], start_time = [8, 0], end_time = [23, 30];\n  let file;\n  function selected(e) {\n    switch (e.detail.function) {\n      case \"save\":\n        $loading = true;\n        fetch(api('/settings'), $settings.settings).then(o => {\n          $settings = o;\n          $loading = false;\n        }).catch(e => { });\n        break;\n    }\n  }\n\n  function tf_disp(t) {\n    var ta = t.split(':'), am = 'AM'\n    var hr = parseInt(ta)\n    if (hr > 12) {\n      hr -= 12\n      am = 'PM'\n    }\n    return `${hr}:${ta[1]}${am}`\n  }\n  function tf(t) {\n    var min = `${t[1]}`\n    if (t[1] < 10) min = `0${min}`\n    return `${t[0]}:${min}`\n  }\n  function removeSlot(slot) {\n    $settings.settings.timeslots = $settings.settings.timeslots.filter(t => t != slot);\n  }\n  function resetSlots(interval) {\n    var time = start_time.slice()\n    let slots = [tf(time)]\n    for (var i = 1; i < 60; i++) {\n      if (time[0] >= end_time[0] && time[1] >= end_time[1]) break;\n      time[1] += interval\n      if (time[1] >= 60) {\n        time[0] += 1\n        time[1] = time[1] - 60\n      }\n      slots = [...slots, tf(time)]\n    }\n    $settings.settings.timeslots = slots;\n  }\n  let field_style = { container: \"p-2 md:w-1/2 flex-none\", label: \"w-32\" }\n  function readFile() {\n    let reader = new FileReader();\n    reader.readAsDataURL(file.files[0]);\n    reader.onload = () => {\n      let file_content = reader.result;\n      $settings.settings.logo_raw = file_content;\n    };\n  }\n</script>\n<style>\n  .sect {\n    @apply text-xl font-bold mt-3;\n  }\n</style>\n<Toolbar class=\"border-b border-gray-300\" on:selected=\"{selected}\" tools=\"{tools}\" />\n{#if $settings.settings}\n<p class=\"sect text-theme\">\n  Your Details\n</p>\n<TextField style=\"{field_style}\" label=\"Business Name\" bind:value=\"{$settings.settings.name}\" />\n<div class=\"{field_style.container}\">\n<label class=\"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2\">Business Logo</label>\n<label\n  class=\"p-2 block rounded cursor-pointer border shadow-sm { !$settings.settings.logo_raw ? '' : 'bg-theme text-white'}\">\n  {#if !$settings.settings.logo_raw}\n    <i class=\"icon ion-md-cloud-upload px-1\"></i>\n    <span class=\"mt-2 text-base leading-normal\">Upload Image</span>\n  {:else}\n    <i class=\"icon ion-md-cloud-done px-1\"></i>\n    <span class=\"mt-2 text-base leading-normal\">Image Selected</span>\n  {/if}\n    <input type=\"file\" class=\"hidden\" bind:this=\"{file}\" on:change=\"{readFile}\"/>\n</label>\n  {#if $settings.settings.logo}\n  <div class=\"w-16 h-16 m-1 border bg-cover bg-center\" style=\"background-image:url({s3}{$settings.settings.logo})\"></div>\n  {/if}\n</div>\n\n<div class=\"{field_style.container}\">\n  <label class=\"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2 {field_style.label}\">Time Slots</label>\n  <div class=\"border rounded shadow-sm p-2 w-full flex flex-wrap mb-2\">\n      {#if $settings.settings.timeslots.length > 0}\n        {#each $settings.settings.timeslots as timeslot}\n        <span class=\"inline-block p-2 rounded-lg text-xs bg-theme text-white m-1\" on:click=\"{ () => removeSlot(timeslot) }\">{tf_disp(timeslot)}<i class=\"icon ion-md-close pl-2 font-semibold\"></i></span>\n        {/each}\n        {:else}\n        <p class=\"text-gray-500 cursor-pointer\" on:click=\"{ () => resetSlots(interval) }\">No Time Slots Specified. Tap To Add Time Slots.</p>\n      {/if}\n  </div>\n  {#if $settings.settings.timeslots.length > 0}\n  <button on:click=\"{ () => $settings.settings.timeslots = [] }\" class=\"p-1 px-2 bg-theme rounded-lg text-sm text-white mr-2\">Clear</button>\n  <button on:click=\"{ () => resetSlots(interval) }\" class=\"p-1 px-2 bg-theme rounded-lg text-sm text-white mr-2\">Reset</button>\n  <select bind:value=\"{interval}\" on:change=\"{ () => resetSlots(interval) }\">\n    {#each intervals as itv}\n    <option value=\"{itv}\">{itv} minutes</option>\n    {/each}\n  </select>\n  {/if}\n</div>\n\n\n<p class=\"sect text-theme\">\n  Pickup Location\n</p>\n<TextField style=\"{field_style}\" label=\"Address\" bind:value=\"{$settings.settings.address}\" />\n<TextField style=\"{field_style}\" label=\"Address 2\" bind:value=\"{$settings.settings.address2}\" />\n<TextField style=\"{field_style}\" label=\"Postcode\" bind:value=\"{$settings.settings.postcode}\" />\n<TextField style=\"{field_style}\" label=\"Coordinates\" placeholder=\"3.123123,4.123231\" bind:value=\"{$settings.settings.coordinates}\" />\n\n<p class=\"text-xs px-3 mb-3 font-semibold\">\n  Ensure that the details above is correct, as price estimation and riders depend on the accuracy of this information.\n</p>\n<p class=\"sect text-theme\">\n  Orders\n</p>\n<div>\n  <Segmented style=\"{field_style}\" label=\"Status\"\n    segments=\"{[{ name : 'Online', value : false}, { name : 'Offline', value : true}]}\"\n    bind:value=\"{$settings.settings.offline}\" />\n  <TextField style=\"{field_style}\" label=\"Identifier\" bind:value=\"{$settings.settings.short_id}\" />\n  <p class=\"text-xs px-3 mb-3 font-semibold\">\n    <a href=\"https://getorders.app/#{$settings.settings.short_id}\" target=\"_blank\">https://getorders.app/#{$settings.settings.short_id}</a>\n  </p>\n  <TextField style=\"{field_style}\" label=\"SST Tax (%)\" bind:value=\"{$settings.settings.tax}\" />\n  <TextField style=\"{field_style}\" label=\"Delivery Fees\" bind:value=\"{$settings.settings.delivery_fees}\" />\n  <TextField style=\"{field_style}\" label=\"Phone Number\" bind:value=\"{$settings.settings.phone}\" />\n  <TextField style=\"{field_style}\" label=\"Announcement\" bind:value=\"{$settings.settings.announcement}\" />  \n  <TextField style=\"{field_style}\" label=\"Checkout Notes\" bind:value=\"{$settings.settings.checkout_notes}\" />\n  <Segmented style=\"{field_style}\" label=\"Order Methods\"\n    segments=\"{[{ name : 'All', value : ''}, { name : 'No Delivery', value : 'no_delivery'}, { name : 'No Pickup', value : 'no_pickup'}]}\"\n    bind:value=\"{$settings.settings.order_methods}\" />\n  <Segmented style=\"{field_style}\" label=\"List Layout\"\n    segments=\"{[{ name : 'Grid', value : ''}, { name : 'List', value : 'list'}]}\"\n    bind:value=\"{$settings.settings.list_style}\" />\n</div>\n<p class=\"sect text-theme\">\n  Loyalty\n</p>\n<div>\n  <TextField style=\"{field_style}\" label=\"Multiplier\" bind:value=\"{$settings.settings.multiplier}\" />\n  <Segmented style=\"{field_style}\" label=\"Rounding\" segments=\"{[{ name : 'No Rounding', value : ''}, { name : 'Round Down', value : 'round_down'}, { name : 'Round Up', value : 'round_up'}]}\" bind:value=\"{$settings.settings.rounding}\" />\n  <List style=\"{field_style}\" label=\"Deduction Presets\" placeholder=\"e.g : 100\" bind:value=\"{$settings.settings.deduct_presets}\" />\n</div>\n{/if}"],"names":["ctx","duration","easing","quintInOut","length","container","value","label","placeholder","style","remove","index","slice","i","settings","short_id","logo_raw","name","logo","timeslots","address","address2","postcode","coordinates","offline","tax","delivery_fees","phone","announcement","checkout_notes","order_methods","list_style","multiplier","rounding","deduct_presets","s3","tf_disp","t","ta","split","am","hr","parseInt","tf","min","file","intervals","interval","start_time","end_time","removeSlot","slot","$settings","filter","resetSlots","time","slots","icon","function","e","detail","$loading","fetch","api","then","o","catch","reader","FileReader","readAsDataURL","files","onload","file_content","result","timeslot"],"mappings":"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"}